<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Go on Zonzee Li ğŸ‘¨â€ğŸ’»</title>
        <link>https://zonzeeli.github.io/categories/go/</link>
        <description>Recent content in Go on Zonzee Li ğŸ‘¨â€ğŸ’»</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Wed, 17 Aug 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://zonzeeli.github.io/categories/go/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>gRPC-google.apiçš„HttpRuleä»‹ç»</title>
        <link>https://zonzeeli.github.io/p/httprule/</link>
        <pubDate>Wed, 17 Aug 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/httprule/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/httprule/grpcgooleapi.jpg" alt="Featured image of post gRPC-google.apiçš„HttpRuleä»‹ç»" /&gt;&lt;h2 id=&#34;http-rule&#34;&gt;HTTP Rule&lt;/h2&gt;
&lt;p&gt;gRPC Transcoding æ˜¯ä¸€ç§ç”¨äºåœ¨ gRPC æ–¹æ³•å’Œä¸€ä¸ªæˆ–å¤šä¸ª HTTP REST ç«¯ç‚¹ä¹‹é—´è¿›è¡Œæ˜ å°„çš„åŠŸèƒ½ã€‚å®ƒå…è®¸å¼€å‘äººå‘˜æ„å»ºä¸€ä¸ªåŒæ—¶æ”¯æŒ gRPC API å’Œ REST API çš„ API æœåŠ¡ã€‚HttpRule å®šä¹‰ gRPC/REST æ˜ å°„çš„æ¨¡å¼ã€‚æ˜ å°„æŒ‡å®š gRPC è¯·æ±‚æ¶ˆæ¯çš„ä¸åŒéƒ¨åˆ†å¦‚ä½•æ˜ å°„åˆ° URL è·¯å¾„ã€URL æŸ¥è¯¢å‚æ•°å’Œ HTTP è¯·æ±‚æ­£æ–‡ã€‚å®ƒè¿˜æ§åˆ¶ gRPC å“åº”æ¶ˆæ¯å¦‚ä½•æ˜ å°„åˆ° HTTP å“åº”æ­£æ–‡ã€‚HttpRule é€šå¸¸è¢«æŒ‡å®šä¸º &lt;code&gt;google.api.http&lt;/code&gt; gRPC æ–¹æ³•çš„æ³¨è§£ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ˜ å°„æŒ‡å®šä¸€ä¸ª URL è·¯å¾„æ¨¡æ¿å’Œä¸€ä¸ª HTTP æ–¹æ³•ã€‚è·¯å¾„æ¨¡æ¿å¯ä»¥å¼•ç”¨ gRPC è¯·æ±‚æ¶ˆæ¯ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µï¼Œåªè¦æ¯ä¸ªå­—æ®µæ˜¯åŸå§‹ï¼ˆéæ¶ˆæ¯ï¼‰ç±»å‹çš„éé‡å¤å­—æ®µå³å¯ã€‚è·¯å¾„æ¨¡æ¿æ§åˆ¶è¯·æ±‚æ¶ˆæ¯çš„å­—æ®µå¦‚ä½•æ˜ å°„åˆ° URL è·¯å¾„ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span class=&#34;kd&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Messaging&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;rpc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GetMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GetMessageRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;option&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;google.api.http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/{name=messages/*}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GetMessageRequest&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Mapped to URL path.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Message&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// The resource content.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™å¯ç”¨äº† HTTP REST åˆ° gRPC çš„æ˜ å°„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTP&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;GET /v1/messages/123456&lt;/td&gt;
&lt;td&gt;GetMessage(name: &amp;ldquo;messages/123456&amp;rdquo;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰ HTTP è¯·æ±‚ bodyï¼Œåˆ™è¯·æ±‚æ¶ˆæ¯ä¸­æ²¡æœ‰è¢«è·¯å¾„æ¨¡æ¿ç»‘å®šçš„ä»»ä½•å­—æ®µéƒ½ä¼šè‡ªåŠ¨æˆä¸º HTTP query parametersã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span class=&#34;kd&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Messaging&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;rpc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GetMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GetMessageRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;option&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;google.api.http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/messages/{message_id}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GetMessageRequest&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SubMessage&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;subfield&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;message_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// Mapped to URL path.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;revision&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// Mapped to URL query parameter `revision`.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;SubMessage&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sub&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// Mapped to URL query parameter `sub.subfield`.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™å¯ç”¨äº† HTTP JSON åˆ° RPC æ˜ å°„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTP&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;GET /v1/messages/123456?revision=2&amp;amp;sub.subfield=foo&lt;/td&gt;
&lt;td&gt;GetMessage(message_id: &amp;ldquo;123456&amp;rdquo; revision: 2 sub: SubMessage(subfield: &amp;ldquo;foo&amp;rdquo;))&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ˜ å°„åˆ° URL æŸ¥è¯¢å‚æ•°çš„å­—æ®µå¿…é¡»å…·æœ‰åŸå§‹ç±»å‹æˆ–é‡å¤çš„åŸå§‹ç±»å‹æˆ–éé‡å¤çš„æ¶ˆæ¯ç±»å‹ã€‚åœ¨ repeated ç±»å‹çš„æƒ…å†µä¸‹ï¼Œå‚æ•°å¯ä»¥åœ¨ URL ä¸­é‡å¤ä¸º&lt;code&gt;...?param=A&amp;amp;param=B&lt;/code&gt;. åœ¨ message ç±»å‹çš„æƒ…å†µä¸‹ï¼Œæ¶ˆæ¯çš„æ¯ä¸ªå­—æ®µéƒ½æ˜ å°„åˆ°ä¸€ä¸ªå•ç‹¬çš„å‚æ•°ï¼Œä¾‹å¦‚&lt;code&gt;...?foo.a=A&amp;amp;foo.b=B&amp;amp;foo.c=C&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¯ä»¥æ·»åŠ  body çš„ HTTP æ–¹æ³•ï¼Œbody å­—æ®µæŒ‡å®šæ˜ å°„ã€‚æ¯”å¦‚ message é›†åˆä¸Šçš„ REST update æ–¹æ³•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span class=&#34;kd&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Messaging&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;rpc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;UpdateMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;UpdateMessageRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;option&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;google.api.http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;patch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/messages/{message_id}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;message&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;UpdateMessageRequest&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;message_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// mapped to the URL
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// mapped to the body
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ç”¨äº†ä»¥ä¸‹ HTTP JSON åˆ° RPC æ˜ å°„ï¼Œå…¶ä¸­è¯·æ±‚æ­£æ–‡ä¸­ JSON çš„è¡¨ç¤ºç”± protos JSON ç¼–ç ç¡®å®šï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTP&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;PATCH /v1/messages/123456 { &amp;ldquo;text&amp;rdquo;: &amp;ldquo;Hi!&amp;rdquo; }&lt;/td&gt;
&lt;td&gt;UpdateMessage(message_id: &amp;ldquo;123456&amp;rdquo; message { text: &amp;ldquo;Hi!&amp;rdquo; })&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å¯ä»¥åœ¨ body æ˜ å°„ä¸­ä½¿ç”¨&lt;code&gt;*&lt;/code&gt;æ¥è¡¨ç¤ºæ‰€æœ‰ä¸å—è·¯å¾„æ¨¡æ¿ç»‘å®šçš„å­—æ®µéƒ½åº”è¯¥æ˜ å°„åˆ° bodyä¸­ã€‚æ¯”å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span class=&#34;kd&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Messaging&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;rpc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;UpdateMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;option&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;google.api.http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;patch&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/messages/{message_id}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Message&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;message_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;text&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ç”¨äº† HTTP JSON åˆ° RPC æ˜ å°„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTP&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;PATCH /v1/messages/123456 { &amp;ldquo;text&amp;rdquo;: &amp;ldquo;Hi!&amp;rdquo; }&lt;/td&gt;
&lt;td&gt;UpdateMessage(message_id: &amp;ldquo;123456&amp;rdquo; text: &amp;ldquo;Hi!&amp;quot;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œåœ¨æ­£æ–‡æ˜ å°„ä¸­ä½¿ç”¨&lt;code&gt;*&lt;/code&gt;æ—¶ï¼Œä¸å¯èƒ½æœ‰ HTTP å‚æ•°ï¼Œå› ä¸ºæ‰€æœ‰ä¸å—è·¯å¾„ç»‘å®šçš„å­—æ®µéƒ½ä»¥æ­£æ–‡ç»“å°¾ã€‚ è¿™ä½¿å¾—è¯¥é€‰é¡¹åœ¨å®šä¹‰ REST API æ—¶å¾ˆå°‘åœ¨å®è·µä¸­ä½¿ç”¨ã€‚&lt;code&gt;*&lt;/code&gt;çš„å¸¸è§ç”¨æ³•æ˜¯åœ¨æ ¹æœ¬ä¸ä½¿ç”¨ URL æ¥ä¼ è¾“æ•°æ®çš„è‡ªå®šä¹‰æ–¹æ³•ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨è¯¥additional_bindingsé€‰é¡¹ä¸ºä¸€ä¸ª RPC å®šä¹‰å¤šä¸ª HTTP æ–¹æ³•ã€‚ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-proto&#34; data-lang=&#34;proto&#34;&gt;&lt;span class=&#34;kd&#34;&gt;service&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Messaging&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;k&#34;&gt;rpc&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;GetMessage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GetMessageRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;returns&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;option&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;google.api.http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/messages/{message_id}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;n&#34;&gt;additional_bindings&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;/v1/users/{user_id}/messages/{message_id}&amp;#34;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;message&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GetMessageRequest&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;message_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;user_id&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¯ç”¨äº†ä¸¤ç§å¯é€‰çš„ HTTP JSON åˆ° RPC æ˜ å°„ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;HTTP&lt;/th&gt;
&lt;th&gt;gRPC&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;GET /v1/messages/123456&lt;/td&gt;
&lt;td&gt;GetMessage(message_id: &amp;ldquo;123456&amp;rdquo;)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;GET /v1/users/me/messages/123456&lt;/td&gt;
&lt;td&gt;GetMessage(user_id: &amp;ldquo;me&amp;rdquo; message_id: &amp;ldquo;123456&amp;rdquo;)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä»‹ç» HTTP çš„æ˜ å°„è§„åˆ™ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¯·æ±‚å­—æ®µï¼ˆè¯·æ±‚æ¶ˆæ¯ä¸­çš„é€’å½’æ‰©å±•åµŒå¥—æ¶ˆæ¯ï¼‰åˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;è·¯å¾„æ¨¡æ¿å¼•ç”¨çš„å­—æ®µã€‚å®ƒä»¬é€šè¿‡ URL è·¯å¾„ä¼ é€’ã€‚&lt;/li&gt;
&lt;li&gt;å¼•ç”¨çš„å­—æ®µHttpRule.bodyã€‚å®ƒä»¬é€šè¿‡ HTTP è¯·æ±‚æ­£æ–‡ä¼ é€’ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰å…¶ä»–å­—æ®µéƒ½æ˜¯é€šè¿‡ URL æŸ¥è¯¢å‚æ•°ä¼ é€’çš„ï¼Œå‚æ•°åç§°æ˜¯è¯·æ±‚æ¶ˆæ¯ä¸­çš„å­—æ®µè·¯å¾„ã€‚ä¸€ä¸ªé‡å¤çš„å­—æ®µå¯ä»¥è¡¨ç¤ºä¸ºåŒåçš„å¤šä¸ªæŸ¥è¯¢å‚æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;å¦‚æœHttpRule.bodyä¸º&lt;code&gt;*&lt;/code&gt;ï¼Œåˆ™æ²¡æœ‰ URL æŸ¥è¯¢å‚æ•°ï¼Œæ‰€æœ‰å­—æ®µéƒ½é€šè¿‡ URL è·¯å¾„å’Œ HTTP è¯·æ±‚æ­£æ–‡ä¼ é€’ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœHttpRule.bodyçœç•¥ï¼Œåˆ™æ²¡æœ‰ HTTP è¯·æ±‚æ­£æ–‡ï¼Œæ‰€æœ‰å­—æ®µéƒ½é€šè¿‡ URL è·¯å¾„å’Œ URL æŸ¥è¯¢å‚æ•°ä¼ é€’ã€‚&lt;/li&gt;
&lt;/ol&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€â€”â€”å†…å­˜ç®¡ç†</title>
        <link>https://zonzeeli.github.io/p/memory-management/</link>
        <pubDate>Mon, 13 Jun 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/memory-management/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/memory-management/memorymanagement.jpg" alt="Featured image of post Goè¯­è¨€â€”â€”å†…å­˜ç®¡ç†" /&gt;&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ç¯‡æ–‡ç« ä¸»è¦æ•´åˆäº† Go è¯­è¨€çš„ä¸€äº›å†…å­˜ç®¡ç†çš„çŸ¥è¯†ï¼Œåªæ˜¯æµ…æ˜¾ç¬¼ç»Ÿæ¦‚æ‹¬ï¼Œå¹¶ä¸”ç”¨ä¸€äº›é¢è¯•é¢˜æ¥æ€»ç»“ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šä»¥ä¸‹å†…å®¹å’Œå›¾ç‰‡åŸºæœ¬æ¥è‡ªå…¬ä¼—å·ï¼šç½‘ç®¡å¨biå¨ï¼Œä¸€ä¸ªæˆ‘ç»å¸¸çœ‹çš„åšä¸»ï¼Œæ¨èå…³æ³¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜å¯¹é½&#34;&gt;å†…å­˜å¯¹é½&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬ç¼–ç¨‹çš„ä»»ä½•ä¸€ä¸ªå˜é‡åœ¨å†…å­˜ä¸­å­˜æ”¾éƒ½æŒ‰ç…§ä¸€å®šçš„è§„åˆ™ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»çš„å°±æ˜¯å†…å­˜å¯¹é½çš„è§„åˆ™ï¼Œä¸‹é¢ä¸ºç®€å•æ¦‚æ‹¬ï¼Œè¯¦æƒ…è§æ–‡ç« &lt;a class=&#34;link&#34; href=&#34;https://zonzeeli.github.io/p/memory-alignment/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Goè¯­è¨€â€”â€”å†…å­˜å¯¹é½&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç†è®ºä¸Šè®¡ç®—æœºå¯ä»¥è®¿é—®ä»»æ„åœ°å€çš„å˜é‡ï¼Œä½†æ˜¯åœ¨è®¿é—®ç‰¹å®šç±»å‹é€šå¸¸åœ¨ç‰¹å®šçš„å†…å­˜åœ°å€ä¸­ï¼Œæ•°æ®å­˜æ”¾å¹¶ä¸æ˜¯éšæ„å­˜æ”¾ï¼Œæ˜¯æœ‰è§„åˆ™çš„é¡ºåºï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ†æå‡ºï¼Œå†…å­˜å¯¹é½æ˜¯ä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿè®¿é—®å†…å­˜è¿›è¡Œæ•°æ®çš„å­˜å–ï¼Œä½†æ˜¯ä¼šæ¶ˆè€—å†…å­˜ç©ºé—´ï¼Œç”¨ç©ºé—´æ¢æ—¶é—´çš„ä¸€ç§å†…å­˜å­˜å‚¨è§„åˆ™ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t2&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ˜¯ä¸æ˜¯å¯¹è¿™ä¸ªç»“æœæœ‰ç–‘é—®å‘¢ï¼Ÿä¸ºä»€ä¹ˆ&lt;code&gt;s1&lt;/code&gt;å’Œ&lt;code&gt;s2&lt;/code&gt;çš„æ•°æ®é•¿åº¦ä¸åŒï¼Œä½†æ˜¯æ‰“å°å‡ºçš„å†…å­˜é•¿åº¦ä¸€æ ·ï¼Ÿä¸ºä»€ä¹ˆ&lt;code&gt;t1&lt;/code&gt;å’Œ&lt;code&gt;t2&lt;/code&gt;çš„ç»“æ„ä½“åªæ˜¯å®šä¹‰çš„é¡ºåºä¸åŒï¼Œå†…å­˜é•¿åº¦å´ä¸ä¸€æ ·ï¼Ÿ&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œgoè¯­è¨€é€šè¿‡unsafe.Sizeof(x)æ‰“å°çš„å˜é‡å ç”¨çš„å†…å­˜å­—èŠ‚æ•°ï¼Œå’Œåº•å±‚æ•°æ®æ— å…³ï¼Œä¸åŒ…å«xæ‰€æŒ‡å‘çš„å†…å®¹å¤§å°ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªç–‘é—®è§£å†³äº†ã€‚ä¹ŸåŒç†æˆ‘ä»¬å¯ä»¥é€šè¿‡unsafe.Sizeof()æ‰“å°å‡ºå„ä¸ªç±»å‹çš„å†…å­˜å ç”¨å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ³¨ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯64ä½ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;å­—èŠ‚æ•°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;bool&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;intN, uintN, floatN, complexN&lt;/td&gt;
&lt;td&gt;N/8 ä¸ªå­—èŠ‚ ï¼ˆint32 æ˜¯ 4 ä¸ªå­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;int, uint, uintptr&lt;/td&gt;
&lt;td&gt;è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 8 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;*T, map, func, chan&lt;/td&gt;
&lt;td&gt;è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 8 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;string ï¼ˆdataã€lenï¼‰&lt;/td&gt;
&lt;td&gt;2 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 16 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;interface (tabã€data æˆ– _typeã€data)&lt;/td&gt;
&lt;td&gt;2 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 16 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;[]T (arrayã€lenã€cap)&lt;/td&gt;
&lt;td&gt;3 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 24 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 1ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 8ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¯¹äºä¸Šé¢çš„ç»“æ„ï¼Œå¦‚æœæ˜¯æ²¡æœ‰è¿›è¡Œè¿‡å†…å­˜å¯¹é½ï¼Œåˆ™æŒ‰ç…§å­˜æ”¾çš„é¡ºåºï¼Œä»¥64ä½ç³»ç»Ÿçš„æ¯8ä¸ªå­—èŠ‚å–æ•°æ®çš„è§„åˆ™ï¼Œä¼šå‘ç°é™¤äº†&lt;code&gt;a&lt;/code&gt;ï¼Œ&lt;code&gt;b&lt;/code&gt;å’Œ&lt;code&gt;c&lt;/code&gt;éƒ½ä¸æ˜¯ä»å¤´å–çš„ï¼Œè¿‡ç¨‹å¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E9%94%99%E8%AF%AF%E8%AE%A4%E4%B8%BA%E5%AD%98%E6%94%BE.png&#34;
	width=&#34;1589&#34;
	height=&#34;405&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E9%94%99%E8%AF%AF%E8%AE%A4%E4%B8%BA%E5%AD%98%E6%94%BE_hu3e76a038d58f2f1062ae644cd8f6b655_27362_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E9%94%99%E8%AF%AF%E8%AE%A4%E4%B8%BA%E5%AD%98%E6%94%BE_hu3e76a038d58f2f1062ae644cd8f6b655_27362_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;392&#34;
		data-flex-basis=&#34;941px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äº&lt;code&gt;b&lt;/code&gt;å’Œ&lt;code&gt;c&lt;/code&gt;æ²¡æœ‰åšåˆ°ä»èµ·å§‹ä½å¼€å§‹å–æ•°æ®ï¼Œæ‰€ä»¥ä¼šé€ æˆä¹‹ååœ¨å†æ¬¡æ‹¼æ¥æ•´ç†çš„æ“ä½œï¼Œéœ€è¦å¤šæ¬¡å†…å­˜è®¿é—®å’Œæ•´ç†çš„æ­¥éª¤ã€‚è€Œå¦‚æœç»è¿‡å†…å­˜å¯¹é½ï¼Œå°±ä¼šå¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90.png&#34;
	width=&#34;1590&#34;
	height=&#34;405&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90_hu30eb8e292f8ff7e8cdbfc0b3de51ce1a_37503_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90_hu30eb8e292f8ff7e8cdbfc0b3de51ce1a_37503_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;392&#34;
		data-flex-basis=&#34;942px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€ä»¥æˆ‘ä»¬èƒ½å‘ç°ï¼Œå†…å­˜å¯¹é½å‡å°‘äº†æ“ä½œæ­¥éª¤ï¼Œä½†æ˜¯å´æµªè´¹äº†å†…å­˜ç©ºé—´å ç”¨çš„èµ„æºã€‚&lt;/p&gt;
&lt;h4 id=&#34;å†…å­˜å¯¹é½è§„åˆ™&#34;&gt;å†…å­˜å¯¹é½è§„åˆ™&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;æˆå‘˜å¯¹é½è§„åˆ™ï¼šé’ˆå¯¹ä¸€ä¸ªåŸºç¡€ç±»å‹å˜é‡ï¼Œå¦‚æœ&lt;code&gt;unsafe.AlignOf()&lt;/code&gt;è¿”å›çš„å€¼æ˜¯&lt;code&gt;m&lt;/code&gt;ï¼Œé‚£ä¹ˆè¯¥å˜é‡çš„åœ°å€éœ€è¦è¢«&lt;code&gt;m&lt;/code&gt;æ•´é™¤ï¼ˆå¦‚æœå½“å‰åœ°å€ä¸èƒ½æ•´é™¤ï¼Œå¡«å……ç©ºç™½å­—èŠ‚ï¼Œç›´è‡³å¯ä»¥æ•´é™¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ•´ä½“å¯¹é½è§„åˆ™ï¼šé’ˆå¯¹ä¸€ä¸ªç»“æ„ä½“ï¼Œå¦‚æœ&lt;code&gt;unsafe.AlignOf()&lt;/code&gt;è¿”å›å€¼æ˜¯&lt;code&gt;m&lt;/code&gt;ï¼Œéœ€è¦ä¿è¯è¯¥ç»“æ„ä½“æ•´ä½“å†…å­˜å ç”¨æ˜¯&lt;code&gt;m&lt;/code&gt;çš„æ•´æ•°å€ï¼Œå¦‚æœå½“å‰ä¸æ˜¯æ•´æ•°å€ï¼Œéœ€è¦åœ¨åé¢å¡«å……ç©ºç™½å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒé’ˆå¯¹è¯¥è§„åˆ™ï¼Œæˆ‘ä»¬å†æŠŠä¸Šè¿°çš„ç»“æ„ä½“å’Œ&lt;code&gt;unsafe.Offsetof()&lt;/code&gt;æ‹¿å‡ºæ¥åˆ†æä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 8ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float32&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 1ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 20
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// å‡è®¾ä»åœ°å€0å¼€å§‹
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(int32(1)) = 4ï¼Œunsafe.Alignof(int32(1)) = 4ï¼Œåœ°å€0å¼€å§‹ï¼Œå¯ä»¥è¢«4æ•´é™¤
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(int64(1)) = 8ï¼Œunsafe.Alignof(int64(1)) = 8ï¼Œåœ°å€éœ€è¦ä»8å¼€å§‹ï¼Œæ‰å¯ä»¥è¢«8æ•´é™¤ï¼Œ[4,8]çš„ä½ç½®ç”¨0æ¥è¡¥å……
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(float32(1)) = 4ï¼Œunsafe.Alignof(float32(1)) = 4ï¼Œåœ°å€éœ€è¦ä»16å¼€å§‹ï¼Œå¯ä»¥è¢«4æ•´é™¤ï¼Œ[8,16]çš„ä½ç½®è¢«t.bå æ»¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(true) = 1, unsafe.Alignof(true) = 1, åœ°å€ä»20å¼€å§‹å³å¯ï¼Œ[16,20]çš„ä½ç½®è¢«cæ²¾æ»¡ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// ç”±äºç»“æ„ä½“ä¹Ÿéœ€è¦å¯¹é½ï¼Œè¦è¢«8æ•´é™¤ï¼Œæ‰€ä»¥è¦è¡¥0åˆ°24ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E4%BE%8B%E5%AD%90.png&#34;
	width=&#34;1245&#34;
	height=&#34;484&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E4%BE%8B%E5%AD%90_hu3f36a1c570ec2b1c16972b281c5088f4_40718_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90%E4%BE%8B%E5%AD%90_hu3f36a1c570ec2b1c16972b281c5088f4_40718_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;å†…å­˜å¯¹é½ä¾‹å­&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;257&#34;
		data-flex-basis=&#34;617px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜åˆ†é…&#34;&gt;å†…å­˜åˆ†é…&lt;/h3&gt;
&lt;p&gt;çŸ¥é“äº†å†…å­˜å­˜æ”¾çš„è§„åˆ™åï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥æ¸…æ¥šæ˜¯è®¡ç®—æœºæ˜¯å¦‚ä½•ç»™ç¨‹åºåˆ†é…å†…å­˜çš„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒGolangè¿è¡Œæ—¶çš„å†…å­˜åˆ†é…ç®—æ³•ä¸»è¦æºè‡ª Google ä¸º C è¯­è¨€å¼€å‘çš„TCMallocç®—æ³•ï¼Œå…¨ç§°Thread-Caching Mallocã€‚æ ¸å¿ƒæ€æƒ³å°±æ˜¯æŠŠå†…å­˜åˆ†ä¸ºå¤šçº§ç®¡ç†ï¼Œä»è€Œé™ä½é”çš„ç²’åº¦ã€‚å®ƒå°†å¯ç”¨çš„å †å†…å­˜é‡‡ç”¨äºŒçº§åˆ†é…çš„æ–¹å¼è¿›è¡Œç®¡ç†ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½ä¼šè‡ªè¡Œç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„å†…å­˜æ± ï¼Œè¿›è¡Œå†…å­˜åˆ†é…æ—¶ä¼˜å…ˆä»è¯¥å†…å­˜æ± ä¸­åˆ†é…ï¼Œå½“å†…å­˜æ± ä¸è¶³æ—¶æ‰ä¼šå‘å…¨å±€å†…å­˜æ± ç”³è¯·ï¼Œä»¥é¿å…ä¸åŒçº¿ç¨‹å¯¹å…¨å±€å†…å­˜æ± çš„é¢‘ç¹ç«äº‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨Goé‡Œé¢æœ‰ä¸¤ç§å†…å­˜åˆ†é…ç­–ç•¥ï¼Œä¸€ç§é€‚ç”¨äºç¨‹åºé‡Œå°å†…å­˜å—çš„ç”³è¯·ï¼Œå¦ä¸€ç§é€‚ç”¨äºå¤§å†…å­˜å—çš„ç”³è¯·ï¼Œå¤§å†…å­˜å—æŒ‡çš„æ˜¯å¤§äº32KBã€‚&lt;/p&gt;
&lt;h4 id=&#34;åŸºç¡€æ¦‚å¿µ&#34;&gt;åŸºç¡€æ¦‚å¿µ&lt;/h4&gt;
&lt;p&gt;mspanï¼šGoä¸­å†…å­˜ç®¡ç†çš„åŸºæœ¬å•å…ƒï¼Œæ˜¯ç”±ä¸€ç‰‡è¿ç»­çš„8KBçš„é¡µç»„æˆçš„å¤§å—å†…å­˜ã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„é¡µå’Œæ“ä½œç³»ç»Ÿæœ¬èº«çš„é¡µå¹¶ä¸æ˜¯ä¸€å›äº‹ï¼Œå®ƒä¸€èˆ¬æ˜¯æ“ä½œç³»ç»Ÿé¡µå¤§å°çš„å‡ å€ã€‚ä¸€å¥è¯æ¦‚æ‹¬ï¼šmspanæ˜¯ä¸€ä¸ªåŒ…å«èµ·å§‹åœ°å€ã€mspanè§„æ ¼ã€é¡µçš„æ•°é‡ç­‰å†…å®¹çš„åŒç«¯é“¾è¡¨ã€‚æ¯ä¸ªmspanæŒ‰ç…§å®ƒè‡ªèº«çš„å±æ€§Size Classçš„å¤§å°åˆ†å‰²æˆè‹¥å¹²ä¸ªobjectï¼Œæ¯ä¸ªobjectå¯å­˜å‚¨ä¸€ä¸ªå¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;mcacheï¼šæ¯ä¸ªå·¥ä½œçº¿ç¨‹éƒ½ä¼šç»‘å®šä¸€ä¸ªmcacheï¼Œæœ¬åœ°ç¼“å­˜å¯ç”¨çš„mspanèµ„æºï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç»™Goroutineåˆ†é…ï¼Œå› ä¸ºä¸å­˜åœ¨å¤šä¸ªGoroutineç«äº‰çš„æƒ…å†µï¼Œæ‰€ä»¥ä¸ä¼šæ¶ˆè€—é”èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;mcentralï¼šä¸ºæ‰€æœ‰mcacheæä¾›åˆ‡åˆ†å¥½çš„mspanèµ„æºã€‚æ¯ä¸ªcentralä¿å­˜ä¸€ç§ç‰¹å®šå¤§å°çš„å…¨å±€mspanåˆ—è¡¨ï¼ŒåŒ…æ‹¬å·²åˆ†é…å‡ºå»çš„å’Œæœªåˆ†é…å‡ºå»çš„ã€‚ æ¯ä¸ªmcentralå¯¹åº”ä¸€ç§mspanï¼Œè€Œmspançš„ç§ç±»å¯¼è‡´å®ƒåˆ†å‰²çš„objectå¤§å°ä¸åŒã€‚å½“å·¥ä½œçº¿ç¨‹çš„mcacheä¸­æ²¡æœ‰åˆé€‚ï¼ˆä¹Ÿå°±æ˜¯ç‰¹å®šå¤§å°çš„ï¼‰çš„mspanæ—¶å°±ä¼šä»mcentralè·å–ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;//path: /usr/local/go/src/runtime/mcentral.go
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mcentral&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// äº’æ–¥é”
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;lock&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mutex&lt;/span&gt; 
    &lt;span class=&#34;c1&#34;&gt;// è§„æ ¼
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;sizeclass&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt; 
    &lt;span class=&#34;c1&#34;&gt;// å°šæœ‰ç©ºé—²objectçš„mspané“¾è¡¨
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;nonempty&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mSpanList&lt;/span&gt; 
    &lt;span class=&#34;c1&#34;&gt;// æ²¡æœ‰ç©ºé—²objectçš„mspané“¾è¡¨ï¼Œæˆ–è€…æ˜¯å·²è¢«mcacheå–èµ°çš„msapné“¾è¡¨
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;empty&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mSpanList&lt;/span&gt; 
    &lt;span class=&#34;c1&#34;&gt;// å·²ç´¯è®¡åˆ†é…çš„å¯¹è±¡ä¸ªæ•°
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;nmalloc&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint64&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;mheapï¼šä»£è¡¨Goç¨‹åºæŒæœ‰çš„æ‰€æœ‰å †ç©ºé—´ï¼ŒGoç¨‹åºä½¿ç”¨ä¸€ä¸ªmheapçš„å…¨å±€å¯¹è±¡_mheapæ¥ç®¡ç†å †å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒå½“mcentralæ²¡æœ‰ç©ºé—²çš„mspanæ—¶ï¼Œä¼šå‘mheapç”³è¯·ã€‚è€Œmheapæ²¡æœ‰èµ„æºæ—¶ï¼Œä¼šå‘æ“ä½œç³»ç»Ÿç”³è¯·æ–°å†…å­˜ã€‚mheapä¸»è¦ç”¨äºå¤§å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œä»¥åŠç®¡ç†æœªåˆ‡å‰²çš„mspanï¼Œç”¨äºç»™mcentralåˆ‡å‰²æˆå°å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;smallStruct&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
   &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float64&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nf&#34;&gt;smallAllocation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;//go:noinline
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;smallAllocation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;smallStruct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;smallStruct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;å°äº-32-kb-å†…å­˜å—çš„åˆ†é…ç­–ç•¥&#34;&gt;å°äº 32 KB å†…å­˜å—çš„åˆ†é…ç­–ç•¥&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒå½“ç¨‹åºé‡Œå‘ç”Ÿäº†32kbä»¥ä¸‹çš„å°å—å†…å­˜ç”³è¯·æ—¶ï¼ŒGoä¼šä»ä¸€ä¸ªå«åšçš„ mcache çš„æœ¬åœ°ç¼“å­˜ç»™ç¨‹åºåˆ†é…å†…å­˜ã€‚è¿™ä¸ªæœ¬åœ°ç¼“å­˜ mcache æŒæœ‰ä¸€ç³»åˆ—çš„å¤§å°ä¸º 32kb çš„å†…å­˜å—ï¼Œè¿™æ ·çš„ä¸€ä¸ªå†…å­˜å—é‡Œå«åš mspanï¼Œå®ƒæ˜¯è¦ç»™ç¨‹åºåˆ†é…å†…å­˜æ—¶çš„åˆ†é…å•å…ƒã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ Go çš„è°ƒåº¦å™¨æ¨¡å‹é‡Œï¼Œæ¯ä¸ªçº¿ç¨‹Mä¼šç»‘å®šç»™ä¸€ä¸ªå¤„ç†å™¨Pï¼Œåœ¨å•ä¸€ç²’åº¦çš„æ—¶é—´é‡Œåªèƒ½åšå¤šå¤„ç†è¿è¡Œä¸€ä¸ªgoroutineï¼Œæ¯ä¸ªPéƒ½ä¼šç»‘å®šä¸€ä¸ªä¸Šé¢è¯´çš„æœ¬åœ°ç¼“å­˜mcacheã€‚å½“éœ€è¦è¿›è¡Œå†…å­˜åˆ†é…æ—¶ï¼Œå½“å‰è¿è¡Œçš„goroutineä¼šä»mcacheä¸­æŸ¥æ‰¾å¯ç”¨çš„mspanã€‚ä»æœ¬åœ°mcacheé‡Œåˆ†é…å†…å­˜æ—¶ä¸éœ€è¦åŠ é”ï¼Œè¿™ç§åˆ†é…ç­–ç•¥æ•ˆç‡æ›´é«˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%B0%8F%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D.png&#34;
	width=&#34;587&#34;
	height=&#34;388&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%B0%8F%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D_hu0a7abb04b5d962db8f63232a4446f9b7_55474_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E5%B0%8F%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D_hu0a7abb04b5d962db8f63232a4446f9b7_55474_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;151&#34;
		data-flex-basis=&#34;363px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä½†æ˜¯æœ‰çš„å˜é‡å¾ˆå°å°±æ˜¯æ•°å­—ï¼Œæœ‰çš„å´æ˜¯ä¸€ä¸ªå¤æ‚çš„ç»“æ„ä½“ï¼Œç”³è¯·å†…å­˜æ—¶éƒ½åˆ†ç»™ä»–ä»¬ä¸€ä¸ªmspanè¿™æ ·çš„å•å…ƒä¼šä¸ä¼šäº§ç”Ÿæµªè´¹ã€‚å…¶å®mcacheæŒæœ‰çš„è¿™ä¸€ç³»åˆ—çš„mspanå¹¶ä¸éƒ½æ˜¯ç»Ÿä¸€å¤§å°çš„ï¼Œè€Œæ˜¯æŒ‰ç…§å¤§å°ï¼Œä»8å­—èŠ‚åˆ°32KBåˆ†äº†67ç±»çš„msapnã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/mcache.png&#34;
	width=&#34;502&#34;
	height=&#34;409&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/mcache_huf455407eec686e2a53900cf86012cf72_55182_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/mcache_huf455407eec686e2a53900cf86012cf72_55182_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;122&#34;
		data-flex-basis=&#34;294px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç»“æ„ä½“åˆšå¥½æ˜¯32å­—èŠ‚ï¼Œæ‰€ä»¥ç›´æ¥åˆ†é…åˆ°å…¶ä¸­ä¸€ä¸ªï¼Œä½†æ˜¯å¦‚æœmcachceé‡Œæ²¡æœ‰ç©ºé—²çš„32å­—èŠ‚çš„mspanäº†è¯¥æ€ä¹ˆåŠï¼ŸGoé‡Œè¿˜ä¸ºæ¯ç§ç±»åˆ«çš„mspanç»´æŠ¤ç€ä¸€ä¸ªmcentralã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåˆšæ‰è¯´è¿‡mcentralçš„ä½œç”¨æ˜¯ä¸ºæ‰€æœ‰mcacheæä¾›åˆ‡åˆ†å¥½çš„mspanèµ„æºã€‚æ¯ä¸ªcentralä¼šæŒæœ‰ä¸€ç§ç‰¹å®šå¤§å°çš„å…¨å±€mspanåˆ—è¡¨ï¼ŒåŒ…æ‹¬å·²åˆ†é…å‡ºå»çš„å’Œæœªåˆ†é…å‡ºå»çš„ã€‚ æ¯ä¸ªmcentralå¯¹åº”ä¸€ç§mspanï¼Œå½“å·¥ä½œçº¿ç¨‹çš„mcacheä¸­æ²¡æœ‰åˆé€‚ï¼ˆä¹Ÿå°±æ˜¯ç‰¹å®šå¤§å°çš„ï¼‰çš„mspanæ—¶å°±ä¼šä»mcentral å»è·å–ã€‚mcentralè¢«æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹å…±åŒäº«æœ‰ï¼Œå­˜åœ¨å¤šä¸ªgoroutineç«äº‰çš„æƒ…å†µï¼Œå› æ­¤ä»mcentralè·å–èµ„æºæ—¶éœ€è¦åŠ é”ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒmcentralé‡Œç»´æŠ¤ç€ä¸¤ä¸ªåŒå‘é“¾è¡¨ï¼Œnonemptyè¡¨ç¤ºé“¾è¡¨é‡Œè¿˜æœ‰ç©ºé—²çš„mspanå¾…åˆ†é…ã€‚emptyè¡¨ç¤ºè¿™æ¡é“¾è¡¨é‡Œçš„mspanéƒ½è¢«åˆ†é…äº†objectã€‚&lt;/p&gt;
&lt;p&gt;mcacheä»mcentralè·å–å’Œå½’è¿˜mspançš„æµç¨‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è·å– åŠ é”ï¼›ä»nonemptyé“¾è¡¨æ‰¾åˆ°ä¸€ä¸ªå¯ç”¨çš„mspanï¼›å¹¶å°†å…¶ä»nonemptyé“¾è¡¨åˆ é™¤ï¼›å°†å–å‡ºçš„mspanåŠ å…¥åˆ°emptyé“¾è¡¨ï¼›å°†mspanè¿”å›ç»™å·¥ä½œçº¿ç¨‹ï¼›è§£é”ã€‚&lt;/li&gt;
&lt;li&gt;å½’è¿˜ åŠ é”ï¼›å°†mspanä»emptyé“¾è¡¨åˆ é™¤ï¼›å°†mspanåŠ å…¥åˆ°nonemptyé“¾è¡¨ï¼›è§£é”ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/mcache%E4%BB%8Emcentra%E8%8E%B7%E5%8F%96mspan.png&#34;
	width=&#34;705&#34;
	height=&#34;412&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/mcache%E4%BB%8Emcentra%E8%8E%B7%E5%8F%96mspan_hu01d050465a2ccc25b5a7a33d343309cb_65891_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/mcache%E4%BB%8Emcentra%E8%8E%B7%E5%8F%96mspan_hu01d050465a2ccc25b5a7a33d343309cb_65891_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;171&#34;
		data-flex-basis=&#34;410px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;å½“mcentralæ²¡æœ‰ç©ºé—²çš„mspanæ—¶ï¼Œä¼šå‘mheapç”³è¯·ã€‚è€Œmheapæ²¡æœ‰èµ„æºæ—¶ï¼Œä¼šå‘æ“ä½œç³»ç»Ÿç”³è¯·æ–°å†…å­˜ã€‚mheapä¸»è¦ç”¨äºå¤§å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œä»¥åŠç®¡ç†æœªåˆ‡å‰²çš„mspanï¼Œç”¨äºç»™mcentralåˆ‡å‰²æˆå°å¯¹è±¡ã€‚mheapä¸­å«æœ‰æ‰€æœ‰è§„æ ¼çš„mcentralï¼Œæ‰€ä»¥ï¼Œå½“ä¸€ä¸ªmcacheä»mcentralç”³è¯·mspanæ—¶ï¼Œåªéœ€è¦åœ¨ç‹¬ç«‹çš„mcentralä¸­ä½¿ç”¨é”ï¼Œå¹¶ä¸ä¼šå½±å“ç”³è¯·å…¶ä»–è§„æ ¼çš„mspanã€‚&lt;/p&gt;
&lt;p&gt;mheapé‡Œçš„arena åŒºåŸŸæ˜¯çœŸæ­£çš„å †åŒºï¼Œè¿è¡Œæ—¶ä¼šå°† 8KB çœ‹åšä¸€é¡µï¼Œè¿™äº›å†…å­˜é¡µä¸­å­˜å‚¨äº†æ‰€æœ‰åœ¨å †ä¸Šåˆå§‹åŒ–çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/mheap.png&#34;
	width=&#34;457&#34;
	height=&#34;309&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/mheap_hu0fbf48ef2fe0ee1b99027905191b94d3_36230_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/mheap_hu0fbf48ef2fe0ee1b99027905191b94d3_36230_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;147&#34;
		data-flex-basis=&#34;354px&#34;
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;å¤§äº-32-kb-å†…å­˜å—çš„å†…å­˜åˆ†é…&#34;&gt;å¤§äº 32 KB å†…å­˜å—çš„å†…å­˜åˆ†é…&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒGoæ²¡æ³•ä½¿ç”¨å·¥ä½œçº¿ç¨‹çš„æœ¬åœ°ç¼“å­˜mcacheå’Œå…¨å±€ä¸­å¿ƒç¼“å­˜mcentralä¸Šç®¡ç†è¶…è¿‡32KBçš„å†…å­˜åˆ†é…ï¼Œæ‰€ä»¥å¯¹äºé‚£äº›è¶…è¿‡32KBçš„å†…å­˜ç”³è¯·ï¼Œä¼šç›´æ¥ä»å †ä¸Š(mheap)ä¸Šåˆ†é…å¯¹åº”çš„æ•°é‡çš„å†…å­˜é¡µï¼ˆæ¯é¡µå¤§å°æ˜¯8KBï¼‰ç»™ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%A4%A7%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D.png&#34;
	width=&#34;588&#34;
	height=&#34;201&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%A4%A7%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D_hud16c384e94a535d77d496485f3d694cf_35309_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E5%A4%A7%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D_hud16c384e94a535d77d496485f3d694cf_35309_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;292&#34;
		data-flex-basis=&#34;702px&#34;
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;é€ƒé€¸åˆ†æ&#34;&gt;é€ƒé€¸åˆ†æ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒé€šå¸¸æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨æ˜¯å€¾å‘äºå°†å˜é‡åˆ†é…åˆ°æ ˆä¸Šçš„ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å°ï¼Œæœ€æç«¯çš„å°±æ˜¯&amp;quot;zero garbage&amp;quot;ï¼Œæ‰€æœ‰çš„å˜é‡éƒ½ä¼šåœ¨æ ˆä¸Šåˆ†é…ï¼Œè¿™æ ·å°±ä¸ä¼šå­˜åœ¨å†…å­˜ç¢ç‰‡ï¼Œåƒåœ¾å›æ”¶ä¹‹ç±»çš„ä¸œè¥¿ã€‚å˜é‡æ˜¯åœ¨æ ˆä¸Šåˆ†é…è¿˜æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼Œæ˜¯ç”±é€ƒé€¸åˆ†æçš„ç»“æœå†³å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;Go å®˜æ–¹ä¸Šæœ‰è¿™ä¹ˆä¸€æ®µå†…å­˜é€ƒé€¸åˆ†æçš„QA&lt;/p&gt;
&lt;p&gt;Qï¼šå¦‚ä½•å¾—çŸ¥å˜é‡æ˜¯åˆ†é…åœ¨æ ˆï¼ˆstackï¼‰ä¸Šè¿˜æ˜¯å †ï¼ˆheapï¼‰ä¸Šï¼Ÿ&lt;/p&gt;
&lt;p&gt;A: å‡†ç¡®åœ°è¯´ï¼Œä½ å¹¶ä¸éœ€è¦çŸ¥é“ã€‚Golang ä¸­çš„å˜é‡åªè¦è¢«å¼•ç”¨å°±ä¸€ç›´ä¼šå­˜æ´»ï¼Œå­˜å‚¨åœ¨å †ä¸Šè¿˜æ˜¯æ ˆä¸Šç”±å†…éƒ¨å®ç°å†³å®šè€Œå’Œå…·ä½“çš„è¯­æ³•æ²¡æœ‰å…³ç³»ã€‚çŸ¥é“å˜é‡çš„å­˜å‚¨ä½ç½®ç¡®å®å¯¹ç¨‹åºçš„æ•ˆç‡æœ‰å¸®åŠ©ã€‚å¦‚æœå¯èƒ½ï¼ŒGolang ç¼–è¯‘å™¨ä¼šå°†å‡½æ•°çš„å±€éƒ¨å˜é‡åˆ†é…åˆ°å‡½æ•°æ ˆå¸§ï¼ˆstack frameï¼‰ä¸Šã€‚ç„¶è€Œï¼Œå¦‚æœç¼–è¯‘å™¨ä¸èƒ½ç¡®ä¿å˜é‡åœ¨å‡½æ•° return ä¹‹åä¸å†è¢«å¼•ç”¨ï¼Œç¼–è¯‘å™¨å°±ä¼šå°†å˜é‡åˆ†é…åˆ°å †ä¸Šã€‚è€Œä¸”ï¼Œå¦‚æœä¸€ä¸ªå±€éƒ¨å˜é‡éå¸¸å¤§ï¼Œé‚£ä¹ˆå®ƒä¹Ÿåº”è¯¥è¢«åˆ†é…åˆ°å †ä¸Šè€Œä¸æ˜¯æ ˆä¸Šã€‚å½“å‰æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªå˜é‡è¢«å–åœ°å€ï¼Œé‚£ä¹ˆå®ƒå°±æœ‰å¯èƒ½è¢«åˆ†é…åˆ°å †ä¸Šã€‚ç„¶è€Œï¼Œè¿˜è¦å¯¹è¿™äº›å˜é‡åšé€ƒé€¸åˆ†æï¼Œå¦‚æœå‡½æ•° return ä¹‹åï¼Œå˜é‡ä¸å†è¢«å¼•ç”¨ï¼Œåˆ™å°†å…¶åˆ†é…åˆ°æ ˆä¸Šã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒGoç¼–è¯‘å™¨ä¼šè·¨è¶Šå‡½æ•°å’ŒåŒ…çš„è¾¹ç•Œè¿›è¡Œå…¨å±€çš„é€ƒé€¸åˆ†æã€‚å®ƒä¼šæ£€æŸ¥æ˜¯å¦éœ€è¦åœ¨å †ä¸Šä¸ºä¸€ä¸ªå˜é‡åˆ†é…å†…å­˜ï¼Œè¿˜æ˜¯è¯´å¯ä»¥åœ¨æ ˆæœ¬èº«çš„å†…å­˜é‡Œå¯¹å…¶è¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
  &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Called heapAnalysis&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;heapAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//go:noinline
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;heapAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
   &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;55&lt;/span&gt;
   &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;build&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gcflags&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;-m -l&amp;#34;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escapes&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;moved&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Called heapAnalysis&amp;#34;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escapes&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;49&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;heapAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escapes&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;argument&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;does&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escape&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90.png&#34;
	width=&#34;714&#34;
	height=&#34;520&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90_hube57392961af9e80ebdc2f4a8a25d343_24148_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-management/%E9%80%83%E9%80%B8%E5%88%86%E6%9E%90_hube57392961af9e80ebdc2f4a8a25d343_24148_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;137&#34;
		data-flex-basis=&#34;329px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;mainå’ŒheapAnalysiså‡½æ•°åˆ†é…åœ¨ä¸€ä¸ªæ ˆä¸Šã€‚ç”±äºå‡½æ•°å…·æœ‰è‡ªå·±çš„å˜é‡ï¼Œå› æ­¤ä¹Ÿä¼šå°†å˜é‡åˆ†é…åˆ°æ ˆçš„æŸä¸ªåœ°æ–¹ã€‚ä½†æ˜¯ç¼–è¯‘å™¨æ£€æŸ¥åˆ°è¯¥å€¼æ˜¯è¿”å›äº†å®ƒçš„æŒ‡é’ˆï¼Œå¹¶ä¸”å·²ç”¨äºå¦ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤å˜é‡è¢«ç§»åˆ°äº†å †ä¸­ï¼Œä¸»å‡½æ•°ä¼šä»å †ä¸­è®¿é—®è¯¥å˜é‡ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸ªç‰¹æ®Šè¯´æ˜ï¼Œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;fmt&amp;#34;&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Called stackAnalysis&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stackAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;c1&#34;&gt;//go:noinline (åŠ ä¸€è¡Œç‰¹æ®Šçš„æ³¨é‡Šè®©ç¼–è¯‘å™¨ä¸å¯¹å‡½æ•°è¿›è¡Œå†…è”ï¼Œå†…è”æ˜¯ä¸€ç§æ‰‹åŠ¨æˆ–ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œç”¨äºå°†ç®€çŸ­å‡½æ•°çš„è°ƒç”¨æ›¿æ¢ä¸ºå‡½æ•°ä½“æœ¬èº«ã€‚è¿™ä¹ˆåšçš„åŸå› æ˜¯å®ƒå¯ä»¥æ¶ˆé™¤å‡½æ•°è°ƒç”¨æœ¬èº«çš„å¼€é”€ï¼Œä¹Ÿä½¿å¾—ç¼–è¯‘å™¨èƒ½æ›´é«˜æ•ˆåœ°æ‰§è¡Œå…¶ä»–çš„ä¼˜åŒ–ç­–ç•¥)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stackAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;55&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;build&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gcflags&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;-m -l&amp;#34;&lt;/span&gt;

&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;14&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Called stackAnalysis&amp;#34;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escapes&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;51&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;stackAnalysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escapes&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;to&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;heap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;scratch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;...&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;argument&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;does&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;escape&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ç¬¬4è¡Œ14ä¸ªå­—ç¬¦å¤„çš„å­—ç¬¦ä¸²æ ‡é‡&amp;quot;Called stackAnalysis&amp;quot;é€ƒé€¸åˆ°å †ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬4è¡Œ51ä¸ªå­—ç¬¦ä¸²çš„å‡½æ•°è°ƒç”¨stackAnalysis()é€ƒé€¸åˆ°äº†å †ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;escapes to heap&amp;quot;çš„æ„æ€æ˜¯å˜é‡éœ€è¦åœ¨å‡½æ•°æ ˆä¹‹é—´å…±äº«ï¼Œä¸Šé¢çš„ä¾‹å­å°±æ˜¯åœ¨&lt;code&gt;main&lt;/code&gt;å’Œ&lt;code&gt;fmt.Println&lt;/code&gt;ä¹‹é—´å…±äº«ã€‚mainå’ŒstackAnalysiså‡½æ•°åˆ†é…åœ¨ä¸€ä¸ªæ ˆä¸Šã€‚ç”±äºå‡½æ•°å…·æœ‰è‡ªå·±çš„å˜é‡ï¼Œå› æ­¤ä¹Ÿä¼šå°†å˜é‡åˆ†é…åˆ°æ ˆçš„æŸä¸ªåœ°æ–¹ã€‚å½“å‡½æ•°è¿”å›æ—¶ï¼Œä¸è¯¥å‡½æ•°å…³è”çš„æ‰€æœ‰å˜é‡ä¹Ÿä¼šä»å†…å­˜ä¸­åˆ é™¤ã€‚è¿™é‡Œå¹¶æ²¡æœ‰é€ƒé€¸åˆ°å †ä¸Šï¼Œè€Œæ˜¯åœ¨æ ˆä¸Šã€‚è¿™é‡Œæ˜¯å› ä¸º&lt;code&gt;fmt.Print&lt;/code&gt;ç³»åˆ—çš„å‡½æ•°é—®é¢˜ï¼Œå˜é‡é€ƒé€¸äº†ï¼Œå¦‚æœæ˜¯&lt;code&gt;print&lt;/code&gt;ï¼Œä¼šæ‰“å°çš„æ˜¯&lt;code&gt;does not escape&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åƒåœ¾å›æ”¶&#34;&gt;åƒåœ¾å›æ”¶&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå†…å­˜åˆ†é…äº†ä¹‹åè¦å›æ”¶ï¼Œè¿™å°±éœ€è¦ GCã€‚ä»€ä¹ˆæ˜¯ GCï¼ŸPHPã€Java å’Œ Go ç­‰è¯­è¨€ä½¿ç”¨è‡ªåŠ¨çš„å†…å­˜ç®¡ç†ç³»ç»Ÿï¼Œæœ‰å†…å­˜åˆ†é…å™¨å’Œåƒåœ¾æ”¶é›†å™¨æ¥ä»£ä¸ºåˆ†é…å’Œå›æ”¶å†…å­˜ï¼Œå…¶ä¸­åƒåœ¾æ”¶é›†å™¨å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„GCã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸»è¦åŸå› æ˜¯æ ˆæ˜¯ä¸€å—ä¸“ç”¨å†…å­˜ï¼Œä¸“é—¨ä¸ºäº†å‡½æ•°æ‰§è¡Œè€Œå‡†å¤‡çš„ï¼Œå­˜å‚¨ç€å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡ä»¥åŠè°ƒç”¨æ ˆã€‚é™¤æ­¤ä»¥å¤–ï¼Œæ ˆä¸­çš„æ•°æ®éƒ½æœ‰ä¸€ä¸ªç‰¹ç‚¹â€”â€”ç®€å•ã€‚æ¯”å¦‚å±€éƒ¨å˜é‡ä¸èƒ½è¢«å‡½æ•°å¤–è®¿é—®ï¼Œæ‰€ä»¥è¿™å—å†…å­˜ç”¨å®Œå°±å¯ä»¥ç›´æ¥é‡Šæ”¾ã€‚æ­£æ˜¯å› ä¸ºè¿™ä¸ªç‰¹ç‚¹ï¼Œæ ˆä¸­çš„æ•°æ®å¯ä»¥é€šè¿‡ç®€å•çš„ç¼–è¯‘å™¨æŒ‡ä»¤è‡ªåŠ¨æ¸…ç†ï¼Œå¹¶ä¸éœ€è¦é€šè¿‡ GC æ¥å›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒGoçš„åƒåœ¾æ”¶é›†å™¨ä»ä¸€å¼€å§‹åˆ°ç°åœ¨ä¸€ç›´åœ¨æ¼”è¿›ï¼Œåœ¨v1.5ç‰ˆæœ¬å¼€å§‹ä¸‰è‰²æ ‡è®°æ³•ä½œä¸ºåƒåœ¾å›æ”¶ç®—æ³•å‰ä½¿ç”¨Mark-And-Sweepï¼ˆæ ‡è®°æ¸…é™¤ï¼‰ç®—æ³•ã€‚ä»v1.5ç‰ˆæœ¬Goå®ç°äº†åŸºäºä¸‰è‰²æ ‡è®°æ¸…é™¤çš„å¹¶å‘åƒåœ¾æ”¶é›†å™¨ï¼Œå¤§å¹…åº¦é™ä½åƒåœ¾æ”¶é›†çš„å»¶è¿Ÿä»å‡ ç™¾ ms é™ä½è‡³ 10ms ä»¥ä¸‹ã€‚åœ¨v1.8åˆä½¿ç”¨æ··åˆå†™å±éšœå°†åƒåœ¾æ”¶é›†çš„æ—¶é—´ç¼©çŸ­è‡³ 0.5ms ä»¥å†…ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¸‰è‰²æ ‡è®°æ³•&#34;&gt;ä¸‰è‰²æ ‡è®°æ³•&lt;/h4&gt;
&lt;p&gt;ä¸‰è‰²æ ‡è®°ç®—æ³•å°†ç¨‹åºä¸­çš„å¯¹è±¡åˆ†æˆç™½è‰²ã€é»‘è‰²å’Œç°è‰²ä¸‰ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç™½è‰²å¯¹è±¡ â€” æ½œåœ¨çš„åƒåœ¾ï¼Œå…¶å†…å­˜å¯èƒ½ä¼šè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ï¼›&lt;/li&gt;
&lt;li&gt;é»‘è‰²å¯¹è±¡ â€” æ´»è·ƒçš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ä¸å­˜åœ¨ä»»ä½•å¼•ç”¨å¤–éƒ¨æŒ‡é’ˆçš„å¯¹è±¡ä»¥åŠä»æ ¹å¯¹è±¡å¯è¾¾çš„å¯¹è±¡ï¼Œåƒåœ¾å›æ”¶å™¨ä¸ä¼šæ‰«æè¿™äº›å¯¹è±¡çš„å­å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;ç°è‰²å¯¹è±¡ â€” æ´»è·ƒçš„å¯¹è±¡ï¼Œå› ä¸ºå­˜åœ¨æŒ‡å‘ç™½è‰²å¯¹è±¡çš„å¤–éƒ¨æŒ‡é’ˆï¼Œåƒåœ¾æ”¶é›†å™¨ä¼šæ‰«æè¿™äº›å¯¹è±¡çš„å­å¯¹è±¡ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥ï¼šåœ¨è¿›å…¥GCçš„ä¸‰è‰²æ ‡è®°é˜¶æ®µçš„ä¸€å¼€å§‹ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B61.jpg&#34;
	width=&#34;720&#34;
	height=&#34;426&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B61_hu47e13ab40d59a7dbeb4345aef9037e83_25943_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B61_hu47e13ab40d59a7dbeb4345aef9037e83_25943_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶1&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;169&#34;
		data-flex-basis=&#34;405px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ­¥, éå†æ ¹èŠ‚ç‚¹é›†åˆé‡Œçš„æ‰€æœ‰æ ¹å¯¹è±¡ï¼ŒæŠŠæ ¹å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼Œä»ç™½è‰²é›†åˆæ”¾å…¥ç°è‰²é›†åˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B62.jpg&#34;
	width=&#34;720&#34;
	height=&#34;428&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B62_hu1266a4c5006d9b335b85b45076e6c874_28044_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B62_hu1266a4c5006d9b335b85b45076e6c874_28044_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶2&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;168&#34;
		data-flex-basis=&#34;403px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ­¥, éå†ç°è‰²é›†åˆï¼Œå°†ç°è‰²å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ä»ç™½è‰²é›†åˆæ”¾å…¥ç°è‰²é›†åˆï¼Œä¹‹åå°†æ­¤ç°è‰²å¯¹è±¡æ”¾å…¥é»‘è‰²é›†åˆ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B63.jpg&#34;
	width=&#34;720&#34;
	height=&#34;430&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B63_hufbdd632f9c4321623f7119de15bdc380_27970_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B63_hufbdd632f9c4321623f7119de15bdc380_27970_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶3&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;167&#34;
		data-flex-basis=&#34;401px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬å››æ­¥ï¼šé‡å¤ç¬¬ä¸‰æ­¥, ç›´åˆ°ç°è‰²é›†åˆä¸­æ— ä»»ä½•å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B64.jpg&#34;
	width=&#34;720&#34;
	height=&#34;439&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B64_hu228be264abaf447f28961f3a9f627d9d_26763_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B64_hu228be264abaf447f28961f3a9f627d9d_26763_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶4&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;164&#34;
		data-flex-basis=&#34;393px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;ç¬¬äº”æ­¥ï¼šå›æ”¶ç™½è‰²é›†åˆé‡Œçš„æ‰€æœ‰å¯¹è±¡ï¼Œæœ¬æ¬¡åƒåœ¾å›æ”¶ç»“æŸã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B65.jpg&#34;
	width=&#34;720&#34;
	height=&#34;428&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B65_hud370c5a2f5c2961c316d38b35214f886_22204_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B65_hud370c5a2f5c2961c316d38b35214f886_22204_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶5&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;168&#34;
		data-flex-basis=&#34;403px&#34;
	
&gt;&lt;/p&gt;
&lt;h4 id=&#34;å†™å±éšœ&#34;&gt;å†™å±éšœ&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒGo åœ¨GCé˜¶æ®µæ‰§è¡Œä¸‰è‰²æ ‡è®°å‰ï¼Œè¿˜éœ€è¦å…ˆåšä¸€ä¸ªå‡†å¤‡å·¥ä½œâ€”â€”æ‰“å¼€å†™å±éšœ(Write Barrier)ã€‚é‚£ä¹ˆå†™å±éšœæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ä¸‰è‰²æ ‡è®°æ³•æ˜¯ä¸€ç§å¯ä»¥å¹¶å‘æ‰§è¡Œçš„ç®—æ³•ã€‚æ‰€ä»¥åœ¨GCè¿è¡Œè¿‡ç¨‹ä¸­ç¨‹åºçš„å‡½æ•°æ ˆå†…å¯èƒ½ä¼šæœ‰æ–°åˆ†é…çš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™äº›å¯¹è±¡è¯¥æ€ä¹ˆé€šçŸ¥åˆ° GCï¼Œæ€ä¹ˆç»™ä»–ä»¬ç€è‰²å‘¢ï¼Ÿå¦‚æœè¿˜æ˜¯æŒ‰ç…§ä¹‹å‰æ–°å»ºçš„å¯¹è±¡æ ‡è®°ä¸ºç™½è‰²å°±æœ‰å¯èƒ½å‡ºç°ä¸‹å›¾ä¸­çš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B66.jpg&#34;
	width=&#34;720&#34;
	height=&#34;421&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B66_hu0075fe4baa98b4118e04fb866f09037d_29307_480x0_resize_q75_box.jpg 480w, https://zonzeeli.github.io/p/memory-management/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B66_hu0075fe4baa98b4118e04fb866f09037d_29307_1024x0_resize_q75_box.jpg 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;åƒåœ¾å›æ”¶6&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;171&#34;
		data-flex-basis=&#34;410px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ GC è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåº”ç”¨ç¨‹åºæ–°å»ºäº†å¯¹è±¡ Iï¼Œæ­¤æ—¶å¦‚æœå·²ç»æ ‡è®°æˆé»‘çš„å¯¹è±¡Få¼•ç”¨äº†å¯¹è±¡ Iï¼Œé‚£ä¹ˆåœ¨æœ¬æ¬¡ GC æ‰§è¡Œè¿‡ç¨‹ä¸­å› ä¸ºé»‘è‰²å¯¹è±¡ä¸ä¼šå†æ¬¡æ‰«æï¼Œæ‰€ä»¥å¦‚æœIç€è‰²æˆç™½è‰²çš„è¯ï¼Œä¼šè¢«å›æ”¶æ‰ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å…è®¸çš„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™ä¸ªæ—¶å€™å°±éœ€è¦æˆ‘ä»¬çš„å†™å±éšœå‡ºé©¬äº†ã€‚å†™å±éšœä¸»è¦åšä¸€ä»¶äº‹æƒ…ï¼Œä¿®æ”¹åŸå…ˆçš„å†™é€»è¾‘ï¼Œç„¶ååœ¨å¯¹è±¡æ–°å¢çš„åŒæ—¶ç»™å®ƒç€è‰²ï¼Œå¹¶ä¸”ç€è‰²ä¸ºç°è‰²ã€‚å› æ­¤æ‰“å¼€äº†å†™å±éšœå¯ä»¥ä¿è¯äº†ä¸‰è‰²æ ‡è®°æ³•åœ¨å¹¶å‘ä¸‹å®‰å…¨æ­£ç¡®åœ°è¿è¡Œã€‚é‚£ä¹ˆæœ‰äººå°±ä¼šé—®è¿™äº›å†™å±éšœæ ‡è®°æˆç°è‰²çš„å¯¹è±¡ä»€ä¹ˆæ—¶å€™å›æ”¶å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åç»­çš„ GC è¿‡ç¨‹ä¸­å›æ”¶ï¼Œåœ¨æ–°çš„ GC è¿‡ç¨‹ä¸­æ‰€æœ‰å·²å­˜å¯¹è±¡å°±åˆä»ç™½è‰²å¼€å§‹é€æ­¥è¢«æ ‡è®°å•¦ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¸‰è‰²ä¸å˜æ€§&#34;&gt;ä¸‰è‰²ä¸å˜æ€§&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒæƒ³è¦åœ¨å¹¶å‘æˆ–è€…å¢é‡çš„æ ‡è®°ç®—æ³•ä¸­ä¿è¯æ­£ç¡®æ€§ï¼Œæˆ‘ä»¬éœ€è¦è¾¾æˆä»¥ä¸‹ä¸¤ç§ä¸‰è‰²ä¸å˜æ€§ï¼ˆTri-color invariantï¼‰ä¸­çš„ä»»æ„ä¸€ç§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¼ºä¸‰è‰²ä¸å˜æ€§ â€” é»‘è‰²å¯¹è±¡ä¸ä¼šæŒ‡å‘ç™½è‰²å¯¹è±¡ï¼Œåªä¼šæŒ‡å‘ç°è‰²å¯¹è±¡æˆ–è€…é»‘è‰²å¯¹è±¡ï¼›&lt;/li&gt;
&lt;li&gt;å¼±ä¸‰è‰²ä¸å˜æ€§ â€” é»‘è‰²å¯¹è±¡æŒ‡å‘çš„ç™½è‰²å¯¹è±¡å¿…é¡»åŒ…å«ä¸€æ¡ä»ç°è‰²å¯¹è±¡ç»ç”±å¤šä¸ªç™½è‰²å¯¹è±¡çš„å¯è¾¾è·¯å¾„&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;å±éšœæŠ€æœ¯&#34;&gt;å±éšœæŠ€æœ¯&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒåƒåœ¾æ”¶é›†ä¸­çš„å±éšœæŠ€æœ¯æ›´åƒæ˜¯ä¸€ä¸ªé’©å­æ–¹æ³•ï¼Œå®ƒæ˜¯åœ¨ç”¨æˆ·ç¨‹åºè¯»å–å¯¹è±¡ã€åˆ›å»ºæ–°å¯¹è±¡ä»¥åŠæ›´æ–°å¯¹è±¡æŒ‡é’ˆæ—¶æ‰§è¡Œçš„ä¸€æ®µä»£ç ï¼Œæ ¹æ®æ“ä½œç±»å‹çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬åˆ†æˆè¯»å±éšœï¼ˆRead barrierï¼‰å’Œå†™å±éšœï¼ˆWrite barrierï¼‰ä¸¤ç§ï¼Œå› ä¸ºè¯»å±éšœéœ€è¦åœ¨è¯»æ“ä½œä¸­åŠ å…¥ä»£ç ç‰‡æ®µï¼Œå¯¹ç”¨æˆ·ç¨‹åºçš„æ€§èƒ½å½±å“å¾ˆå¤§ï¼Œæ‰€ä»¥ç¼–ç¨‹è¯­è¨€å¾€å¾€éƒ½ä¼šé‡‡ç”¨å†™å±éšœä¿è¯ä¸‰è‰²ä¸å˜æ€§ã€‚&lt;/p&gt;
&lt;h4 id=&#34;go-çš„æ··åˆå†™å±éšœ&#34;&gt;Go çš„æ··åˆå†™å±éšœ&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨Go è¯­è¨€ v1.7 ç‰ˆæœ¬ä¹‹å‰ï¼Œä½¿ç”¨çš„æ˜¯Dijkstraæ’å…¥å†™å±éšœä¿è¯å¼ºä¸‰è‰²ä¸å˜æ€§ï¼Œä½†æ˜¯è¿è¡Œæ—¶å¹¶æ²¡æœ‰åœ¨æ‰€æœ‰çš„åƒåœ¾æ”¶é›†æ ¹å¯¹è±¡ä¸Šå¼€å¯æ’å…¥å†™å±éšœã€‚å› ä¸º Go è¯­è¨€çš„åº”ç”¨ç¨‹åºå¯èƒ½åŒ…å«æˆç™¾ä¸Šåƒçš„ goroutineï¼Œè€Œåƒåœ¾æ”¶é›†çš„æ ¹å¯¹è±¡ä¸€èˆ¬åŒ…æ‹¬å…¨å±€å˜é‡å’Œæ ˆå¯¹è±¡ï¼Œå¦‚æœè¿è¡Œæ—¶éœ€è¦åœ¨å‡ ç™¾ä¸ª goroutine çš„æ ˆä¸Šéƒ½å¼€å¯å†™å±éšœï¼Œä¼šå¸¦æ¥å·¨å¤§çš„é¢å¤–å¼€é”€ï¼Œæ‰€ä»¥ Go å›¢é˜Ÿåœ¨å®ç°ä¸Šé€‰æ‹©äº†åœ¨æ ‡è®°é˜¶æ®µå®Œæˆæ—¶æš‚åœç¨‹åºã€å°†æ‰€æœ‰æ ˆå¯¹è±¡æ ‡è®°ä¸ºç°è‰²å¹¶é‡æ–°æ‰«æï¼Œåœ¨æ´»è·ƒ goroutine éå¸¸å¤šçš„ç¨‹åºä¸­ï¼Œé‡æ–°æ‰«æçš„è¿‡ç¨‹éœ€è¦å ç”¨ 10 ~ 100ms çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;Go è¯­è¨€åœ¨ v1.8 ç»„åˆ Dijkstra æ’å…¥å†™å±éšœå’Œ Yuasa åˆ é™¤å†™å±éšœæ„æˆäº†å¦‚ä¸‹æ‰€ç¤ºçš„æ··åˆå†™å±éšœï¼Œè¯¥å†™å±éšœä¼šå°†è¢«è¦†ç›–çš„å¯¹è±¡æ ‡è®°æˆç°è‰²å¹¶åœ¨å½“å‰æ ˆæ²¡æœ‰æ‰«ææ—¶å°†æ–°å¯¹è±¡ä¹Ÿæ ‡è®°æˆç°è‰²ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;nf&#34;&gt;writePointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;slot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;nf&#34;&gt;shade&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;slot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;stack&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;grey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
        &lt;span class=&#34;nf&#34;&gt;shade&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;slot&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ptr&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒä¸ºäº†ç§»é™¤æ ˆçš„é‡æ‰«æè¿‡ç¨‹ï¼Œé™¤äº†å¼•å…¥æ··åˆå†™å±éšœä¹‹å¤–ï¼Œåœ¨åƒåœ¾æ”¶é›†çš„æ ‡è®°é˜¶æ®µï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†åˆ›å»ºçš„æ‰€æœ‰æ–°å¯¹è±¡éƒ½æ ‡è®°æˆé»‘è‰²ï¼Œé˜²æ­¢æ–°åˆ†é…çš„æ ˆå†…å­˜å’Œå †å†…å­˜ä¸­çš„å¯¹è±¡è¢«é”™è¯¯åœ°å›æ”¶ï¼Œå› ä¸ºæ ˆå†…å­˜åœ¨æ ‡è®°é˜¶æ®µæœ€ç»ˆéƒ½ä¼šå˜ä¸ºé»‘è‰²ï¼Œæ‰€ä»¥ä¸å†éœ€è¦é‡æ–°æ‰«ææ ˆç©ºé—´ã€‚&lt;/p&gt;
&lt;h4 id=&#34;ä¸€æ¬¡å®Œæ•´çš„gcè¿‡ç¨‹&#34;&gt;ä¸€æ¬¡å®Œæ•´çš„GCè¿‡ç¨‹&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒGoçš„åƒåœ¾å›æ”¶å™¨åœ¨ä½¿ç”¨äº†ä¸‰è‰²æ ‡è®°æ¸…é™¤ç®—æ³•å’Œæ··åˆå†™å±éšœåå¤§å¤§å‡å°‘äº†æš‚åœç¨‹åºï¼ˆSTWï¼‰çš„æ—¶é—´ï¼Œä¸»è¦æ˜¯åœ¨å¼€å¯å†™å±éšœå‰å’Œç§»é™¤å†™å±éšœå‰æš‚åœåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒGoçš„åƒåœ¾æ”¶é›†çš„æ•´ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†æˆæ ‡è®°å‡†å¤‡ã€æ ‡è®°ã€æ ‡è®°ç»ˆæ­¢å’Œæ¸…é™¤å››ä¸ªä¸åŒé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µå®Œæˆçš„å·¥ä½œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;h5 id=&#34;æ ‡è®°å‡†å¤‡é˜¶æ®µ&#34;&gt;æ ‡è®°å‡†å¤‡é˜¶æ®µ&lt;/h5&gt;
&lt;p&gt;â€ƒâ€ƒæš‚åœç¨‹åºï¼Œæ‰€æœ‰çš„å¤„ç†å™¨åœ¨è¿™æ—¶ä¼šè¿›å…¥å®‰å…¨ç‚¹ï¼ˆSafe pointï¼‰&lt;/p&gt;
&lt;h5 id=&#34;æ ‡è®°é˜¶æ®µ&#34;&gt;æ ‡è®°é˜¶æ®µ&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;å°†çŠ¶æ€åˆ‡æ¢è‡³ &lt;code&gt;_GCmark&lt;/code&gt;ã€å¼€å¯å†™å±éšœã€ç”¨æˆ·ç¨‹åºååŠ©ï¼ˆMutator Assisteï¼‰å¹¶å°†æ ¹å¯¹è±¡å…¥é˜Ÿï¼›&lt;/li&gt;
&lt;li&gt;æ¢å¤æ‰§è¡Œç¨‹åºï¼Œæ ‡è®°è¿›ç¨‹å’Œç”¨äºååŠ©çš„ç”¨æˆ·ç¨‹åºä¼šå¼€å§‹å¹¶å‘æ ‡è®°å†…å­˜ä¸­çš„å¯¹è±¡ï¼Œæ ‡è®°ç”¨çš„ç®—æ³•å°±æ˜¯ä¸Šé¢ä»‹ç»çš„ä¸‰è‰²æ ‡è®°æ¸…é™¤æ³•ã€‚å†™å±éšœä¼šå°†è¢«è¦†ç›–çš„æŒ‡é’ˆå’Œæ–°æŒ‡é’ˆéƒ½æ ‡è®°æˆç°è‰²ï¼Œè€Œæ‰€æœ‰æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½ä¼šè¢«ç›´æ¥æ ‡è®°æˆé»‘è‰²ï¼›&lt;/li&gt;
&lt;li&gt;å¼€å§‹æ‰«ææ ¹å¯¹è±¡ï¼ŒåŒ…æ‹¬æ‰€æœ‰ goroutine çš„æ ˆã€å…¨å±€å¯¹è±¡ä»¥åŠä¸åœ¨å †ä¸­çš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ï¼Œæ‰«æ goroutine æ ˆæœŸé—´ä¼šæš‚åœå½“å‰å¤„ç†å™¨ï¼›&lt;/li&gt;
&lt;li&gt;ä¾æ¬¡å¤„ç†ç°è‰²é˜Ÿåˆ—ä¸­çš„å¯¹è±¡ï¼Œå°†å¯¹è±¡æ ‡è®°æˆé»‘è‰²å¹¶å°†å®ƒä»¬æŒ‡å‘çš„å¯¹è±¡æ ‡è®°æˆç°è‰²ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åˆ†å¸ƒå¼çš„ç»ˆæ­¢ç®—æ³•æ£€æŸ¥å‰©ä½™çš„å·¥ä½œï¼Œå‘ç°æ ‡è®°é˜¶æ®µå®Œæˆåè¿›å…¥æ ‡è®°ç»ˆæ­¢é˜¶æ®µï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨æ ‡è®°å¼€å§‹çš„æ—¶å€™ï¼Œæ”¶é›†å™¨ä¼šé»˜è®¤æŠ¢å  25% çš„ CPU æ€§èƒ½ï¼Œå‰©ä¸‹çš„75%ä¼šåˆ†é…ç»™ç¨‹åºæ‰§è¡Œã€‚ä½†æ˜¯ä¸€æ—¦æ”¶é›†å™¨è®¤ä¸ºæ¥ä¸åŠè¿›è¡Œæ ‡è®°ä»»åŠ¡äº†ï¼Œå°±ä¼šæ”¹å˜è¿™ä¸ª 25% çš„æ€§èƒ½åˆ†é…ã€‚è¿™ä¸ªæ—¶å€™æ”¶é›†å™¨ä¼šæŠ¢å ç¨‹åºé¢å¤–çš„ CPUï¼Œè¿™éƒ¨åˆ†è¢«æŠ¢å  goroutine æœ‰ä¸ªåå­—å« Mark Assistã€‚è€Œä¸”å› ä¸ºæŠ¢å  CPUçš„ç›®çš„ä¸»è¦æ˜¯ GC æ¥ä¸åŠæ ‡è®°æ–°å¢çš„å†…å­˜ï¼Œé‚£ä¹ˆæŠ¢å æ­£åœ¨åˆ†é…å†…å­˜çš„ goroutine æ•ˆæœä¼šæ›´åŠ å¥½ï¼Œæ‰€ä»¥åˆ†é…å†…å­˜é€Ÿåº¦è¶Šå¿«çš„ goroutine å°±ä¼šè¢«æŠ¢å è¶Šå¤šçš„èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒé™¤æ­¤ä»¥å¤– GC è¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ä¼˜åŒ–ï¼Œä¸€æ—¦æŸæ¬¡ GC ä¸­ç”¨åˆ°äº† Mark Assistï¼Œä¸‹æ¬¡ GC å°±ä¼šæå‰å¼€å§‹ï¼Œç›®çš„æ˜¯å°½é‡å‡å°‘ Mark Assist çš„ä½¿ç”¨ï¼Œä»è€Œé¿å…å½±å“æ­£å¸¸çš„ç¨‹åºæ‰§è¡Œã€‚&lt;/p&gt;
&lt;h5 id=&#34;æ ‡è®°ç»ˆæ­¢é˜¶æ®µ&#34;&gt;æ ‡è®°ç»ˆæ­¢é˜¶æ®µ&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;æš‚åœç¨‹åºã€å°†çŠ¶æ€åˆ‡æ¢è‡³ &lt;code&gt;_GCmarktermination&lt;/code&gt; å¹¶å…³é—­è¾…åŠ©æ ‡è®°çš„ç”¨æˆ·ç¨‹åºï¼›&lt;/li&gt;
&lt;li&gt;æ¸…ç†å¤„ç†å™¨ä¸Šçš„çº¿ç¨‹ç¼“å­˜ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id=&#34;æ¸…ç†é˜¶æ®µ&#34;&gt;æ¸…ç†é˜¶æ®µ&lt;/h5&gt;
&lt;ul&gt;
&lt;li&gt;å°†çŠ¶æ€åˆ‡æ¢è‡³&lt;code&gt;_GCoff&lt;/code&gt;å¼€å§‹æ¸…ç†é˜¶æ®µï¼Œåˆå§‹åŒ–æ¸…ç†çŠ¶æ€å¹¶å…³é—­å†™å±éšœï¼›&lt;/li&gt;
&lt;li&gt;æ¢å¤ç”¨æˆ·ç¨‹åºï¼Œæ‰€æœ‰æ–°åˆ›å»ºçš„å¯¹è±¡ä¼šæ ‡è®°æˆç™½è‰²ï¼›&lt;/li&gt;
&lt;li&gt;åå°å¹¶å‘æ¸…ç†æ‰€æœ‰çš„å†…å­˜ç®¡ç†å•å…ƒï¼Œå½“ goroutine ç”³è¯·æ–°çš„å†…å­˜ç®¡ç†å•å…ƒæ—¶å°±ä¼šè§¦å‘æ¸…ç†ï¼›&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¸…ç†è¿™ä¸ªè¿‡ç¨‹æ˜¯å¹¶å‘è¿›è¡Œçš„ã€‚æ¸…æ‰«çš„å¼€é”€ä¼šå¢åŠ åˆ°åˆ†é…å †å†…å­˜çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶é—´ä¹Ÿæ˜¯æ— æ„ŸçŸ¥çš„ï¼Œä¸ä¼šä¸åƒåœ¾å›æ”¶çš„å»¶è¿Ÿç›¸å…³è”ã€‚&lt;/p&gt;
&lt;h5 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h5&gt;
&lt;p&gt;â€ƒâ€ƒGoçš„GCæœ€æ—©æœŸä½¿ç”¨çš„å›æ”¶ç®—æ³•æ˜¯æ ‡è®°-æ¸…é™¤ç®—æ³•ï¼Œè¯¥ç®—æ³•éœ€è¦åœ¨æ‰§è¡ŒæœŸé—´éœ€è¦æš‚åœåº”ç”¨ç¨‹åº(STW)ï¼Œæ— æ³•æ»¡è¶³å¹¶å‘ç¨‹åºçš„å®æ—¶æ€§ã€‚åé¢Goçš„GCè½¬ä¸ºä½¿ç”¨ä¸‰è‰²æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¹¶é€šè¿‡æ··åˆå†™å±éšœæŠ€æœ¯ä¿è¯äº†Goå¹¶å‘æ‰§è¡ŒGCæ—¶å†…å­˜ä¸­å¯¹è±¡çš„ä¸‰è‰²ä¸€è‡´æ€§ï¼ˆè¿™é‡Œçš„å¹¶å‘æŒ‡çš„æ˜¯GCå’Œåº”ç”¨ç¨‹åºçš„goroutineèƒ½åŒæ—¶æ‰§è¡Œï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒä¸€æ¬¡å®Œæ•´çš„åƒåœ¾å›æ”¶ä¼šåˆ†ä¸ºå››ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯æ ‡è®°å‡†å¤‡ã€æ ‡è®°ã€ç»“æŸæ ‡è®°ä»¥åŠæ¸…ç†ã€‚åœ¨æ ‡è®°å‡†å¤‡å’Œæ ‡è®°ç»“æŸé˜¶æ®µä¼šéœ€è¦ STWï¼Œæ ‡è®°é˜¶æ®µä¼šå‡å°‘ç¨‹åºçš„æ€§èƒ½ï¼Œè€Œæ¸…ç†é˜¶æ®µæ˜¯ä¸ä¼šå¯¹ç¨‹åºæœ‰å½±å“çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜æ³„æ¼&#34;&gt;å†…å­˜æ³„æ¼&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒå°½ç®¡æœ‰åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œè€Œä¸” Go è¯­è¨€çš„åƒåœ¾å›æ”¶å·²ç»åšçš„éå¸¸ä¼˜ç§€äº†ï¼Œå¾ˆå¤šæƒ…å†µéƒ½ä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨çš„é‡Šæ”¾å†…å­˜ï¼Œä½†æ˜¯çœŸçš„å°±å®Œå…¨æ²¡æœ‰é—®é¢˜äº†ä¹ˆï¼Ÿå½“ç„¶ä¸æ˜¯ï¼ŒGo è¿˜é¢ä¸´ç€éå¸¸å®¹æ˜“å‡ºç°çš„å†…å­˜æ³„éœ²é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿå¦‚ä¸‹ä»£ç ï¼Œæ˜¯å¦æœ‰é—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;ä¸¾ä¸ªç”Ÿäº§ç¯å¢ƒä¸­çš„ä¾‹å­ï¼Œä½¿ç”¨ Go è¯­è¨€å¼€å‘äº†ä¸€ä¸ª Gateway æœåŠ¡ï¼Œåœ¨å‘å¸ƒæµ‹è¯•ç¯å¢ƒåï¼Œå‡è®¾å¼€äº†3000ä¸ª TCP è¿æ¥åˆ°æ¸¸æˆï¼Œæ¸¸æˆæ•°æ®æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯å‘ç°å†…å­˜ä½¿ç”¨é‡ä¼šéšç€æ—¶é—´çš„æ¨ç§»æŒç»­å¢åŠ ï¼Œå› æ­¤æœåŠ¡çš„Podä¼šéš”ä¸€æ®µæ—¶é—´é‡å¯ä¸€æ¬¡ã€‚åŸå› æ˜¯ Gateway æ˜¯ä¸€ä¸ªè¯»å†™åˆ†ç¦»çš„ TCP æœåŠ¡ï¼Œæ¯ä¸€ä¸ªè¿æ¥è¦æœ‰ä¸¤ä¸ª goroutineï¼Œä¸€ä¸ªè¯»ä¸€ä¸ªå†™ï¼Œä½†æ˜¯ TCP è¿æ¥æ–­å¼€åï¼Œå› ä¸ºæ—¶åºé—®é¢˜ï¼Œgoroutineä¼šé˜»å¡ï¼Œä¸€ç›´æ²¡æœ‰ç»“æŸï¼Œæ²¡æœ‰é‡Šæ”¾æ‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œå†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰æ˜¯æŒ‡ç¨‹åºä¸­å·²åŠ¨æ€åˆ†é…çš„å †å†…å­˜ç”±äºæŸç§åŸå› ç¨‹åºæœªé‡Šæ”¾æˆ–æ— æ³•é‡Šæ”¾ï¼Œé€ æˆç³»ç»Ÿå†…å­˜çš„æµªè´¹ï¼Œå¯¼è‡´ç¨‹åºè¿è¡Œé€Ÿåº¦å‡æ…¢ç”šè‡³ç³»ç»Ÿå´©æºƒç­‰ä¸¥é‡åæœã€‚å¯ä»¥æ˜¯ç”¨ pprof åˆ†æä»£ç æ€§èƒ½ï¼Œé…åˆ graphvizï¼ŒäºŒè€…é…åˆèƒ½åˆ†æç¨‹åºè¿è¡Œä¸­çš„ç³»ç»Ÿå‚æ•°å’Œç¨‹åºå‚æ•°ç­‰ï¼Œå®šä½åˆ°æ¯ä¸ªå‡½æ•°ï¼Œæ›´ç›´è§‚çš„çœ‹å‡ºå ç”¨å†…å­˜ã€ä½¿ç”¨è€—æ—¶ç­‰æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°åˆšæ‰çš„é—®é¢˜ï¼Œç”±äºaå’ŒbæŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œaæ˜¯é™æ€å­˜å‚¨å˜é‡è¢«åˆ†é…äº†å›ºå®šçš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœç¨‹åº&lt;code&gt;f(b []int)&lt;/code&gt;ç»“æŸäº†ï¼Œbè¿™ç§åŠ¨æ€å˜é‡åº”è¯¥è¢«å›æ”¶äº†ï¼Œä½†æ˜¯ç”±äºaè¿˜åœ¨ä½¿ç”¨ï¼Œå°½ç®¡åªæ˜¯ä½¿ç”¨ä¸¤ä¸ªå…ƒç´ ï¼Œåé¢çš„å…ƒç´ æ¯«æ— ä½œç”¨ï¼Œä½†æ˜¯ä¾ç„¶ä¸ä¼šè¢«GCï¼Œæ‰€ä»¥å¯¼è‡´äº†æ³„æ¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// é™æ€å­˜å‚¨å˜é‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// b æ˜¯åŠ¨æ€å­˜å‚¨å˜é‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// a b éƒ½æŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œåªä¸è¿‡aåªåŒ…å«[:2]ï¼Œbæ˜¯å…¨éƒ¨
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;æ¨¡æ‹Ÿä¸€ä¸ªå†…å­˜æ³„æ¼çš„ä¾‹å­ï¼Œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ListenAndServe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;0.0.0.0:8090&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

    &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;wg&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;WaitGroup&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;one&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Wait&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;one&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10000&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;rand&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Int63&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
  
    &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;è¿™é‡Œçš„ goroutine ç”¨ channel æ¥æ¨¡æ‹Ÿé˜»å¡ï¼Œä¸€ç›´æ²¡æœ‰å…³é—­ï¼Œæ‰€ä»¥å†…å­˜ä¼šçˆ†ç‚¸å¢é•¿ã€‚&lt;/p&gt;
&lt;p&gt;æä¸ªé—®é¢˜ï¼Œå‡è®¾æˆ‘ä»¬æ­£å¸¸å…³é—­ goroutine äº†ï¼Œå†…å­˜å°±ä¼šé™ä¸‹æ¥äº†ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å½“æ‰€æœ‰çš„ goroutine éƒ½ç»“æŸæ—¶ï¼ŒGC ä¼šå¼€å§‹å›æ”¶åˆ‡ç‰‡ï¼Œä½†æ˜¯è¢«å›æ”¶çš„å†…å­˜ä¸ä¼šç›´æ¥æ¢ç»™æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯ç”± Go çš„ runtime æš‚æ—¶ä¿ç®¡ï¼ˆåœ¨ pprof åˆ†æä¸­ï¼Œå‚æ•° HeapIdle å€¼ä¼šå˜å¤§ï¼‰ï¼Œæ¥ä¸‹æ¥å¦‚æœå†æ¬¡éœ€è¦åˆ†é…ç©ºé—´ï¼ŒGo çš„ runtime å¯ä»¥ä¸å‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œç›´æ¥ä»è‡ªå·±ä¿ç®¡çš„é—²ç½®å†…å­˜ä¸­åˆ†é…ï¼Œè¿™æ ·å¯ä»¥æé«˜ç¨‹åºæ€§èƒ½ã€‚è‡³äº Go çš„ runtime ä»€ä¹ˆæ—¶å€™æŠŠè¿™éƒ¨åˆ†å†…å­˜è¿˜ç»™æ“ä½œç³»ç»Ÿï¼Œä¸åŒçš„åˆ†é…ç­–ç•¥å’Œä¸åŒçš„ç³»ç»Ÿä¸å¤ªä¸€æ ·ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯&#34;&gt;å†…å­˜æ³„æ¼çš„å¸¸è§åœºæ™¯&lt;/h4&gt;
&lt;p&gt;å†…å­˜æ³„æ¼ä¸»è¦å°±æ˜¯ goroutine æ³„æ¼ï¼Œè¿™é‡ŒæŠŠå¯èƒ½å‡ºç°çš„åœºæ™¯éƒ½æ€»ç»“ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è·å–é•¿å­—ç¬¦ä¸²ä¸­çš„ä¸€æ®µå¯¼è‡´é•¿å­—ç¬¦ä¸²æœªé‡Šæ”¾&lt;/li&gt;
&lt;li&gt;è·å–é•¿sliceä¸­çš„ä¸€æ®µå¯¼è‡´é•¿sliceæœªé‡Šæ”¾&lt;/li&gt;
&lt;li&gt;åœ¨é•¿sliceæ–°å»ºsliceå¯¼è‡´æ³„æ¼&lt;/li&gt;
&lt;li&gt;goroutineæ³„æ¼&lt;/li&gt;
&lt;li&gt;time.Tickeræœªå…³é—­å¯¼è‡´æ³„æ¼&lt;/li&gt;
&lt;li&gt;Finalizerå¯¼è‡´æ³„æ¼&lt;/li&gt;
&lt;li&gt;Deferring Function Call å¯¼è‡´æ³„æ¼&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;goroutineæ³„æ¼&#34;&gt;Goroutineæ³„æ¼&lt;/h4&gt;
&lt;p&gt;Go è¯­è¨€é¡¹ç›®ä¸­å¾ˆå¸¸è§çš„å†…å­˜æ³„æ¼æ˜¯ goroutine æ³„æ¼ï¼Œå¯¼è‡´ goroutine æ³„æ¼æœ‰ä¸¤ç‚¹åŸå› ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;goroutine æœ¬èº«çš„å †æ ˆå¤§å°æ˜¯2 KBï¼Œæˆ‘ä»¬å¼€å¯ä¸€ä¸ªæ–°çš„ goroutineï¼Œè‡³å°‘ä¼šå ç”¨2KBçš„å†…å­˜å¤§å°ã€‚å½“é•¿æ—¶é—´çš„ç´¯ç§¯ï¼Œæ•°é‡è¾ƒå¤§æ—¶ï¼Œæ¯”å¦‚å¼€å¯äº† 100 ä¸‡ä¸ª goroutineï¼Œé‚£ä¹ˆè‡³å°‘å°±ä¼šå ç”¨2 GBçš„å†…å­˜ã€‚&lt;/li&gt;
&lt;li&gt;goroutine ä¸­çš„å˜é‡è‹¥æŒ‡å‘äº†å †å†…å­˜åŒºï¼Œé‚£ä¹ˆï¼Œå½“è¯¥ goroutineæœªè¢«é”€æ¯ï¼Œç³»ç»Ÿä¼šè®¤ä¸ºè¯¥éƒ¨åˆ†å†…å­˜è¿˜ä¸èƒ½è¢«åƒåœ¾å›æ”¶ï¼Œé‚£ä¹ˆå°±å¯èƒ½ä¼šå ç”¨å¤§é‡çš„å †åŒºå†…å­˜ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;goroutine æ³„æ¼å¤§æ¦‚æœ‰ä»¥ä¸‹åœºæ™¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»channelä¸­è¯»æˆ–å†™ï¼Œä½†æ²¡æœ‰å¯¹åº”çš„å†™æˆ–è¯»&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;channel åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œunbuffered channelå’Œbuffered channelï¼Œå…ˆè®¨è®ºunbuffered channelã€‚åœ¨ channel è¢«åˆ›å»ºåæœªè¢«å…³é—­å‰ï¼Œæˆ‘ä»¬è‹¥ä» channel ä¸­è¯»å–æ•°æ®ï¼Œä½†åˆä¸€ç›´æ²¡æœ‰æ•°æ®å†™å…¥ channel ä¸­ï¼Œé‚£ä¹ˆ channel å°±ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œå¯¹åº”çš„ goroutine ä¹Ÿå°±ä¼šä¸€ç›´é˜»å¡ç€äº†ã€‚å¯¹åº”çš„ï¼Œå½“æˆ‘ä»¬å¾€ channel ä¸­å†™æ•°æ®ï¼Œä½†åˆä¸€ç›´æ²¡æœ‰ä» channel ä¸­è¯»ã€‚é‚£ä¹ˆä¹Ÿä¼šå‡ºç°è¢«é˜»å¡çš„æƒ…å†µã€‚è‡³äº buffered channelï¼Œå…¶å®å’Œ unbuffered channel æƒ…å†µæ˜¯ç±»ä¼¼çš„ï¼Œåªæ˜¯ buffered channel æ˜¯è¯»å®Œç¼“å­˜åï¼Œæˆ–å†™å®Œç¼“å­˜åä¼šå¯¼è‡´é˜»å¡ã€‚&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;åœ¨ä½¿ç”¨selectæ—¶ï¼Œæ‰€æœ‰çš„caseéƒ½é˜»å¡&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;quit&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;case&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;quit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;quit&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;quit&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;chan&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;quit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;c1&#34;&gt;// close(quit)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å½“ Add å‡½æ•° for å¾ªç¯äº† 10 æ¬¡ä¹‹åï¼Œadd å‡½æ•°å°±ä¼šä¸€ç›´é˜»å¡äº†ï¼Œä¹Ÿå°±å‡ºç°äº† goroutine æ³„æ¼ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯åœ¨åˆé€‚çš„æ—¶é—´å°† quit å…³é—­ï¼Œé‚£ä¹ˆ add åç¨‹å°±å¯ä»¥å®‰å…¨é€€å‡ºäº†ã€‚&lt;/p&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;goroutine è¿›å…¥æ­»å¾ªç¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”±äºä»£ç é€»è¾‘çš„ bugï¼Œå¯¼è‡´ goroutine è¿›å…¥äº†æ­»å¾ªç¯ï¼Œå¯¼è‡´èµ„æºæ— æ³•é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;loop&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;go&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;å¦‚ä½•é¢„é˜² goroutine æ³„æ¼å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜å°±è¦äº¤ç»™å¼€å‘è€…è‡ªå·±äº†ï¼Œæ¯å½“æˆ‘ä»¬ä½¿ç”¨ goroutine æˆ–è€… channel çš„æ—¶å€™å°±è¦æƒ³å¥½è¯¥å¦‚ä½•ç»“æŸæˆ–æ˜¯å¦‚ä½•å°†å…¶å…³é—­ï¼Œæƒ³å¥½ channel ä½•æ—¶å¯èƒ½å‡ºç°é˜»å¡ï¼Œä»¥åŠé˜»å¡çš„å…·ä½“æƒ…å†µï¼Œè€Œä¸”é¿å…ä»¥æ­»å¾ªç¯çš„é€»è¾‘å†™ä»£ç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¸¸è§å†…å­˜é¢è¯•é¢˜&#34;&gt;å¸¸è§å†…å­˜é¢è¯•é¢˜&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Golang çš„å†…å­˜æ¨¡å‹ ( ç±³å“ˆæ¸¸ )&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å°†å¯¹è±¡åˆ†ä¸ºå¾®å°å¯¹è±¡ã€å°å¯¹è±¡ã€å¤§å¯¹è±¡ï¼Œä½¿ç”¨ä¸‰çº§ç®¡ç†ç»“æ„mcacheã€mcentralã€mheapç”¨äºç®¡ç†ã€ç¼“å­˜åŠ é€Ÿspanå¯¹è±¡çš„è®¿é—®å’Œåˆ†é…ï¼Œä½¿ç”¨ç²¾å‡†çš„ä½å›¾ç®¡ç†å·²åˆ†é…çš„å’Œæœªåˆ†é…çš„å¯¹è±¡åŠå¯¹è±¡çš„å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;Goè¯­è¨€è¿è¡Œæ—¶ä¾é ç»†å¾®çš„å¯¹è±¡åˆ‡å‰²ã€æè‡´çš„å¤šçº§ç¼“å­˜ã€ç²¾å‡†çš„ä½å›¾ç®¡ç†å®ç°äº†å¯¹å†…å­˜çš„ç²¾ç»†åŒ–ç®¡ç†ä»¥åŠå¿«é€Ÿçš„å†…å­˜è®¿é—®ï¼ŒåŒæ—¶å‡å°‘äº†å†…å­˜çš„ç¢ç‰‡ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨ï¼šå¦‚æœé—®çš„æ·±å…¥ï¼Œè¦ç­”å››çº§å†…å­˜å—ç®¡ç†å’ŒMheapçš„ç¼“å­˜æŸ¥æ‰¾ã€åŸºæ•°æ ‘æŸ¥æ‰¾ç­‰&lt;/p&gt;
&lt;ol start=&#34;2&#34;&gt;
&lt;li&gt;ç®€è¿°ä¸€ä¸‹ GC çš„åŸç†ï¼Œä¸‰è‰²æ ‡è®°æ³•ï¼Ÿ( bç«™ )&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;åˆå§‹åŒ–çŠ¶æ€ä¸‹æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ç™½è‰²çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä»æ ¹èŠ‚ç‚¹å¼€å§‹éå†æ‰€æœ‰å¯¹è±¡ï¼ŒæŠŠéå†åˆ°çš„å¯¹è±¡å˜æˆç°è‰²å¯¹è±¡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éå†ç°è‰²å¯¹è±¡ï¼Œå°†ç°è‰²å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ä¹Ÿå˜æˆç°è‰²å¯¹è±¡ï¼Œç„¶åå°†éå†è¿‡çš„ç°è‰²å¯¹è±¡å˜æˆé»‘è‰²å¯¹è±¡&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¾ªç¯ä¸Šä¸€æ­¥éª¤ï¼ŒçŸ¥é“ç°è‰²å¯¹è±¡å…¨éƒ¨å˜é»‘è‰²ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡å†™å±éšœæ£€æµ‹å¯¹è±¡æœ‰å˜åŒ–ã€‚é‡å¤ä»¥ä¸Šæ“ä½œ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ”¶é›†æ‰€æœ‰çš„ç™½è‰²å¯¹è±¡ï¼ˆåƒåœ¾ï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;Goçš„åƒåœ¾å›æ”¶ï¼Œä»€ä¹ˆæ—¶å€™è§¦å‘ï¼Ÿ( æ»´æ»´ )&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸»åŠ¨è§¦å‘(æ‰‹åŠ¨è§¦å‘)ï¼Œé€šè¿‡è°ƒç”¨ runtime.GC æ¥è§¦å‘ GCï¼Œæ­¤è°ƒç”¨é˜»å¡å¼åœ°ç­‰å¾…å½“å‰ GC è¿è¡Œå®Œæ¯•ã€‚&lt;/p&gt;
&lt;p&gt;è¢«åŠ¨è§¦å‘ï¼Œåˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨æ­¥è°ƒï¼ˆPacingï¼‰ç®—æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ§åˆ¶å†…å­˜å¢é•¿çš„æ¯”ä¾‹ï¼Œæ¯æ¬¡å†…å­˜åˆ†é…æ—¶æ£€æŸ¥å½“å‰å†…å­˜åˆ†é…é‡æ˜¯å¦å·²è¾¾åˆ°é˜ˆå€¼ï¼ˆç¯å¢ƒå˜é‡GoGCï¼‰ï¼šé»˜è®¤100%ï¼Œå³å½“å†…å­˜æ‰©å¤§ä¸€å€æ—¶å¯ç”¨GCã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ç³»ç»Ÿç›‘æ§ï¼Œå½“è¶…è¿‡ä¸¤åˆ†é’Ÿæ²¡æœ‰äº§ç”Ÿä»»ä½•GCæ—¶ï¼Œå¼ºåˆ¶è§¦å‘ GCã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;ol start=&#34;4&#34;&gt;
&lt;li&gt;ä»‹ç»ä¸€ä¸‹ Go çš„ GC ï¼Ÿ( æ·±ä¿¡æœã€è…¾è®¯ã€å°ç±³ã€å­¦è€Œæ€ã€Aibeeã€é˜¿é‡Œã€å­—èŠ‚è·³åŠ¨ã€æ»´æ»´ã€èš‚èšã€å¿«æ‰‹ã€çŒ¿è¾…å¯¼ã€Shoppeã€å“”å“©å“”å“© )&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ ‡è®°æ¸…é™¤:&lt;/p&gt;
&lt;p&gt;æ­¤ç®—æ³•ä¸»è¦æœ‰ä¸¤ä¸ªä¸»è¦çš„æ­¥éª¤ï¼š&lt;/p&gt;
&lt;p&gt;æ ‡è®°(Mark phase)&lt;/p&gt;
&lt;p&gt;æ¸…é™¤(Sweep phase)&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥ï¼Œæ‰¾å‡ºä¸å¯è¾¾çš„å¯¹è±¡ï¼Œç„¶ååšä¸Šæ ‡è®°ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒæ­¥ï¼Œå›æ”¶æ ‡è®°å¥½çš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;æ“ä½œéå¸¸ç®€å•ï¼Œä½†æ˜¯æœ‰ä¸€ç‚¹éœ€è¦é¢å¤–æ³¨æ„ï¼šmark and sweep ç®—æ³•åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œéœ€è¦ç¨‹åºæš‚åœï¼å³ stop the worldã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™æ®µæ—¶é—´ç¨‹åºä¼šå¡åœ¨å“ªå„¿ã€‚æ•…ä¸­æ–‡ç¿»è¯‘æˆ å¡é¡¿.&lt;/p&gt;
&lt;p&gt;æ ‡è®°-æ¸…æ‰«(Mark And Sweep)ç®—æ³•å­˜åœ¨ä»€ä¹ˆé—®é¢˜ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ ‡è®°-æ¸…æ‰«(Mark And Sweep)ç®—æ³•è¿™ç§ç®—æ³•è™½ç„¶éå¸¸çš„ç®€å•ï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;STWï¼Œstop the worldï¼›è®©ç¨‹åºæš‚åœï¼Œç¨‹åºå‡ºç°å¡é¡¿ã€‚&lt;/p&gt;
&lt;p&gt;æ ‡è®°éœ€è¦æ‰«ææ•´ä¸ªheap&lt;/p&gt;
&lt;p&gt;æ¸…é™¤æ•°æ®ä¼šäº§ç”Ÿheapç¢ç‰‡&lt;/p&gt;
&lt;p&gt;è¿™é‡Œé¢æœ€é‡è¦çš„é—®é¢˜å°±æ˜¯ï¼šmark-and-sweep ç®—æ³•ä¼šæš‚åœæ•´ä¸ªç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä¸‰è‰²å¹¶å‘æ ‡è®°æ³•:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼šç¨‹åºåˆ›å»ºçš„å¯¹è±¡éƒ½æ ‡è®°ä¸ºç™½è‰²ã€‚&lt;/li&gt;
&lt;li&gt;gcå¼€å§‹ï¼šæ‰«ææ‰€æœ‰å¯åˆ°è¾¾çš„å¯¹è±¡ï¼Œæ ‡è®°ä¸ºç°è‰²&lt;/li&gt;
&lt;li&gt;ä»ç°è‰²å¯¹è±¡ä¸­æ‰¾åˆ°å…¶å¼•ç”¨å¯¹è±¡æ ‡è®°ä¸ºç°è‰²ï¼ŒæŠŠç°è‰²å¯¹è±¡æœ¬èº«æ ‡è®°ä¸ºé»‘è‰²&lt;/li&gt;
&lt;li&gt;ç›‘è§†å¯¹è±¡ä¸­çš„å†…å­˜ä¿®æ”¹ï¼Œå¹¶æŒç»­ä¸Šä¸€æ­¥çš„æ“ä½œï¼Œç›´åˆ°ç°è‰²æ ‡è®°çš„å¯¹è±¡ä¸å­˜åœ¨&lt;/li&gt;
&lt;li&gt;æ­¤æ—¶ï¼Œgcå›æ”¶ç™½è‰²å¯¹è±¡&lt;/li&gt;
&lt;li&gt;æœ€åï¼Œå°†æ‰€æœ‰é»‘è‰²å¯¹è±¡å˜ä¸ºç™½è‰²ï¼Œå¹¶é‡å¤ä»¥ä¸Šæ‰€æœ‰è¿‡ç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ··åˆå†™å±éšœ:&lt;/p&gt;
&lt;p&gt;å½“gcè¿›è¡Œä¸­æ—¶ï¼Œæ–°åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒæŒ‰ç…§ä¸‰è‰²æ ‡è®°æ³•çš„æ­¥éª¤ï¼Œå¯¹è±¡ä¼šè¢«æ ‡è®°ä¸ºç™½è‰²,è¿™æ ·æ–°ç”Ÿæˆçš„å¯¹è±¡æœ€åä¼šè¢«æ¸…é™¤æ‰ï¼Œè¿™æ ·ä¼šå½±å“ç¨‹åºé€»è¾‘.&lt;/p&gt;
&lt;p&gt;golangå¼•å…¥å†™å±éšœæœºåˆ¶.å¯ä»¥ç›‘æ§å¯¹è±¡çš„å†…å­˜ä¿®æ”¹ï¼Œå¹¶å¯¹å¯¹è±¡è¿›è¡Œé‡æ–°æ ‡è®°.&lt;/p&gt;
&lt;p&gt;gcä¸€æ—¦å¼€å§‹ï¼Œæ— è®ºæ˜¯åˆ›å»ºå¯¹è±¡è¿˜æ˜¯å¯¹è±¡çš„å¼•ç”¨æ”¹å˜ï¼Œéƒ½ä¼šå…ˆå˜ä¸ºç°è‰²ã€‚&lt;/p&gt;
&lt;ol start=&#34;5&#34;&gt;
&lt;li&gt;ä»‹ç»ä¸€ä¸‹é€ƒé€¸åˆ†æï¼Ÿä¸ºä»€ä¹ˆè¦é€ƒé€¸åˆ†æï¼Ÿå¸¸è§çš„é€ƒé€¸ç±»å‹ï¼ŸGo ä¸­çš„é€ƒé€¸å‡†åˆ™ ( ç™¾åº¦ã€å“”å“©å“”å“©ã€å­—èŠ‚è·³åŠ¨ã€èš‚èšã€ç½‘æ˜“ã€é˜¿é‡Œ )&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆéœ€è¦ï¼šé€šè¿‡é€ƒé€¸åˆ†æï¼Œé‚£äº›ä¸éœ€è¦åˆ†é…åˆ°å †ä¸Šçš„å˜é‡ç›´æ¥åˆ†é…åˆ°æ ˆä¸Šï¼Œå †ä¸Šçš„å˜é‡å°‘äº†ä¸ä½†åŒæ—¶å‡å°‘ GC çš„å‹åŠ›ï¼Œè¿˜å‡è½»äº†å†…å­˜åˆ†é…çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„ç±»å‹ï¼šfunc å’Œ interface æ•°æ®ç±»å‹ï¼Œchannel æˆ–è€…æ ˆç©ºé—´ä¸è¶³é€ƒé€¸ã€‚&lt;/p&gt;
&lt;p&gt;å‡†åˆ™ï¼šå¦‚æœå‡½æ•°å¤–éƒ¨æ²¡æœ‰å¼•ç”¨ï¼Œåˆ™ä¼˜å…ˆæ”¾åˆ°æ ˆä¸­ï¼›å¦‚æœå‡½æ•°å¤–éƒ¨å­˜åœ¨å¼•ç”¨ï¼Œåˆ™å¿…å®šæ”¾åˆ°å †ä¸­;&lt;/p&gt;
&lt;ol start=&#34;6&#34;&gt;
&lt;li&gt;å¦‚ä½•é¿å…å†…å­˜é€ƒé€¸ï¼Ÿ( å“”å“©å“”å“©ã€èš‚èš )&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;ä¸è¦ç›²ç›®ä½¿ç”¨å˜é‡æŒ‡é’ˆä½œä¸ºå‚æ•°ï¼Œè™½ç„¶å‡å°‘äº†å¤åˆ¶ï¼Œä½†å˜é‡é€ƒé€¸çš„å¼€é”€æ›´å¤§ã€‚&lt;/li&gt;
&lt;li&gt;é¢„å…ˆè®¾å®šå¥½sliceé•¿åº¦ï¼Œé¿å…é¢‘ç¹è¶…å‡ºå®¹é‡ï¼Œé‡æ–°åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªç»éªŒæ˜¯ï¼ŒæŒ‡é’ˆæŒ‡å‘çš„æ•°æ®å¤§éƒ¨åˆ†åœ¨å †ä¸Šåˆ†é…çš„ï¼Œè¯·æ³¨æ„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‡ºç°å†…å­˜é€ƒé€¸çš„æƒ…å†µæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å‘é€æŒ‡é’ˆæˆ–å¸¦æœ‰æŒ‡é’ˆçš„å€¼åˆ°channelï¼Œå› ä¸ºç¼–è¯‘æ—¶å€™æ— æ³•çŸ¥é“é‚£ä¸ªgoroutineä¼šåœ¨channelæ¥å—æ•°æ®ï¼Œç¼–è¯‘å™¨æ— æ³•çŸ¥é“ä»€ä¹ˆæ—¶å€™é‡Šæ”¾ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªåˆ‡ç‰‡ä¸Šå­˜å‚¨æŒ‡é’ˆæˆ–å¸¦æŒ‡é’ˆçš„å€¼ã€‚æ¯”å¦‚[]*stringï¼Œå¯¼è‡´åˆ‡ç‰‡å†…å®¹é€ƒé€¸ï¼Œå…¶å¼•ç”¨å€¼ä¸€ç›´åœ¨å †ä¸Šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åˆ‡ç‰‡çš„appendå¯¼è‡´è¶…å‡ºå®¹é‡ï¼Œåˆ‡ç‰‡é‡æ–°åˆ†é…åœ°å€ï¼Œåˆ‡ç‰‡èƒŒåçš„å­˜å‚¨åŸºäºè¿è¡Œæ—¶çš„æ•°æ®è¿›è¡Œæ‰©å……ï¼Œå°±ä¼šåœ¨å †ä¸Šåˆ†é…ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è°ƒç”¨æ¥å£ç±»å‹æ—¶ï¼Œæ¥å£ç±»å‹çš„æ–¹æ³•è°ƒç”¨æ˜¯åŠ¨æ€è°ƒåº¦ï¼Œå®é™…ä½¿ç”¨çš„å…·ä½“å®ç°åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šï¼Œå¦‚ä¸€ä¸ªæ¥å£ç±»å‹ä¸ºio.Readerçš„å˜é‡rï¼Œå¯¹r.Read(b)çš„è°ƒç”¨å°†å¯¼è‡´rçš„å€¼å’Œå­—èŠ‚ç‰‡bçš„åç»­è½¬ä¹‰å¹¶å› æ­¤åˆ†é…åˆ°å †ä¸Šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æ–¹æ³•å†…æŠŠå±€éƒ¨å˜é‡æŒ‡é’ˆè¿”å›ï¼Œè¢«å¤–éƒ¨å¼•ç”¨ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸå¤§äºæ ˆï¼Œå¯¼è‡´å†…å­˜æº¢å‡ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;â€ƒâ€ƒOKï¼ä»¥ä¸Šå°±æ˜¯å¯¹äºå†…å­˜éƒ¨åˆ†çš„æµ…æ˜¾è¯´æ˜ï¼Œæˆ‘æ˜¯å°†å¾ˆå¤šå¤§ç‰›çš„æ–‡ç« å†…å®¹è®©è‡ªå·±ç†è§£çš„æ›´å¥½åšäº†æ€»ç»“ï¼Œå¦‚æœ‰é—®é¢˜å¯ä»¥è”ç³»æˆ‘è¿›è¡Œä¿®æ”¹å’Œè®¨è®ºã€‚
â€ƒâ€ƒLife is fantastic !&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€â€”â€”å†…å­˜å¯¹é½</title>
        <link>https://zonzeeli.github.io/p/memory-alignment/</link>
        <pubDate>Tue, 29 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/memory-alignment/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/memory-alignment/memoryalignment.jpg" alt="Featured image of post Goè¯­è¨€â€”â€”å†…å­˜å¯¹é½" /&gt;&lt;h2 id=&#34;å†…å­˜å¯¹é½&#34;&gt;å†…å­˜å¯¹é½&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨äº†è§£å†…å­˜å¯¹é½è¿™ä¸ªæ¦‚å¿µä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“çš„æ˜¯32ä½ç³»ç»Ÿï¼Œä¸€æ¬¡èƒ½æœ€å¤§å¤„ç†çš„ä½æ•°ï¼Œå³å–å‡ºçš„æ•°æ®æœ€å¤šä¸º32ä½ï¼Œå³4ä¸ªå­—èŠ‚ï¼Œå†…å­˜å¯¹é½çš„è¯å°±æ˜¯4å­—èŠ‚çš„å†…å­˜å¯¹é½ï¼Œå¦‚æœæ˜¯64ä½ç³»ç»Ÿï¼Œåˆ™åŒç†å¾—å‡ºæ˜¯8å­—èŠ‚å†…å­˜å¯¹é½ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ³¨ï¼šä»¥ä¸‹å†…å®¹å’Œä»£ç éƒ¨åˆ†é€‰è‡ªå…¶ä»–æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥é“äº†ä¸Šè¿°å‰æåï¼Œæˆ‘ä»¬è¦æ¸…æ¥šå†…å­˜ä¸­æ•°æ®å­˜æ”¾çš„å½¢å¼æ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿå¦‚æœä»¥å¤§ä½“å›¾æ¥è§£é‡Šçš„è¯ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AD%98%E5%82%A8%E5%BD%A2%E5%BC%8F.png&#34;
	width=&#34;953&#34;
	height=&#34;149&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AD%98%E5%82%A8%E5%BD%A2%E5%BC%8F_hu518ff544a7b9338eef1b5e3dd520cbc0_6578_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AD%98%E5%82%A8%E5%BD%A2%E5%BC%8F_hu518ff544a7b9338eef1b5e3dd520cbc0_6578_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;639&#34;
		data-flex-basis=&#34;1535px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€ä»¥é’ˆå¯¹ä¸Šè¿°å¯¹32ä½å’Œ64ä½ç³»ç»Ÿçš„è§£é‡Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œé’ˆå¯¹32ä½ç³»ç»Ÿï¼Œæ¯4å­—èŠ‚çš„æ•°æ®æ”¾åœ¨ä¸€èµ·ï¼Œæ¯æ¬¡å–ä¹Ÿæ˜¯4å­—èŠ‚ä¸€èµ·å–ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦å†…å­˜å¯¹é½ï¼Ÿ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;å¹³å°é—®é¢˜ï¼šå¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¡¬ä»¶å¹³å°éƒ½èƒ½è®¿é—®ä»»æ„åœ°å€ä¸Šçš„ä»»æ„æ•°æ®ã€‚æœ‰äº›CPUå¯ä»¥è®¿é—®ä»»æ„åœ°å€ä¸Šçš„ä»»æ„æ•°æ®ï¼Œè€Œæœ‰äº›CPUåªèƒ½åœ¨ç‰¹å®šåœ°å€è®¿é—®æ•°æ®ï¼Œå› æ­¤ä¸åŒç¡¬ä»¶å¹³å°å…·æœ‰å·®å¼‚æ€§ï¼Œè¿™æ ·çš„ä»£ç å°±ä¸å…·æœ‰ç§»æ¤æ€§ï¼Œå¦‚æœåœ¨ç¼–è¯‘æ—¶ï¼Œå°†åˆ†é…çš„å†…å­˜è¿›è¡Œå¯¹é½ï¼Œè¿™å°±å…·æœ‰å¹³å°å¯ä»¥ç§»æ¤æ€§äº†ã€‚&lt;/li&gt;
&lt;li&gt;æ€§èƒ½é—®é¢˜ï¼šè®¿é—®æœªå¯¹é½å†…å­˜éœ€è¦cpuè¿›è¡Œä¸¤æ¬¡è®¿é—®ï¼Œå¯¹é½ååªéœ€è¦ä¸€æ¬¡ã€‚CPUè®¿é—®å†…å­˜æ—¶å¹¶ä¸æ˜¯é€ä¸ªå­—èŠ‚è®¿é—®ï¼Œè€Œæ˜¯ä»¥å­—é•¿ï¼ˆword sizeï¼‰ä¸ºå•ä½è®¿é—®ï¼Œä¾‹å¦‚ 32ä½çš„CPUå­—é•¿æ˜¯4å­—èŠ‚ï¼Œ64ä½çš„æ˜¯8å­—èŠ‚ã€‚å¦‚æœå˜é‡çš„åœ°å€æ²¡æœ‰å¯¹é½ï¼Œå¯èƒ½éœ€è¦å¤šæ¬¡è®¿é—®æ‰èƒ½å®Œæ•´è¯»å–åˆ°å˜é‡å†…å®¹ï¼Œè€Œå¯¹é½åå¯èƒ½å°±åªéœ€è¦ä¸€æ¬¡å†…å­˜è®¿é—®ï¼Œå› æ­¤å†…å­˜å¯¹é½å¯ä»¥å‡å°‘CPUè®¿é—®å†…å­˜çš„æ¬¡æ•°ï¼ŒåŠ å¤§CPUè®¿é—®å†…å­˜çš„ååé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å†…å­˜å¯¹é½çš„æ¦‚å¿µ&#34;&gt;å†…å­˜å¯¹é½çš„æ¦‚å¿µ&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€ä»¥åŸºäºä»¥ä¸ŠåŸå› ï¼Œç†è®ºä¸Šè®¡ç®—æœºå¯ä»¥è®¿é—®ä»»æ„åœ°å€çš„å˜é‡ï¼Œä½†æ˜¯åœ¨è®¿é—®ç‰¹å®šç±»å‹é€šå¸¸åœ¨ç‰¹å®šçš„å†…å­˜åœ°å€ä¸­ï¼Œæ•°æ®å­˜æ”¾å¹¶ä¸æ˜¯éšæ„å­˜æ”¾ï¼Œä»ä¸Šé¢çš„å›¾å¯ä»¥å¾—å‡ºï¼Œæ˜¯æœ‰è§„åˆ™çš„é¡ºåºï¼Œæˆ‘ä»¬èƒ½å¤Ÿåˆ†æå‡ºï¼Œå†…å­˜å¯¹é½æ˜¯&lt;strong&gt;ä¸ºäº†èƒ½å¤Ÿå¿«é€Ÿè®¿é—®å†…å­˜è¿›è¡Œæ•°æ®çš„å­˜å–ï¼Œä½†æ˜¯ä¼šæ¶ˆè€—å†…å­˜ç©ºé—´ï¼Œç”¨ç©ºé—´æ¢æ—¶é—´çš„ä¸€ç§å†…å­˜å­˜å‚¨è§„åˆ™&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;goè¯­è¨€ä¸­å†…å­˜å¯¹é½çš„ä½“ç°&#34;&gt;Goè¯­è¨€ä¸­å†…å­˜å¯¹é½çš„ä½“ç°&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒé¦–å…ˆçœ‹ä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;s1&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;3&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;s2&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t2&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ˜¯ä¸æ˜¯å¯¹è¿™ä¸ªç»“æœæœ‰ç–‘é—®å‘¢ï¼Ÿä¸ºä»€ä¹ˆ&lt;code&gt;s1&lt;/code&gt;å’Œ&lt;code&gt;s2&lt;/code&gt;çš„æ•°æ®é•¿åº¦ä¸åŒï¼Œä½†æ˜¯æ‰“å°å‡ºçš„å†…å­˜é•¿åº¦ä¸€æ ·ï¼Ÿä¸ºä»€ä¹ˆ&lt;code&gt;t1&lt;/code&gt;å’Œ&lt;code&gt;t2&lt;/code&gt;çš„ç»“æ„ä½“åªæ˜¯å®šä¹‰çš„é¡ºåºä¸åŒï¼Œå†…å­˜é•¿åº¦å´ä¸ä¸€æ ·ï¼Ÿ&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼Œgoè¯­è¨€é€šè¿‡&lt;code&gt;unsafe.Sizeof(x)&lt;/code&gt;æ‰“å°çš„å˜é‡å ç”¨çš„å†…å­˜å­—èŠ‚æ•°ï¼Œå’Œåº•å±‚æ•°æ®æ— å…³ï¼Œä¸åŒ…å«&lt;code&gt;x&lt;/code&gt;æ‰€æŒ‡å‘çš„å†…å®¹å¤§å°ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªç–‘é—®è§£å†³äº†ã€‚ä¹ŸåŒç†æˆ‘ä»¬å¯ä»¥é€šè¿‡&lt;code&gt;unsafe.Sizeof()&lt;/code&gt;æ‰“å°å‡ºå„ä¸ªç±»å‹çš„å†…å­˜å ç”¨å¤§å°ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ³¨ï¼šè¿™é‡Œä½¿ç”¨çš„æ˜¯64ä½ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;å­—èŠ‚æ•°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;bool&lt;/td&gt;
&lt;td&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;intN, uintN, floatN, complexN&lt;/td&gt;
&lt;td&gt;N/8 ä¸ªå­—èŠ‚ ï¼ˆint32 æ˜¯ 4 ä¸ªå­—èŠ‚ï¼‰&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;int, uint, uintptr&lt;/td&gt;
&lt;td&gt;è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 8 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;*T, map, func, chan&lt;/td&gt;
&lt;td&gt;è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 8 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;string ï¼ˆdataã€lenï¼‰&lt;/td&gt;
&lt;td&gt;2 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 16 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;interface (tabã€data æˆ– _typeã€data)&lt;/td&gt;
&lt;td&gt;2 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 16 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;[]T (arrayã€lenã€cap)&lt;/td&gt;
&lt;td&gt;3 * è®¡ç®—æœºå­—é•¿/8 (64ä½ æ˜¯ 24 ä¸ªå­—èŠ‚)&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;â€ƒâ€ƒæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é’ˆå¯¹ç»“æ„ä½“çš„ç–‘æƒ‘æ¥è®¨è®ºï¼Œåœ¨æ–‡ç« çš„å¼€å¤´æˆ‘ä»¬å·²ç»ä»‹ç»è¿‡ï¼Œæ•°æ®åœ¨å†…å­˜ä¸­å­˜æ”¾çš„å½¢å¼ã€‚åœ¨å¦‚ä¸‹ç»“æ„ä½“ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 1ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 8ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¯¹äºä¸Šé¢çš„ç»“æ„ï¼Œå¦‚æœæ˜¯æ²¡æœ‰è¿›è¡Œè¿‡å†…å­˜å¯¹é½ï¼Œåˆ™æŒ‰ç…§å­˜æ”¾çš„é¡ºåºï¼Œä»¥32ä½ç³»ç»Ÿçš„æ¯4ä¸ªå­—èŠ‚å–æ•°æ®çš„è§„åˆ™ï¼Œä¼šå‘ç°é™¤äº†&lt;code&gt;a&lt;/code&gt;ï¼Œ&lt;code&gt;b&lt;/code&gt;å’Œ&lt;code&gt;c&lt;/code&gt;éƒ½ä¸æ˜¯ä»å¤´å–çš„ï¼Œè¿‡ç¨‹å¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè¿™é‡Œå°±æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äº&lt;code&gt;b&lt;/code&gt;å’Œ&lt;code&gt;c&lt;/code&gt;æ²¡æœ‰åšåˆ°ä»èµ·å§‹ä½å¼€å§‹å–æ•°æ®ï¼Œæ‰€ä»¥ä¼šé€ æˆä¹‹ååœ¨å†æ¬¡æ‹¼æ¥æ•´ç†çš„æ“ä½œï¼Œéœ€è¦å¤šæ¬¡å†…å­˜è®¿é—®å’Œæ•´ç†çš„æ­¥éª¤ã€‚è€Œå¦‚æœç»è¿‡å†…å­˜å¯¹é½ï¼Œå°±ä¼šå¦‚å›¾ï¼š&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæ‰€ä»¥æˆ‘ä»¬èƒ½å‘ç°ï¼Œå†…å­˜å¯¹é½å‡å°‘äº†æ“ä½œæ­¥éª¤ï¼Œä½†æ˜¯ç¼ºæµªè´¹äº†å†…å­˜ç©ºé—´å ç”¨çš„èµ„æºã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†…å­˜å¯¹é½çš„è§„åˆ™&#34;&gt;å†…å­˜å¯¹é½çš„è§„åˆ™&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨ä»‹ç»è§„åˆ™å‰ï¼Œgoè¯­è¨€&lt;code&gt;unsafe&lt;/code&gt;åŒ…ä¸‹è¿˜æœ‰å¦å¤–ä¸¤ä¸ªå‡½æ•°ï¼Œ&lt;code&gt;unsafe.Alignof()&lt;/code&gt;å’Œ&lt;code&gt;unsafe.Offsetof()&lt;/code&gt;ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯å¯ä»¥è·å–å¯¹é½å€¼å’Œåç§»é‡ã€‚è¿™é‡Œä¹Ÿä»‹ç»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;unsafealignof&#34;&gt;unsafe.Alignof()&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;code&gt;unsafe.Alignof()&lt;/code&gt;æ¥å—ä»»ä½•ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¹¶è¿”å›å…¶å¯¹é½æ–¹å¼ï¼Œåœ¨ç»“æ„ä½“ä¸­è¿”å›çš„æ˜¯å¯¹åº”ç±»å‹å­—æ®µæ‰€éœ€çš„å¯¹é½æ–¹å¼ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºstructç»“æ„ä½“ï¼Œè®¡ç®—æ¯ä¸€ä¸ª&lt;code&gt;unsafe.Alignof(x.f)&lt;/code&gt;ï¼Œ&lt;code&gt;unsafe.Alignof(x)&lt;/code&gt;æ˜¯å…¶æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºarrayæ•°ç»„ï¼Œ&lt;code&gt;unsafe.Alignof(x)&lt;/code&gt;ç­‰äºæ„æˆæ•°ç»„çš„å…ƒç´ ç±»å‹çš„å¯¹é½å€æ•°ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºåŸºç¡€ç±»å‹ï¼Œ&lt;code&gt;unsafe.Alignof(x)&lt;/code&gt;è¿”å›ä¸º&lt;code&gt;min(å­—é•¿/8ï¼Œunsafe.Sizeof(x))&lt;/code&gt;ï¼Œå³è®¡ç®—æœºå­—é•¿ä¸ç±»å‹å ç”¨å†…å­˜çš„è¾ƒå°å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;// 8 -- min(8,8) 64ä½ç³»ç»Ÿ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;// 1 -- min(8,1)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// 4 -- min(8,4)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;int64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;// 8 -- min(8,8)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;complex128&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 8 -- min(8,16)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 4 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 8 -- max(4,8)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;unsafeoffsetof&#34;&gt;unsafe.Offsetof()&lt;/h3&gt;
&lt;p&gt;â€ƒâ€ƒçŸ¥é“äº†æ¯ä¸ªç±»å‹çš„è§„åˆ™åï¼Œå°±å¯ä»¥ä½¿ç”¨&lt;code&gt;unsafe.Offsetof()&lt;/code&gt;è®¡ç®—ç»“æ„ä½“å†…ç±»å‹çš„åç§»é‡ï¼Œå®˜æ–¹æ³¨é‡Šä¸­ä¹Ÿè¯´æ˜ï¼Œ&lt;code&gt;which must be of the form structValue.field&lt;/code&gt;ï¼Œæ‰€ä»¥åªæœ‰åœ¨ç±»å‹æ˜¯ç»“æ„ä½“æ˜¯æ‰æœ‰æ„ä¹‰ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 8ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float32&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 1ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 20
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¯èƒ½å¯¹äºè¿™ä¸ªåç§»é‡çš„è®¡ç®—ç»“æœæœ‰äº›ç–‘æƒ‘ï¼Œè¿™ä¸ª&lt;code&gt;unsafe.Offsetof()&lt;/code&gt;å…¶å®å°±æ˜¯åœ¨å†…å­˜å¯¹é½ä¹‹åè®¡ç®—å‡ºæ¥çš„åç§»é‡ï¼Œå³è®¡ç®—ç‰¹å®šçš„åœ°å€äº†ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥éœ€è¦å…ˆçœ‹è§„åˆ™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å†…å­˜å¯¹é½è§„åˆ™&#34;&gt;å†…å­˜å¯¹é½è§„åˆ™&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æˆå‘˜å¯¹é½è§„åˆ™ï¼šé’ˆå¯¹ä¸€ä¸ªåŸºç¡€ç±»å‹å˜é‡ï¼Œå¦‚æœ&lt;code&gt;unsafe.AlignOf()&lt;/code&gt;è¿”å›çš„å€¼æ˜¯&lt;code&gt;m&lt;/code&gt;ï¼Œé‚£ä¹ˆè¯¥å˜é‡çš„åœ°å€éœ€è¦è¢«&lt;code&gt;m&lt;/code&gt;æ•´é™¤ï¼ˆå¦‚æœå½“å‰åœ°å€ä¸èƒ½æ•´é™¤ï¼Œå¡«å……ç©ºç™½å­—èŠ‚ï¼Œç›´è‡³å¯ä»¥æ•´é™¤ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ•´ä½“å¯¹é½è§„åˆ™ï¼šé’ˆå¯¹ä¸€ä¸ªç»“æ„ä½“ï¼Œå¦‚æœ&lt;code&gt;unsafe.AlignOf()&lt;/code&gt;è¿”å›å€¼æ˜¯&lt;code&gt;m&lt;/code&gt;ï¼Œéœ€è¦ä¿è¯è¯¥ç»“æ„ä½“æ•´ä½“å†…å­˜å ç”¨æ˜¯&lt;code&gt;m&lt;/code&gt;çš„æ•´æ•°å€ï¼Œå¦‚æœå½“å‰ä¸æ˜¯æ•´æ•°å€ï¼Œéœ€è¦åœ¨åé¢å¡«å……ç©ºç™½å­—èŠ‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;â€ƒâ€ƒé’ˆå¯¹è¯¥è§„åˆ™ï¼Œæˆ‘ä»¬å†æŠŠä¸Šè¿°çš„ç»“æ„ä½“å’Œ&lt;code&gt;unsafe.Offsetof()&lt;/code&gt;æ‹¿å‡ºæ¥åˆ†æä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;   &lt;span class=&#34;c1&#34;&gt;// 8ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;float32&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 4ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 1ä¸ªå­—èŠ‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Offsetof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 20
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Alignof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// 8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;     &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// å‡è®¾ä»åœ°å€0å¼€å§‹
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(int32(1)) = 4ï¼Œunsafe.Alignof(int32(1)) = 4ï¼Œåœ°å€0å¼€å§‹ï¼Œå¯ä»¥è¢«4æ•´é™¤
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(int64(1)) = 8ï¼Œunsafe.Alignof(int64(1)) = 8ï¼Œåœ°å€éœ€è¦ä»8å¼€å§‹ï¼Œæ‰å¯ä»¥è¢«8æ•´é™¤ï¼Œ[4,8]çš„ä½ç½®ç”¨0æ¥è¡¥å……
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(float32(1)) = 4ï¼Œunsafe.Alignof(float32(1)) = 4ï¼Œåœ°å€éœ€è¦ä»16å¼€å§‹ï¼Œå¯ä»¥è¢«4æ•´é™¤ï¼Œ[8,16]çš„ä½ç½®è¢«t.bå æ»¡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// unsafe.Sizeof(true) = 1, unsafe.Alignof(true) = 1, åœ°å€ä»20å¼€å§‹å³å¯ï¼Œ[16,20]çš„ä½ç½®è¢«cæ²¾æ»¡ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// ç”±äºç»“æ„ä½“ä¹Ÿéœ€è¦å¯¹é½ï¼Œè¦è¢«8æ•´é™¤ï¼Œæ‰€ä»¥è¦è¡¥0åˆ°24ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src=&#34;https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90.png&#34;
	width=&#34;1245&#34;
	height=&#34;484&#34;
	srcset=&#34;https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90_hu3f36a1c570ec2b1c16972b281c5088f4_40718_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/memory-alignment/%E5%86%85%E5%AD%98%E5%AF%B9%E9%BD%90_hu3f36a1c570ec2b1c16972b281c5088f4_40718_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;257&#34;
		data-flex-basis=&#34;617px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå°±æ˜¯å¦‚æœç»“æ„ä½“å†…éƒ¨åµŒå…¥äº†ç©ºç»“æ„ä½“ï¼Œé‚£ä¹ˆå½“ç©ºç»“æ„ä½“ä½äºç»“æ„ä½“çš„å‰é¢å’Œä¸­é—´ä½ç½®ï¼Œå¹¶ä¸ä¼šå ç”¨å†…å­˜ï¼Œå¦‚æœæ˜¯æœ«å°¾çš„è¯ï¼Œéœ€è¦å†…å­˜å¯¹é½ï¼Œå ç”¨çš„ç©ºé—´å’Œå‰ä¸€ä¸ªå˜é‡ä¿æŒä¸€è‡´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;D&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;E&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int64&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;F&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int32&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;C&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;D&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 16
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;E&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 24
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Sizeof&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;F&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 12
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;hr&gt;
&lt;p&gt;â€ƒâ€ƒOKï¼ä»¥ä¸Šå°±æ˜¯å†…å­˜å¯¹é½çš„ä»‹ç»äº†ï¼Œä»ä¸Šé¢çš„ä»‹ç»å¯ä»¥çœ‹å‡ºï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒæ•´ç»“æ„ä½“å†…å˜é‡çš„ä½ç½®æ¥ä¼˜åŒ–å†…å­˜å ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒLife is fantastic !&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€â€”â€”Mapçš„åº•å±‚ä»‹ç»åŠæ‰©ç¼©å®¹æœºåˆ¶</title>
        <link>https://zonzeeli.github.io/p/map/</link>
        <pubDate>Fri, 25 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/map/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/map/gomap.jpg" alt="Featured image of post Goè¯­è¨€â€”â€”Mapçš„åº•å±‚ä»‹ç»åŠæ‰©ç¼©å®¹æœºåˆ¶" /&gt;&lt;h2 id=&#34;map&#34;&gt;Map&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;code&gt;Map&lt;/code&gt;æ˜¯goè¯­è¨€çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒæ˜¯ä¸€ç§æ— åºçš„é”®å€¼å¯¹é›†åˆã€‚goè¯­è¨€çš„&lt;code&gt;map&lt;/code&gt;æ˜¯ä½¿ç”¨&lt;code&gt;hashmap&lt;/code&gt;å®ç°çš„ã€‚ä½¿ç”¨æ•°ç»„+é“¾è¡¨çš„å½¢å¼ï¼Œç”¨æ‹‰é“¾æ³•æ¶ˆé™¤hashå†²çªã€‚goè¯­è¨€ä¸­çš„&lt;code&gt;map&lt;/code&gt;ä¸»è¦æ˜¯ç”±ä¸¤ç§ç»“æ„ç»„æˆï¼Œ&lt;code&gt;hmap&lt;/code&gt;å’Œ&lt;code&gt;bmap&lt;/code&gt;ã€‚
â€ƒâ€ƒä»¥ä¸‹ç»“æ„å†…å®¹å’Œä»£ç é€‰è‡ªå…¶ä»–æ–‡ç« ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;      &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;//å…ƒç´ ä¸ªæ•°ï¼Œè°ƒç”¨len(map)æ—¶ç›´æ¥è¿”å›
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;flags&lt;/span&gt;      &lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;//æ ‡å¿—mapå½“å‰çŠ¶æ€,æ­£åœ¨åˆ é™¤å…ƒç´ ã€æ·»åŠ å…ƒç´ .....
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;B&lt;/span&gt;          &lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt;          &lt;span class=&#34;c1&#34;&gt;//å•å…ƒ(buckets)çš„å¯¹æ•° B=5è¡¨ç¤ºèƒ½å®¹çº³32ä¸ªå…ƒç´ 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;noverflow&lt;/span&gt;  &lt;span class=&#34;kt&#34;&gt;uint16&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;//å•å…ƒ(buckets)æº¢å‡ºæ•°é‡ï¼Œå¦‚æœä¸€ä¸ªå•å…ƒèƒ½å­˜8ä¸ªkeyï¼Œæ­¤æ—¶å­˜å‚¨äº†9ä¸ªï¼Œæº¢å‡ºäº†ï¼Œå°±éœ€è¦å†å¢åŠ ä¸€ä¸ªå•å…ƒ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;hash0&lt;/span&gt;      &lt;span class=&#34;kt&#34;&gt;uint32&lt;/span&gt;         &lt;span class=&#34;c1&#34;&gt;//å“ˆå¸Œç§å­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;buckets&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//æŒ‡å‘å•å…ƒ(buckets)æ•°ç»„,å¤§å°ä¸º2^Bï¼Œå¯ä»¥ä¸ºnil
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;oldbuckets&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//æ‰©å®¹çš„æ—¶å€™ï¼Œbucketsé•¿åº¦ä¼šæ˜¯oldbucketsçš„ä¸¤å€
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;nevacute&lt;/span&gt;   &lt;span class=&#34;kt&#34;&gt;uintptr&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;//æŒ‡ç¤ºæ‰©å®¹è¿›åº¦ï¼Œå°äºæ­¤bucketsè¿ç§»å®Œæˆ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;extra&lt;/span&gt;      &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;mapextra&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;//ä¸gcç›¸å…³ å¯é€‰å­—æ®µ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;//a bucket for a Go map
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bmap&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucketCnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;//å®é™…ä¸Šç¼–è¾‘æœŸé—´ä¼šåŠ¨æ€ç”Ÿæˆä¸€ä¸ªæ–°çš„ç»“æ„ä½“
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bmap&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;topbits&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// é«˜ä½å“ˆå¸Œå€¼
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;keys&lt;/span&gt;     &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keytype&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;values&lt;/span&gt;   &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;valuetype&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;pad&lt;/span&gt;      &lt;span class=&#34;kt&#34;&gt;uintptr&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uintptr&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æŒ‡å‘æ‰©å®¹åçš„bucket
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒç”±ä¸Šé¢çš„ç»“æ„å¯çŸ¥ï¼Œ&lt;code&gt;key&lt;/code&gt;å’Œ&lt;code&gt;value&lt;/code&gt;éƒ½å­˜åœ¨&lt;code&gt;bmap&lt;/code&gt;ä¸­ï¼Œä¸”ä¸æ˜¯ä»¥æŒ‡é’ˆå½¢å¼ï¼Œæœ€å¤šå­˜æ”¾8ä¸ªï¼Œ&lt;code&gt;key&lt;/code&gt;å­˜æ”¾ä½ç½®ç”±é«˜ä½å“ˆå¸Œå€¼å†³å®šï¼Œä½ä½å“ˆå¸Œå€¼ç”¨äºé€‰æ‹©æŠŠ&lt;code&gt;kv&lt;/code&gt;å­˜æ”¾åœ¨&lt;code&gt;bmap&lt;/code&gt;æ•°ç»„ä¸­çš„å“ªä¸€ä¸ªé‡Œã€‚å…·ä½“ä¸ºåœ¨å­˜å‚¨&lt;code&gt;key&lt;/code&gt;æ—¶ä¸èƒ½é‡å¤ï¼Œå¦‚æœ&lt;code&gt;key&lt;/code&gt;é‡å¤ï¼Œ&lt;code&gt;value&lt;/code&gt;ä¼šè¿›è¡Œè¦†ç›–ï¼Œé€šè¿‡&lt;code&gt;key&lt;/code&gt;è¿›è¡Œå“ˆå¸Œè¿ç®—ï¼Œç„¶åè¿›è¡Œè®¡ç®—å¾—åˆ°ä½ç½®ï¼Œä½†æ˜¯è¿™æ ·ä¼šå‡ºç°å“ˆå¸Œå†²çªçš„é—®é¢˜ï¼Œgoè¯­è¨€çš„è§£å†³æ–¹æ³•æ˜¯ç”¨æ‹‰é“¾æ³•è§£å†³å“ˆå¸Œå†²çªï¼Œä¹Ÿå°±æ˜¯ç”¨é“¾è¡¨ï¼Œåœ¨å†²çªä½ç½®çš„å…ƒç´ ä¸Šå½¢æˆä¸€ä¸ªé“¾è¡¨ï¼Œé€šè¿‡æŒ‡é’ˆäº’è¿æ¥ï¼Œåœ¨æŸ¥æ‰¾çš„æ—¶å€™å¦‚æœå‘ç°&lt;code&gt;key&lt;/code&gt;å†²çªäº†ï¼Œä¼šé¡ºç€é“¾è¡¨ä¸€ç›´å‘ä¸‹æ‰¾ï¼Œç›´åˆ°å°¾èŠ‚ç‚¹ï¼Œæ‰¾ä¸åˆ°åˆ™è¿”å›ç©ºã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;code&gt;overflow&lt;/code&gt;æŒ‡é’ˆæŒ‡å‘çš„æ˜¯æ‰©å®¹åçš„ä¸‹ä¸€ä¸ª&lt;code&gt;bmap&lt;/code&gt;ï¼Œä¼šæŠŠ&lt;code&gt;overflow&lt;/code&gt;æŒ‡é’ˆå­˜åˆ°&lt;code&gt;extra&lt;/code&gt;ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mapextra&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// overflow[0] contains overflow buckets for hmap.buckets.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// overflow[1] contains overflow buckets for hmap.oldbuckets.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bmap&lt;/span&gt;

    &lt;span class=&#34;c1&#34;&gt;// nextOverflow åŒ…å«ç©ºé—²çš„ overflow bucketï¼Œè¿™æ˜¯é¢„åˆ†é…çš„ bucket
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;nextOverflow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bmap&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒ&lt;code&gt;overflow&lt;/code&gt;æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œçœ‹ç»“æ„çš„å®šä¹‰ï¼Œåœ¨&lt;code&gt;map&lt;/code&gt;å“ˆå¸Œå†²çªè¿‡å¤šæ—¶ï¼Œä¼šå‘ç”Ÿæ‰©å®¹ï¼Œä¸ºäº†ä¸å…¨é‡æ¬è¿æ•°æ®ï¼Œä½¿ç”¨å¢é‡æ¬è¿ï¼Œæ‰€ä»¥æŒ‰ç…§è§£é‡Šè¯´çš„ï¼Œ&lt;code&gt;[0]&lt;/code&gt;æ—¶å½“å‰æº¢å‡ºæ¡¶çš„é›†åˆï¼Œ&lt;code&gt;[1]&lt;/code&gt;æ˜¯å‘ç”Ÿæ‰©å®¹åï¼Œä¿ç•™æ—§çš„æº¢å‡ºæ¡¶é›†åˆï¼Œ&lt;code&gt;overflow&lt;/code&gt;å­˜åœ¨çš„æ„ä¹‰åœ¨äºé˜²æ­¢æº¢å‡ºæ¡¶è¢«gcã€‚
â€ƒâ€ƒè€Œ&lt;code&gt;bmap&lt;/code&gt;çš„å†…å­˜æ¨¡å‹å¦‚ä¸‹ï¼Œ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œ&lt;code&gt;key&lt;/code&gt;å’Œ&lt;code&gt;value&lt;/code&gt;å¹¶ä¸æ˜¯é”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨ï¼Œæ˜¯ç‹¬ç«‹åˆ†å¼€æŒ‰ç…§é¡ºå¯»å­˜æ”¾ï¼Œ&lt;strong&gt;ç›®çš„æ˜¯ä¸ºäº†å‡å°‘padå­—æ®µï¼Œæ¶ˆé™¤padding(å†…å­˜å¯¹é½)å¸¦æ¥çš„ç©ºé—´æµªè´¹&lt;/strong&gt;ã€‚æ¯”å¦‚ï¼š&lt;code&gt;map[int64]int8&lt;/code&gt;,å¦‚æœä»¥&lt;code&gt;key-value&lt;/code&gt;çš„å½¢å¼å­˜å‚¨å°±å¿…é¡»åœ¨æ¯ä¸ª&lt;code&gt;value&lt;/code&gt;åé¢æ·»åŠ &lt;code&gt;padding7ä¸ªå­—èŠ‚&lt;/code&gt;ï¼Œå¦‚æœä»¥ä¸Šè¿°çš„å½¢å¼åªéœ€è¦åœ¨æœ€åä¸€ä¸ª&lt;code&gt;value&lt;/code&gt;åé¢æ·»åŠ &lt;code&gt;padding&lt;/code&gt;å°±å¯ä»¥äº†ã€‚
â€ƒâ€ƒä¸‹é¢æ˜¯æ•´ä¸ª&lt;code&gt;map&lt;/code&gt;çš„å¤§ä½“æ„é€ ï¼š
&lt;img src=&#34;https://zonzeeli.github.io/p/map/hmap.png&#34;
	width=&#34;771&#34;
	height=&#34;708&#34;
	srcset=&#34;https://zonzeeli.github.io/p/map/hmap_hu8f2f49e0bdd5fd6e5596a3a64f321745_40827_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/map/hmap_hu8f2f49e0bdd5fd6e5596a3a64f321745_40827_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;108&#34;
		data-flex-basis=&#34;261px&#34;
	
&gt;
â€ƒâ€ƒæ¥ä¸‹æ¥ç®€å•è¯´ä¸€ä¸‹&lt;code&gt;map&lt;/code&gt;çš„åˆ›å»ºå‡½æ•°&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;makemap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;maptype&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hint&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;mem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;MulUintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;overflow&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;mem&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;maxAlloc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;hint&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;......&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œå…¶å®æ¯æ¬¡&lt;code&gt;make(map[key]value)&lt;/code&gt;è¿”å›çš„æ˜¯æŒ‡é’ˆï¼Œè€Œæ¯æ¬¡å¤åˆ¶ï¼Œæ¯”å¦‚&lt;code&gt;a := b&lt;/code&gt;è¿™ç§æ“ä½œï¼Œä¹Ÿæ˜¯åˆ›å»ºæŒ‡é’ˆå‰¯æœ¬ï¼Œå¤åˆ¶äº†&lt;code&gt;hmap&lt;/code&gt;çš„æŒ‡é’ˆï¼Œéƒ½æ˜¯å…±äº«ä¸€ä¸ª&lt;code&gt;map&lt;/code&gt;ï¼Œä½¿ç”¨èµ·æ¥å¾ˆåƒå¼•ç”¨ï¼Œè¿™ä¸ªå’Œ&lt;code&gt;slice&lt;/code&gt;çš„åº•å±‚æ•°ç»„ä¸åŒï¼Œæ¯æ¬¡&lt;code&gt;map&lt;/code&gt;çš„æ‰©å®¹ï¼Œæ‰€æœ‰éƒ½æ˜¯å…±äº«ä¸€ä¸ª&lt;code&gt;map&lt;/code&gt;ã€‚
â€ƒâ€ƒä¸‹é¢æ˜¯goè¯­è¨€ä¸­&lt;code&gt;map&lt;/code&gt;å­˜å‚¨èµ‹å€¼çš„éƒ¨åˆ†æºç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;34
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;35
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;36
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;37
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;38
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;39
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;40
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;41
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;42
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;43
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;44
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;45
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;46
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;47
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;48
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;49
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;50
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;51
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;52
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;53
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;54
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;55
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;56
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;57
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;58
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;59
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;60
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;61
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;62
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;63
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;64
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;65
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;66
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;67
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;68
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;69
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;70
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;71
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;72
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;73
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;74
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;75
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;76
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;77
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;78
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;79
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;80
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;81
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;82
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;83
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;84
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;85
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;86
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;87
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;88
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;mapassign&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;maptype&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//è·å–hashç®—æ³•
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;alg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;alg&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//è®¡ç®—hashå€¼
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;alg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hash0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//å¦‚æœbucketæ•°ç»„ä¸€å¼€å§‹ä¸ºç©ºï¼Œåˆ™åˆå§‹åŒ–
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buckets&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buckets&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;newobject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucket&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// newarray(t.bucket, 1)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;again&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;// å®šä½å­˜å‚¨åœ¨å“ªä¸€ä¸ªbucketä¸­
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;bucket&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bucketMask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//å¾—åˆ°bucketçš„ç»“æ„ä½“
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;buckets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucket&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucketsize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//è·å–é«˜å…«ä½hashå€¼
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;nx&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;uint8&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;
    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;bucketloop&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//æ­»å¾ªç¯
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//å¾ªç¯bucketä¸­çš„tophashæ•°ç»„
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bucketCnt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;//å¦‚æœhashä¸ç›¸ç­‰
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;top&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
             &lt;span class=&#34;c1&#34;&gt;//åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™æ’å…¥
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;isEmpty&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                    &lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
                    &lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dataOffset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keysize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
                    &lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; 
                    &lt;span class=&#34;nx&#34;&gt;dataOffset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucketCnt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keysize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;valuesize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
              &lt;span class=&#34;c1&#34;&gt;//æ’å…¥æˆåŠŸï¼Œç»ˆæ­¢æœ€å¤–å±‚å¾ªç¯
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;emptyRest&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                    &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bucketloop&lt;/span&gt;
                &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;//åˆ°è¿™é‡Œè¯´æ˜é«˜å…«ä½hashä¸€æ ·ï¼Œè·å–å·²å­˜åœ¨çš„key
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;nx&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dataOffset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keysize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;indirectkey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;nx&#34;&gt;k&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;//åˆ¤æ–­ä¸¤ä¸ªkeyæ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰å°±å¾ªç¯ä¸‹ä¸€ä¸ª
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;alg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;equal&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;// å¦‚æœç›¸ç­‰åˆ™æ›´æ–°
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;needkeyupdate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
                &lt;span class=&#34;nf&#34;&gt;typedmemmove&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
            &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
            &lt;span class=&#34;c1&#34;&gt;//è·å–å·²å­˜åœ¨çš„value
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;            &lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dataOffset&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bucketCnt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keysize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;valuesize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;goto&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;done&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;//å¦‚æœä¸Šä¸€ä¸ªbucketæ²¡èƒ½æ’å…¥ï¼Œåˆ™é€šè¿‡overflowè·å–é“¾è¡¨ä¸Šçš„ä¸‹ä¸€ä¸ªbucket
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;ovf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;overflow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ovf&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ovf&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;c1&#34;&gt;// all current buckets are full, allocate a new one.
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;        &lt;span class=&#34;nx&#34;&gt;newb&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;newoverflow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;tophash&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;newb&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;dataOffset&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bucketCnt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;uintptr&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;keysize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

    &lt;span class=&#34;c1&#34;&gt;// store new key/value at insert position
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;indirectkey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;kmem&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;newobject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;kmem&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;kmem&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;indirectvalue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
        &lt;span class=&#34;nx&#34;&gt;vmem&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;newobject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;elem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
        &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Pointer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;vmem&lt;/span&gt;
    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
    &lt;span class=&#34;nf&#34;&gt;typedmemmove&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;insertk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
    &lt;span class=&#34;c1&#34;&gt;//å°†é«˜å…«ä½hashå€¼å­˜å‚¨
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;inserti&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;top&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;val&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæœ‰ä¸€ä¸ªåœ°æ–¹è¦æ³¨æ„ä¸€ä¸‹goè¯­è¨€çš„&lt;code&gt;map&lt;/code&gt;ï¼Œé€šè¿‡&lt;code&gt;key&lt;/code&gt;è·å–åˆ°&lt;code&gt;value&lt;/code&gt;ï¼Œ&lt;code&gt;value&lt;/code&gt;æ˜¯ä¸å¯å¯»å€çš„ï¼Œå› ä¸º&lt;code&gt;map&lt;/code&gt;ä¼šè¿›è¡ŒåŠ¨æ€æ‰©å®¹ï¼Œè¿›è¡Œæ‰©å±•åï¼Œ&lt;code&gt;map&lt;/code&gt;çš„&lt;code&gt;value&lt;/code&gt;ä¼šè¿›è¡Œå†…å­˜è¿ç§»ï¼Œå…¶åœ°å€ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ— æ³•å¯¹è¿™ä¸ª&lt;code&gt;value&lt;/code&gt;è¿›è¡Œå¯»å€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;test&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;testmap&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;testmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;ZonzeeLi&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// è¿™ä¸€è¡Œç¼–è¯‘ä¸é€šè¿‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;testmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Changed&amp;#34;&lt;/span&gt;
	
	&lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªä¸æ˜¯å¤åˆ¶mapï¼Œä¸ä¼šå¯¹åŸmapæœ‰å½±å“
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;testmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;Changed again&amp;#34;&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;mapçš„æ‰©ç¼©å®¹æœºåˆ¶&#34;&gt;Mapçš„æ‰©ç¼©å®¹æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;code&gt;map&lt;/code&gt;æœ€é‡è¦ä¸”æœ€å¤šé—®çš„å°±æ˜¯å…¶æ‰©å®¹æœºåˆ¶ï¼Œè¿™é‡ŒæŠŠæ‰©ç¼©å®¹éƒ½ç®€å•æ€»ç»“ä¸€ä¸‹ã€‚
â€ƒâ€ƒæœ‰ä¸¤ç§æƒ…å†µè¦æ‰©å®¹ï¼Œä¸€ç§æ˜¯&lt;code&gt;kv&lt;/code&gt;å¤ªå¤šï¼Œè¶…è¿‡è´Ÿè½½ï¼Œå¦ä¸€ç§æ˜¯&lt;code&gt;overflow&lt;/code&gt;çš„&lt;code&gt;bucket&lt;/code&gt;è¿‡å¤šã€‚ç¬¬ä¸€ç§æƒ…å†µå½“æ‰©å®¹æ—¶ï¼Œgoè¯­è¨€ä¼šå°†&lt;code&gt;bucket&lt;/code&gt;æ•°ç»„çš„æ•°é‡æ‰©å……ä¸€å€ï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„&lt;code&gt;bucket&lt;/code&gt;æ•°ç»„ï¼Œå¹¶ä¸”å°†å°±æ•°ç»„çš„æ•°æ®è¿ç§»è‡³æ–°æ•°ç»„ä¸­ï¼Œå¦‚æœæ˜¯&lt;code&gt;bucket&lt;/code&gt;è¿‡å¤šï¼Œä¹Ÿå°±æ˜¯ç¬¬äºŒç§æƒ…å†µï¼Œæ‰©å®¹åçš„&lt;code&gt;bucket&lt;/code&gt;æ•°é‡ä¸å˜ï¼Œåšå†…å­˜æ•´ç†ã€‚æˆ‘ä»¬æ¥è§£é‡Šä¸€ä¸‹æ‰©å……çš„è¿‡ç¨‹ï¼Œå½“&lt;code&gt;map&lt;/code&gt;çš„é•¿åº¦å¢å¤§åˆ°å¤§äºè´Ÿè½½å› å­æ‰€éœ€çš„é•¿åº¦ï¼Œä¼šå»ç”³è¯·ä¸€ä¸ªæ–°çš„å¤§æ•°ç»„ä½œä¸º&lt;code&gt;bucket&lt;/code&gt;ï¼Œå³&lt;code&gt; newbuckets, nextOverflow := makeBucketArray(t, h.B+bigger, nil)&lt;/code&gt;ï¼Œå›å°†æ—§çš„&lt;code&gt;bucket&lt;/code&gt;æ•°ç»„å­˜æ”¾åœ¨&lt;code&gt;oldbucket&lt;/code&gt;ä¸­åšå¡«å……ï¼Œè¿™é‡Œå¹¶ä¸æ˜¯ç«‹å³æŠŠæ—§çš„æ•°ç»„ä¸­çš„æ•°æ®è½¬ç§»åˆ°æ–°çš„&lt;code&gt;newbucket&lt;/code&gt;ä¸­ï¼Œè€Œæ˜¯åªæœ‰åœ¨è®¿é—®åˆ°å…·ä½“çš„æŸä¸ª&lt;code&gt;bucket&lt;/code&gt;æ—¶ï¼Œæ‰ä¼šæŠŠæ•°æ®è½¬ç§»åˆ°æ–°çš„&lt;code&gt;newbucket&lt;/code&gt;ä¸­ï¼Œå¦‚ä¸‹å›¾ï¼š
&lt;img src=&#34;https://zonzeeli.github.io/p/map/bucket%E8%BD%AC%E7%A7%BB.png&#34;
	width=&#34;715&#34;
	height=&#34;639&#34;
	srcset=&#34;https://zonzeeli.github.io/p/map/bucket%E8%BD%AC%E7%A7%BB_hu35a9f78d0a8a7ffaaac90f7482fa0cde_27457_480x0_resize_box_3.png 480w, https://zonzeeli.github.io/p/map/bucket%E8%BD%AC%E7%A7%BB_hu35a9f78d0a8a7ffaaac90f7482fa0cde_27457_1024x0_resize_box_3.png 1024w&#34;
	loading=&#34;lazy&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;111&#34;
		data-flex-basis=&#34;268px&#34;
	
&gt;
â€ƒâ€ƒæ³¨ï¼šè¿™é‡Œå¹¶ä¸ä¼šç›´æ¥åˆ é™¤æ—§çš„&lt;code&gt;bucket&lt;/code&gt;ï¼Œè€Œæ˜¯æŠŠåŸæ¥çš„å¼•ç”¨å»æ‰ï¼Œåˆ©ç”¨gcæ¸…é™¤å†…å­˜ã€‚
â€ƒâ€ƒé‚£ä¹ˆåœ¨è¿™é‡Œå°±å¯ä»¥è”æƒ³åˆ°ï¼Œ&lt;code&gt;map&lt;/code&gt;çš„åˆ é™¤æ“ä½œï¼Œå¦‚æœ&lt;code&gt;key&lt;/code&gt;æ˜¯ä¸€ä¸ªæŒ‡é’ˆç±»å‹ï¼Œåˆ™å°†å…¶ç½®ç©ºï¼Œç­‰å¾…gcæ¸…é™¤ï¼Œå¦‚æœæ˜¯å€¼ï¼Œåˆ™æ¸…æ¥šç›¸å…³å†…å­˜ï¼Œå¯¹&lt;code&gt;value&lt;/code&gt;ä¹Ÿæ˜¯ç›¸å…³æ“ä½œï¼Œæœ€åä¼šæŠŠ&lt;code&gt;key&lt;/code&gt;å¯¹åº”çš„é«˜ä½å€¼å¯¹åº”çš„æ•°ç»„indexç½®ä¸ºç©ºã€‚ä½†æ˜¯&lt;code&gt;map&lt;/code&gt;çš„&lt;code&gt;delete&lt;/code&gt;æ“ä½œï¼Œä¼šæœ‰å¯èƒ½å‡ºç°å¾ˆå¤šç©ºçš„&lt;code&gt;kv&lt;/code&gt;ï¼Œä¼šå¯¼è‡´æ¬è¿æ“ä½œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;hashGrow&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;maptype&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;hmap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;bigger&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;uint8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;overLoadFactor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;B&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;bigger&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;h&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;flags&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;sameSizeGrow&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ— è®ºæ˜¯æ‰©å®¹è¿˜æ˜¯ç¼©å®¹ï¼Œå¯¹åº”çš„ä»£ç æ®µéƒ½æ˜¯è¿™ä¸€æ®µï¼Œå¦‚æœæ˜¯æ‰©å®¹ï¼Œåˆ™&lt;code&gt;bigger = 1&lt;/code&gt;ï¼Œå¦åˆ™å®¹é‡ä¸å˜ï¼Œæ‰€ä»¥ç¼©å®¹ï¼Œå¯¹äºå†…å­˜ç©ºé—´çš„å ç”¨æ¥è¯´å¹¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ã€‚æ‰€ä»¥é’ˆå¯¹ä¸Šè¿°ä»‹ç»çš„&lt;code&gt;map&lt;/code&gt;çš„&lt;code&gt;delete&lt;/code&gt;æ“ä½œï¼Œä¸æ³¨æ„ç®¡ç†ä¼šä½¿åˆ†é…çš„å†…å­˜ä¸æ–­å¢åŠ ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mapçš„å¹¶å‘å®‰å…¨é—®é¢˜&#34;&gt;Mapçš„å¹¶å‘å®‰å…¨é—®é¢˜&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒgoè¯­è¨€çš„&lt;code&gt;map&lt;/code&gt;å¹¶ä¸æ”¯æŒå¹¶å‘è¯»å†™ï¼Œä¹Ÿå°±æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™ä¸€ç‚¹å’Œ&lt;code&gt;slice&lt;/code&gt;çœŸçš„æ˜¯éš¾å…„éš¾å¼Ÿã€‚å¦‚æœæœ‰å¤šä¸ª&lt;code&gt;goroutine&lt;/code&gt;æ“ä½œï¼Œä»£ç å†™æ³•ä¸å½“ä¼šæŠ¥é”™&lt;code&gt;fatal error: concurrent map writes&lt;/code&gt;ï¼Œæ— è®ºæ˜¯åœ¨è¯»åœ¨å†™çš„è¿‡ç¨‹ä¸­ï¼Œç”šè‡³æ˜¯å†™ä¸€ä¸ªhttpçš„è¯·æ±‚æœåŠ¡ï¼Œæ¯æ¬¡éƒ½è¦è¯»ä¸€ä¸ª&lt;code&gt;map&lt;/code&gt;ï¼Œåœ¨é«˜å¹¶å‘çš„åœºæ™¯ä¸‹ä¹Ÿä¼šæŠ¥è¿™æ ·çš„é”™ï¼Œè€Œåœ¨å…¶ä»–æ—¶å€™å¹¶ä¸ä¼šï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªéšå¼é—®é¢˜ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;sync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;RWMutex&lt;/span&gt;
    &lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæœ€å¸¸è§çš„å°±æ˜¯åŠ ä¸€ä¸ªé”ï¼Œå®šä¹‰ä¸€ä¸ªç»“æ„ä½“åŒ…å«ä¸€ä¸ª&lt;code&gt;map&lt;/code&gt;ç»“æ„ä½“å’Œä¸€ä¸ªåµŒå…¥è¯»å†™é”&lt;code&gt;sync.RWMutex&lt;/code&gt;ã€‚è¯»å†™æ•°æ®åˆ†åˆ«å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// è¯»æ•°æ®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RLock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RUnlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;

&lt;span class=&#34;c1&#34;&gt;// å†™æ•°æ®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Lock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Unlock&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒè€Œgoè¯­è¨€è‡ªèº«æä¾›äº†ä¸€ç§&lt;code&gt;type Map&lt;/code&gt;ï¼Œå³&lt;code&gt;sync.Map&lt;/code&gt;ï¼Œæ˜¯ä¸€ç§æ”¯æŒå¹¶å‘è¯»å†™çš„&lt;code&gt;map&lt;/code&gt;ï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ªæ•°æ®ç»“æ„&lt;code&gt;read&lt;/code&gt;å’Œ&lt;code&gt;dirty&lt;/code&gt;ï¼Œå‡å°‘é”å¯¹æ€§èƒ½çš„å½±å“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;mu&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Mutex&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;read&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;atomic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Value&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// readOnly
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;dirty&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;entry&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;misses&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Delete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Load&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ok&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;LoadAndDelete&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;LoadOrStore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;actual&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{},&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;loaded&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Store&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;interface&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¯¹äº&lt;code&gt;sync.Map&lt;/code&gt;ç»“æ„ï¼Œæ›´é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œæˆ‘ä¹‹å‰çœ‹åˆ°äº†ç…é±¼å¤§ä½¬å¯¹&lt;code&gt;sync.Map&lt;/code&gt;å†…éƒ¨ç»“æ„çš„åˆ†æå’Œä¸ºä»€ä¹ˆé€‚åˆè¯»å¤šå†™å°‘çš„æ€§èƒ½æµ‹è¯•ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹&lt;a class=&#34;link&#34; href=&#34;https://mp.weixin.qq.com/s?__biz=MzUxMDI4MDc1NA==&amp;amp;mid=2247489164&amp;amp;idx=1&amp;amp;sn=e56e5c9836cda40f3c95a39e2ba57dde&amp;amp;chksm=f90403d1ce738ac7d746c35a2b09b00aebcdf3e6a28ee58f2f9cf11b53b366e548b570cc5a1e&amp;amp;scene=178&amp;amp;cur_album_id=1751854579329056768#rd&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;â€ƒâ€ƒOK!æœ‰å…³goè¯­è¨€&lt;code&gt;map&lt;/code&gt;çš„ä»‹ç»å°±è¿™ä¹ˆå¤šäº†ï¼Œè‡³äºæ‰©å®¹å†…éƒ¨æºç çš„åˆ†æã€æ¬è¿æ“ä½œç­‰å¯ä»¥å†ç»†è‡´çš„å¯¹åº”ä»£ç å»ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒCoding every dayï¼&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€â€”â€”å»¶è¿Ÿå‡½æ•°deferçš„ä½¿ç”¨</title>
        <link>https://zonzeeli.github.io/p/defer/</link>
        <pubDate>Tue, 08 Mar 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/defer/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/defer/godefer.jpg" alt="Featured image of post Goè¯­è¨€â€”â€”å»¶è¿Ÿå‡½æ•°deferçš„ä½¿ç”¨" /&gt;&lt;h2 id=&#34;å»¶è¿Ÿå‡½æ•°defer&#34;&gt;å»¶è¿Ÿå‡½æ•°(defer)&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒå»¶è¿Ÿå‡½æ•°ï¼Œé¡¾åæ€ä¹‰ï¼Œæ˜¯åœ¨ä¹‹åæ‰§è¡Œçš„å‡½æ•°ï¼Œé‚£ä¹ˆå…·ä½“æ€ä¹ˆä¸ªä¹‹åæ³•å‘¢ï¼Ÿåœ¨å‡½æ•°è°ƒç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç†è§£ä¸ºè°ƒç”¨å‡½æ•°çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œa-&amp;gt;b-&amp;gt;cï¼Œæ•´ä¸ªè°ƒç”¨è¿‡ç¨‹æ˜¯å…ˆaå†bå†cï¼Œè€Œå»¶è¿Ÿå‡½æ•°å°±æ˜¯åœ¨è°ƒç”¨açš„ç¨‹åºè¿‡ç¨‹ä¸­å†™å…¥ä¸€ä¸ªå»¶è¿Ÿæ‰§è¡Œï¼Œåœ¨aå‡½æ•°returnä¹‹åæ·»åŠ ä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚å› æ­¤ï¼Œdeferçš„å¸¸ç”¨åŠŸèƒ½ä¸ºé‡Šæ”¾èµ„æºã€å…³é—­è¿æ¥ã€æ•è·é”™è¯¯ç­‰ï¼Œè¿™æ˜¯ä¸€ç§è¯­è¨€ä¿æŠ¤æœºåˆ¶ã€‚ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å¦‚æœæ­¤å¤„Openå‡½æ•°æ²¡æœ‰é—®é¢˜ï¼Œç»§ç»­å‘ä¸‹
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Create&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å¦‚æœæ­¤å¤„å‘ç”Ÿerrorï¼Œé‚£ä¹ˆç›´æ¥returnï¼Œåé¢çš„ä¸¤ä¸ªcloseéƒ½ä¸æ‰§è¡Œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; 
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒä¸Šé¢è¿™æ®µä»£ç ä¸­å¦‚æœOpenå‡½æ•°æ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯Createå‡½æ•°é”™äº†ï¼Œè¿”å›é”™è¯¯æ—¶ä¸‹é¢çš„closeå‡½æ•°æ²¡æœ‰åŠæ³•æ‰§è¡Œï¼Œå°±ä¼šå¯¼è‡´fæ²¡æœ‰å…³é—­ï¼Œä½†æ˜¯æˆ‘ä»¬åˆä¸èƒ½ç›´æ¥å†™åœ¨ä¸Šé¢ï¼Œå› ä¸ºè¿˜æ²¡å¯¹fè¿›è¡Œæ“ä½œå°±å…³é—­äº†æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œå°±è¦ä½¿ç”¨å»¶è¿Ÿå‡½æ•°äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ³¨æ„è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªå‘ï¼Œä¸‹é¢å†ä»‹ç»
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ¥ä¸‹æ¥æˆ‘ä»¬å°±ä»‹ç»deferçš„ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;h2 id=&#34;deferçš„æ‰§è¡Œå‚æ•°&#34;&gt;deferçš„æ‰§è¡Œå‚æ•°&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒdeferçš„æ‰§è¡Œå‚æ•°åœ¨deferå†™å…¥çš„ä½ç½®å°±å·²ç»ç¡®å®šå¥½äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œdeferå¹¶ä¸åªæ˜¯å•å•åœ¨returnä¹‹åæ‰§è¡Œï¼Œè€Œæ˜¯åœ¨å‡†å¤‡å»¶è¿Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œå°±å·²ç»æŠŠå‚æ•°ä¸€å¹¶å‹å…¥å †æ ˆä¸­ç­‰å¾…æ‰§è¡Œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªæ—¶å€™å·²ç»å°†x=5ä¼ å‚ç»™printå‡½æ•°äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœæ‰“å°ä¸º6 5 (æ³¨æ„æ­£å¸¸æ˜¯æ¢è¡Œæ‰“å°ï¼Œä¸ºäº†çœ‹èµ·æ¥æ–¹ä¾¿å°±è¿™ä¹ˆå†™äº†ï¼Œåé¢ä¹Ÿä¸€æ ·)
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ€è€ƒä¸€ä¸‹è¿™æ ·å†™ç»“æœå‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// è¿™é‡Œç›¸å½“äºä¸€ä¸ªé—­åŒ…ï¼Œdeferæ‰§è¡Œçš„æ˜¯ä¸€ä¸ªfunc()ï¼Œä½†æ˜¯func()ä¸éœ€è¦ä»»ä½•å‚æ•°ï¼Œè€Œæ˜¯å»æ‰§è¡Œæ‰“å°xï¼Œè¿™æ—¶å€™xå°±æ‰“å°å‡ºä¸º6äº†ï¼Œè¯·åŒºåˆ†å’Œä¸‹é¢çš„åŒ¿åå‡½æ•°çš„é—®é¢˜
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœæ‰“å°ä¸º6 6
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;deferçš„æ‰§è¡Œé¡ºåº&#34;&gt;deferçš„æ‰§è¡Œé¡ºåº&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåœ¨çŸ¥é“äº†deferçš„æ‰§è¡Œå‚æ•°åå°±éœ€è¦çŸ¥é“deferçš„æ‰§è¡Œé¡ºåºï¼Œå¦‚æœæœ‰å¤šæ¡deferè¯­å¥çš„è¯ï¼Œæ ¹æ®å‹å…¥é¡ºåºï¼Œæœ€åæ˜¯é€†åºæ‰§è¡Œçš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æœ€åæ‰§è¡Œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å†æ‰§è¡Œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ZonzeeLi&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å…ˆæ‰§è¡Œ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;ä½ å¥½&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœæ‰“å°ä¸º ä½ å¥½ ZonzeeLi 6
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;deferå¯¹åŒ¿åè¿”å›å€¼çš„è¿”å›å¤„ç†&#34;&gt;deferå¯¹åŒ¿åè¿”å›å€¼çš„è¿”å›å¤„ç†&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬åœ¨è‡ªå·±å†™ä¸€ä¸ªfunc()çš„æ—¶å€™ç»å¸¸ä¼šå†™è¿”å›å€¼ï¼Œä½†æ˜¯è¿”å›å€¼æ—¶åˆ†å‘½åå’ŒåŒ¿åä¸¤ç§ï¼Œè¿™åœ¨deferä¸­åˆæœ‰åŒºåˆ«äº†ï¼Œæˆ‘ä»¬çœ‹ä¸‹é¢ä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt; 
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
		&lt;span class=&#34;c1&#34;&gt;// åœ¨è¿™ä¸ªåœ°æ–¹åŠ ä¸€ä¸ªæ‰“å°xï¼Œçœ‹çœ‹ç»“æœæ˜¯å¤šå°‘ï¼Ÿ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªå‡½æ•°è¿”å›5
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å¦‚æœæŠŠè¿™ä¸ªxæ¢æˆyçš„è¯ï¼Œè¿”å›ç»“æœæ˜¯å¤šå°‘ï¼Ÿ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//x = 0
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªå‡½æ•°è¿”å›6
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªè¿”å›æ˜¯å¤šå°‘ï¼Ÿ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;++&lt;/span&gt;
		&lt;span class=&#34;c1&#34;&gt;// è¿™é‡ŒåŠ ä¸€ä¸ªæ‰“å°xï¼Œæ‰“å°çš„æ˜¯å¤šå°‘ï¼Ÿ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;50&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// è¿™ä¸ªç»“æœè¿”å›ä¸º50ï¼Œè¯·è‡ªè¡Œæ€è€ƒï¼Œè§£é‡Šå‚è€ƒä¸Šé¢çš„deferæ‰§è¡Œå‚æ•°
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒf1ä¸­ä½¿ç”¨çš„æ˜¯åŒ¿åè¿”å›å€¼ï¼Œf2ä¸­ä½¿ç”¨çš„æ˜¯å‘½åè¿”å›å€¼ï¼Œf1çš„åŒ¿åè¿”å›å€¼ï¼Œç›¸å½“äºè¿”å›xçš„ä¸€ä¸ªå‰¯æœ¬ç»™f1çš„returnï¼Œæ‰€ä»¥å¯¹xè¿›è¡Œx++æ“ä½œæ²¡æœ‰å¯¹returnè¿›è¡Œå½±å“ï¼Œè€Œæœ‰å‘½åè¿”å›å€¼åˆ™ä¸åŒï¼Œdeferçš„ä½œç”¨åŸŸå§‹ç»ˆæ˜¯åœ¨è¿™ä¸ªå‡½æ•°å†…çš„ï¼Œæ‰€ä»¥ä½¿ç”¨çš„è¿”å›å€¼å°±æ˜¯xã€‚&lt;/p&gt;
&lt;h2 id=&#34;defer-panic-recoverçš„é…åˆä½¿ç”¨&#34;&gt;defer panic recoverçš„é…åˆä½¿ç”¨&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ç»“æœä¸ºpanic: 1ï¼Œ ä¸ä¼šæ‰“å°2
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæˆ‘ä»¬çŸ¥é“å¦‚æœå‡½æ•°panicäº†ï¼Œå°±ç›´æ¥ç»ˆæ­¢è¿è¡Œäº†ï¼Œåé¢çš„è¯­å¥éƒ½ä¸ä¼šæ‰§è¡Œï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„è¯å°±éœ€è¦recoverï¼Œè¿™æ—¶å€™deferçš„å»¶è¿Ÿä½¿ç”¨å°±éå¸¸æœ‰å¸®åŠ©äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;æ•è·æˆåŠŸå•¦ï¼&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ç»“æœä¸º æ•è·æˆåŠŸå•¦ï¼2
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¦å¤–è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¿ç»­è°ƒç”¨panicï¼Œä»…æœ€åä¸€ä¸ªä¼šè¢«recoveræ•è·ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
				&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Fatalln&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;fatal&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
			&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;you are dead&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;i am dead&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœä¸º
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// 2022/03/08 15:58:08 you are dead
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// 2022/03/08 15:58:08 fatal
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ—¢ç„¶è¯´åˆ°è¿™ï¼Œæˆ‘å°±è¡¥å……ä¸€ä¸‹ï¼Œdeferä¸­ç›´æ¥è°ƒç”¨recoveræ˜¯æ— æ•ˆçš„ï¼Œä¸¾ä¾‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ— æ•ˆ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æ— æ•ˆ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	
	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;i am dead&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h2 id=&#34;å¸¸è§çš„deferé¢è¯•é¢˜å’Œå‘&#34;&gt;å¸¸è§çš„deferé¢è¯•é¢˜å’Œå‘&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒä»¥ä¸Šå°†deferçš„å‡ ä¸ªç”¨æ³•ä»‹ç»å®Œäº†ï¼Œä¸‹é¢æˆ‘æ€»ç»“äº†åœ¨ä¸€äº›åšä¸»çš„æ–‡ç« ä¸­çœ‹åˆ°çš„é—®é¢˜å’Œå¹³å¸¸é‡è§çš„å‘ï¼š&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜ä¸€ä¸€é“é¢è¯•é¢˜å‡ºè‡ªææ–‡å‘¨çš„åšå®¢httpswwwliwenzhoucom&#34;&gt;é—®é¢˜ä¸€ï¼Œä¸€é“é¢è¯•é¢˜ï¼Œå‡ºè‡ª&lt;a class=&#34;link&#34; href=&#34;https://www.liwenzhou.com/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ææ–‡å‘¨çš„åšå®¢&lt;/a&gt;&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;ret&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;index&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ret&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ret&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;AA&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;A&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å…ˆæ‰§è¡Œäº†calc(&amp;#34;A&amp;#34;, x, y)ï¼Œç„¶åå†å‹å…¥deferæ‰§è¡Œè¯­å¥å’Œdeferéœ€è¦çš„å‚æ•°
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;BB&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;calc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;B&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;x&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;y&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœæ‰“å°ä¸º
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// A 1 2 3
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// B 10 2 12
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// BB 10 12 22
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// AA 1 3 4
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒä¸Šé¢çš„è¿™ä¸ªè§£é‡Šè¿˜æ˜¯ä¸»è¦ç”±deferçš„æ‰§è¡Œå‚æ•°æœ‰å…³ç³»ï¼Œé¦–å…ˆå†æ‰§è¡Œ&lt;code&gt;defer calc(&amp;quot;AA&amp;quot;, x, calc(&amp;quot;A&amp;quot;, x, y))&lt;/code&gt;ï¼Œä»–çš„ä¸‰ä¸ªå‚æ•°å°±å·²ç»ç¡®å®šäº†ï¼Œé‚£ä¹ˆç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ç”±&lt;code&gt;calc(&amp;quot;A&amp;quot;, x, y)&lt;/code&gt;çš„è¿”å›å€¼å†³å®šçš„ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±ä¼šå…ˆæ‰§è¡Œè¿™ä¸€æ¡ï¼Œç„¶åå°†å‚æ•°ä¸€åŒå‹å…¥æ ˆï¼Œå°†å»¶è¿Ÿå‡½æ•°å‹å…¥å‡½æ•°è°ƒç”¨ï¼Œä¸‹é¢çš„&lt;code&gt;defer calc(&amp;quot;BB&amp;quot;, x, calc(&amp;quot;B&amp;quot;, x, y))&lt;/code&gt;ä¹ŸåŒç†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜äºŒforå¾ªç¯å¯¼è‡´æ€§èƒ½é—®é¢˜å‡ºè‡ªgoè¯­è¨€å­¦ä¹ ç¬”è®°&#34;&gt;é—®é¢˜äºŒï¼Œforå¾ªç¯å¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå‡ºè‡ªã€ŠGoè¯­è¨€å­¦ä¹ ç¬”è®°ã€‹&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;++&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒä¸Šé¢çš„ä»£ç å…¶å®æ²¡ä»€ä¹ˆè¿è¡Œé—®é¢˜ï¼Œåªæ˜¯deferçš„æ‰§è¡Œéœ€è¦å°½å¿ƒå¾ˆå¤šå‹æ ˆå‡ºæ ˆä»¥åŠå†…å­˜ä½¿ç”¨çš„æ“ä½œï¼Œä¼šæ¶ˆè€—å¾ˆå¤šèµ„æºï¼Œæ‰€ä»¥åº”è¯¥ç›´æ¥æ‰§è¡Œæˆ–è€…å°è£…ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜ä¸‰deferè¯­å¥çš„ä½ç½®å‡ºè‡ªç‰›å®¢ç½‘goè¯­è¨€é¢è¯•é¢˜&#34;&gt;é—®é¢˜ä¸‰ï¼Œdeferè¯­å¥çš„ä½ç½®ï¼Œå‡ºè‡ªç‰›å®¢ç½‘Goè¯­è¨€é¢è¯•é¢˜&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Close&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; 
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// defer f.Close()
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒä¸Šé¢çš„ä»£ç å†™æ³•æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿä¹Ÿæ­£å¸¸æ‰§è¡Œå»¶è¿ŸCloseäº†ï¼Ÿé—®é¢˜åœ¨äºdeferè¯­å¥çš„ä½ç½®ï¼Œå¦‚æœå†™åœ¨åˆ¤æ–­errç„¶åreturnä¹‹å‰ï¼Œå¦‚æœOpenå‘ç”Ÿå¼‚å¸¸ï¼Œé‚£ä¹ˆfå°±æ˜¯ç©ºæŒ‡é’ˆï¼Œåœ¨returnä¹‹åæ‰§è¡Œ&lt;code&gt;defer f.Close()&lt;/code&gt;å°±ä¼šæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ï¼Œæ‰€ä»¥è¦åœ¨å¤„ç†ç©é”™è¯¯ï¼Œreturnä¹‹åæ‰§è¡Œdeferã€‚&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜å››å¦‚ä¸‹ä»£ç å½“å‡½æ•°deferdemoè¿”å›å¤±è´¥æ—¶å¹¶ä¸èƒ½destroyå·²createæˆåŠŸçš„èµ„æºè¿™ä¸€è¯´æ³•æ˜¯å¦æ­£ç¡®å‡ºè‡ªç‰›å®¢ç½‘goè¯­è¨€é¢è¯•é¢˜&#34;&gt;é—®é¢˜å››ï¼Œå¦‚ä¸‹ä»£ç ï¼Œå½“å‡½æ•°deferDemo()è¿”å›å¤±è´¥æ—¶ï¼Œå¹¶ä¸èƒ½destroyå·²createæˆåŠŸçš„èµ„æºï¼Œè¿™ä¸€è¯´æ³•æ˜¯å¦æ­£ç¡®ï¼Œå‡ºè‡ªç‰›å®¢ç½‘Goè¯­è¨€é¢è¯•é¢˜&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;22
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;23
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;24
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;25
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;26
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;27
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;28
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;29
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;30
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;31
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;32
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;33
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;deferDemo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;createResource1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ERR_CREATE_RESOURCE1_FAILED&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å¦‚æœ1å¤±è´¥ï¼Œç›´æ¥è¿”å›æ²¡æœ‰ä»»ä½•åˆ›å»ºæˆåŠŸçš„èµ„æº
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; 
			&lt;span class=&#34;nf&#34;&gt;destroyResource1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;createResource2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ERR_CREATE_RESOURCE2_FAILED&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// å¦‚æœ2åˆ›å»ºå¤±è´¥ï¼Œé‚£ä¹ˆæ‰§è¡Œä¸Šé¢çš„deferï¼Œdestroyå·²ç»åˆ›å»ºçš„1
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;nf&#34;&gt;destroyResource2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;createResource3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ERR_CREATE_RESOURCE3_FAILED&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// åŒç†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
			&lt;span class=&#34;nf&#34;&gt;destroyResource3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ­£ç¡®ç­”æ¡ˆæ˜¯é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯å¦‚æœè¿”å›å¤±è´¥ï¼Œå¯ä»¥destroyå·²ç»createçš„èµ„æºï¼Œè§£é‡Šå¦‚ä¸‹ï¼Œå¦‚æœè¿”å›æˆåŠŸï¼Œä¸éœ€è¦è®¨è®ºï¼Œå¦‚æœè¿”å›å¤±è´¥ï¼Œæˆ‘ä»¬å‡è®¾åœ¨&lt;code&gt;createResource1()&lt;/code&gt;å¤„å¤±è´¥ï¼Œè¿™æ—¶å€™2ã€3éƒ½æ²¡æœ‰è¿›è¡Œåˆ›å»ºï¼Œ1ä¹Ÿæ²¡æœ‰åˆ›å»ºæˆåŠŸï¼Œç›´æ¥è¿”å›ï¼Œæ‰€ä»¥æ²¡æœ‰åˆ›å»ºæˆåŠŸçš„èµ„æºï¼Œä¸éœ€è¦destroyï¼Œå¦‚æœåœ¨&lt;code&gt;createResource2()&lt;/code&gt;ï¼Œè¿™æ—¶å€™&lt;code&gt;err&lt;/code&gt;æœ‰äº†å€¼ï¼Œåœ¨è¿”å›2å¤±è´¥åï¼Œæ‰§è¡Œäº†ä¸Šé¢1æˆåŠŸåå‹å…¥çš„deferï¼Œç ´åäº†1ï¼Œä¸‹é¢çš„3ä¹ŸåŒç†ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜äº”ä¸‹é¢è¿™æ®µè¯æ˜¯å¦æ­£ç¡®å‡ºè‡ªç‰›å®¢ç½‘goè¯­è¨€é¢è¯•é¢˜&#34;&gt;é—®é¢˜äº”ï¼Œä¸‹é¢è¿™æ®µè¯æ˜¯å¦æ­£ç¡®ï¼Œå‡ºè‡ªç‰›å®¢ç½‘Goè¯­è¨€é¢è¯•é¢˜&lt;/h4&gt;
&lt;p&gt;â€ƒâ€ƒ&lt;em&gt;å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œå¦‚æœé‡åˆ°å¼•ç”¨ç©ºæŒ‡é’ˆã€ä¸‹æ ‡è¶Šç•Œæˆ–æ˜¾å¼è°ƒç”¨panicå‡½æ•°ç­‰æƒ…å†µï¼Œåˆ™å…ˆè§¦å‘panicå‡½æ•°çš„æ‰§è¡Œï¼Œç„¶åè°ƒç”¨å»¶è¿Ÿå‡½æ•°ã€‚è°ƒç”¨è€…ç»§ç»­ä¼ é€’panicï¼Œå› æ­¤è¯¥è¿‡ç¨‹ä¸€ç›´åœ¨è°ƒç”¨æ ˆä¸­é‡å¤å‘ç”Ÿï¼šå‡½æ•°åœæ­¢æ‰§è¡Œï¼Œè°ƒç”¨å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ã€‚å¦‚æœä¸€è·¯åœ¨å»¶è¿Ÿå‡½æ•°ä¸­æ²¡æœ‰recoverå‡½æ•°çš„è°ƒç”¨ï¼Œåˆ™ä¼šåˆ°è¾¾è¯¥åç¨‹çš„èµ·ç‚¹ï¼Œè¯¥åç¨‹ç»“æŸï¼Œç„¶åç»ˆæ­¢å…¶ä»–æ‰€æœ‰åç¨‹ï¼Œå…¶ä»–åç¨‹çš„ç»ˆæ­¢è¿‡ç¨‹ä¹Ÿæ˜¯é‡å¤å‘ç”Ÿï¼šå‡½æ•°åœæ­¢æ‰§è¡Œï¼Œè°ƒç”¨å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ã€‚è¿™ä¸€è¯´æ³•æ˜¯å¦æ­£ç¡®ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒç­”æ¡ˆæ˜¯é”™è¯¯çš„ï¼Œä¸Šé¢çš„è¿™æ®µè¯éœ€è¦æ³¨æ„çš„æ˜¯ä¸€ä¸ªåœ°æ–¹ï¼Œ&lt;code&gt;åˆ™å…ˆè§¦å‘panicå‡½æ•°çš„æ‰§è¡Œï¼Œç„¶åè°ƒç”¨å»¶è¿Ÿå‡½æ•°&lt;/code&gt;ï¼Œpanicæ˜¯éœ€è¦ç­‰deferç»“æŸåæ‰ä¼šå‘ä¸Šä¼ é€’ï¼Œå‡ºç°panicï¼Œä¼šå…ˆæŒ‰ç…§deferçš„é€†åºæ‰§è¡Œé¡ºåºï¼Œæ‰§è¡Œå®Œä¹‹åæ‰ä¼šæ‰§è¡Œpanicã€‚æœ‰ä¸€æ®µå¤§ä½¬çš„å®Œæ•´è§£é‡Šä¸ºï¼šâ€œ&lt;em&gt;å½“å†…ç½®çš„panic()å‡½æ•°è°ƒç”¨æ—¶ï¼Œå¤–å›´å‡½æ•°æˆ–æ–¹æ³•çš„æ‰§è¡Œä¼šç«‹å³ç»ˆæ­¢ã€‚ç„¶åï¼Œä»»ä½•å»¶è¿Ÿæ‰§è¡Œ(defer)çš„å‡½æ•°æˆ–æ–¹æ³•éƒ½ä¼šè¢«è°ƒç”¨ï¼Œå°±åƒå…¶å¤–å›´å‡½æ•°æ­£å¸¸è¿”å›ä¸€æ ·ã€‚æœ€åï¼Œè°ƒç”¨è¿”å›åˆ°è¯¥å¤–å›´å‡½æ•°çš„è°ƒç”¨è€…ï¼Œå°±åƒè¯¥å¤–å›´è°ƒç”¨å‡½æ•°æˆ–æ–¹æ³•è°ƒç”¨äº†panic()ä¸€æ ·ï¼Œå› æ­¤è¯¥è¿‡ç¨‹ä¸€ç›´åœ¨è°ƒç”¨æ ˆä¸­é‡å¤å‘ç”Ÿï¼šå‡½æ•°åœæ­¢æ‰§è¡Œï¼Œè°ƒç”¨å»¶è¿Ÿæ‰§è¡Œå‡½æ•°ç­‰ã€‚å½“åˆ°è¾¾main()å‡½æ•°æ—¶ä¸å†æœ‰å¯ä»¥è¿”å›çš„è°ƒç”¨è€…ï¼Œå› æ­¤è¿™ä¸ªè¿‡ç¨‹ä¼šç»ˆæ­¢ï¼Œå¹¶å°†åŒ…å«ä¼ å…¥åŸå§‹panic()å‡½æ•°ä¸­çš„å€¼çš„è°ƒç”¨æ ˆä¿¡æ¯è¾“å‡ºåˆ°os.Stderr&lt;/em&gt;â€ï¼Œå¯ä»¥ä¸¾ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test.1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;test.2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;

	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;i am dead&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;log&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;nf&#34;&gt;test&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ç»“æœä¸º
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// test.2
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// test.1
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// 2022/03/07 15:53:27 i am dead
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id=&#34;é—®é¢˜å…­æ€è€ƒç»“æœå‡ºè‡ªcodingè¿›é˜¶å…¬ä¼—å·æ–‡ç« httpsmpweixinqqcomsrjuz2lvpak26comjjwq7wa&#34;&gt;é—®é¢˜å…­ï¼Œæ€è€ƒç»“æœï¼Œå‡ºè‡ª&lt;a class=&#34;link&#34; href=&#34;https://mp.weixin.qq.com/s/RJUz2LvpAK26CoMjjwQ7wA&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;codingè¿›é˜¶å…¬ä¼—å·æ–‡ç« &lt;/a&gt;&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;20
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 3. r += 4
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 4. recover()æ•è·æˆåŠŸ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;			&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;8&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 5.r += 8 è¾“å‡º 13 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;

	&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 2.å…ˆæ‰§è¡Œè¿™ä¸ªï¼Œä½†æ˜¯å› ä¸ºdeferè¯­å¥çš„ä½ç½®ï¼Œf()æŠ¥é”™
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;f&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;r&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 1.å…ˆç»™rè¿›è¡Œèµ‹å€¼
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nb&#34;&gt;println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;bar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;//ç»“æœä¸º13
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒç­”æ¡ˆæ˜¯13ï¼Œä½ æ€è€ƒå¯¹äº†ä¹ˆï¼Ÿè¿™é“é¢˜çš„å…³é”®åœ¨äºé‚£ä¸ª&lt;code&gt;defer f()&lt;/code&gt;ï¼Œæ­¤å¤„å› ä¸ºdeferè¯­å¥çš„å†™æ³•ä½ç½®ï¼Œå› ä¸º&lt;code&gt;var f func()&lt;/code&gt;ï¼Œf()æ˜¯ç©ºæŒ‡é’ˆï¼Œè€Œç›´æ¥è¿›è¡Œ&lt;code&gt;defer f()&lt;/code&gt;ï¼Œåœ¨å¯¹f()èµ‹å€¼ï¼Œæ‰€ä»¥åœ¨deferä¸­ä¼španicï¼Œè¿™ä¸ªå°±å’Œä¸Šé¢è¯´çš„é—®é¢˜ä¸‰ä¸€æ ·äº†ï¼Œæ‰€ä»¥æ­£ç¡®çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼Œè¿”å›1ç»™rï¼Œç„¶å&lt;code&gt;defer f()&lt;/code&gt;ç›´æ¥panicï¼Œå†å‘ä¸Šè¿›è¡Œï¼Œ&lt;code&gt;r += 4&lt;/code&gt;ç„¶åå†&lt;code&gt;recover()&lt;/code&gt;æ•è·äº†panicï¼Œæ‰§è¡Œäº†&lt;code&gt;r += 8&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;é—®é¢˜ä¸ƒæ€è€ƒç»“æœå‡ºè‡ªcodingè¿›é˜¶&#34;&gt;é—®é¢˜ä¸ƒï¼Œæ€è€ƒç»“æœï¼Œå‡ºè‡ªcodingè¿›é˜¶&lt;/h4&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 4.åŒç†æ•è·åˆ°äº†1
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 2.å…ˆè§£æäº†å‚æ•°ï¼Œæ‰€ä»¥è¿™é‡Œå…ˆæ‰§è¡Œäº†recover()ï¼Œè¿™æ—¶å€™è¿˜æ²¡æœ‰æŒ‰ç…§deferçš„é€†åºæ‰§è¡Œï¼Œæ‰€ä»¥å…ˆæŠŠ2æ•è·åˆ°äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 3.æœ‰æ•ˆï¼Œä½†æ˜¯è¢«æˆªèƒ¡äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}()&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;defer&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;recover&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 1.æ— æ•ˆ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nb&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒç»“æœæ˜¯21ï¼Œä½ å›ç­”å¯¹äº†ä¹ˆï¼Ÿæˆ‘çŒœæµ‹å¤šæ•°äººä¼šå›ç­”nil1ï¼Œè¿˜æœ‰äººä¼šå›ç­”nilï¼Œæˆ‘è¿™é‡Œåˆ†åˆ«è§£é‡Šä¸€ä¸‹ï¼Œå›ç­”nilçš„æ˜¯å› ä¸ºæ²¡ç†è§£recoverçš„ä½¿ç”¨ï¼Œrecoverå¿…é¡»é…åˆdeferçš„å‡½æ•°ä½“ç›´æ¥è°ƒç”¨ä½¿ç”¨ï¼Œå¦åˆ™éƒ½ä¼šæ•è·æ— æ•ˆï¼Œè¿™ä¸ªåœ¨ä¸Šé¢éƒ½æœ‰ä»‹ç»åˆ°ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªdefer(ä»ä¸‹å¾€ä¸Š)æ˜¯æ— æ•ˆçš„ï¼Œå›ç­”ä¸ºnil1çš„æ˜¯æ³¨æ„åˆ°äº†å¾ˆå¤šï¼Œä½†æ˜¯æœ€å…³é”®çš„åœ¨&lt;code&gt;fmt.Print(recover())&lt;/code&gt;ä¸­ï¼Œ&lt;code&gt;recover()&lt;/code&gt;ä½œä¸ºå‚æ•°è¢«deferä¸­çš„funcè°ƒç”¨ï¼Œè¦å…ˆæ‰§è¡Œå‚æ•°è§£æï¼Œæ‰€ä»¥2å°±ä¼šè¢«å…ˆæ•è·åˆ°ï¼Œè€Œä¸æ˜¯æ­£å¸¸çš„å…ˆæ•è·ç»è¿‡å¤´æ’æ³•çš„æœ€è¿‘panicï¼ŒåŒç†æœ€ä¸Šé¢çš„deferå°±æ•è·åˆ°äº†1ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;â€ƒâ€ƒå»¶è¿Ÿå‡½æ•°deferçš„åŸºç¡€ä½¿ç”¨å°±å·®ä¸å¤šä»‹ç»è¿™äº›ï¼Œå…·ä½“å¤ªç»†çš„ï¼Œä»¥åŠé…åˆpanicå’Œrecoverä½¿ç”¨çš„éœ€è¦çœ‹åº•å±‚å’Œæ±‡ç¼–æ‰èƒ½ç†è§£çš„æ›´é€å½»ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒCoding every dayï¼Œlet&amp;rsquo;s go!&lt;/p&gt;
</description>
        </item>
        <item>
        <title>Goè¯­è¨€â€”â€”åˆ‡ç‰‡(Slice)çš„å‘</title>
        <link>https://zonzeeli.github.io/p/slice/</link>
        <pubDate>Wed, 23 Feb 2022 00:00:00 +0000</pubDate>
        
        <guid>https://zonzeeli.github.io/p/slice/</guid>
        <description>&lt;img src="https://zonzeeli.github.io/p/slice/goslice.jpg" alt="Featured image of post Goè¯­è¨€â€”â€”åˆ‡ç‰‡(Slice)çš„å‘" /&gt;&lt;h2 id=&#34;åˆ‡ç‰‡slice&#34;&gt;åˆ‡ç‰‡(Slice)&lt;/h2&gt;
&lt;p&gt;â€ƒâ€ƒåˆå­¦goè¯­è¨€çš„å°ä¼™ä¼´å¯èƒ½åœ¨åˆ‡ç‰‡å’Œæ•°ç»„(Array)ä¸Šæœ‰å¾ˆå¤šå›°æƒ‘ï¼Œè€Œç»å¸¸å‡ºé—®é¢˜ä½¿ç”¨é”™è¯¯çš„å°±æ˜¯åˆ‡ç‰‡sliceï¼Œé¦–å…ˆè¦çŸ¥é“çš„æ˜¯åˆ‡ç‰‡çš„åº•å±‚ç»“æ„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;slice&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;array&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Point&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;len&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// åˆ‡ç‰‡çš„é•¿åº¦
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;cap&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// åˆ‡ç‰‡çš„å®¹é‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒè§‚å¯Ÿä¸Šé¢çš„ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºsliceæ˜¯åªæ˜¯æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œå¹¶ä¸æ˜¯çœŸçš„ç”³è¯·äº†ä¸€ç¯‡å†…å­˜æ¥ä¿å­˜æ•°ç»„ï¼Œæ¯”å¦‚å¦‚æœä¸€ä¸ªåº•å±‚æ•°ç»„æœ‰10ä¸ªå…ƒç´ ï¼Œsliceå¯ä»¥è®¿é—®å…¶ä¸­çš„å‰5ä¸ªæ•°ï¼Œè¿™æ ·å­sliceçš„åœ°å€å’Œæ•°ç»„çš„å¤´åœ°å€å°±æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”sliceå¯ä»¥å…±äº«åº•å±‚æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒè€Œä¸”è¿™é‡Œè¦è¯´æ˜ä¸€ä¸‹ï¼ŒGoè¯­è¨€ç±»å‹éƒ½æ˜¯å€¼ç±»å‹ï¼Œåªä¸è¿‡æœ‰çš„ç±»å‹å†…éƒ¨ä½¿ç”¨æ˜¯ç”¨æŒ‡é’ˆå®ç°ï¼Œæ‰€ä»¥å¯ä»¥å®ç°å¼•ç”¨ï¼Œè€Œæ•°ç»„çš„å£°æ˜è¦å¸¦æœ‰é•¿åº¦ï¼Œå¦‚æœå£°æ˜å¥½äº†ï¼Œåˆ™é•¿åº¦æ˜¯ä¸ä¼šå‘ç”Ÿæ”¹å˜çš„ï¼Œå¦‚æœæƒ³è¦æ‰©å®¹é‚£ä¹ˆåªèƒ½æ–°å£°æ˜ä¸€ä¸ªæ–°æ•°ç»„ï¼Œè¿™ä¸ªå’Œsliceå®Œå…¨ä¸åŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// ä¼šæœ‰å¦‚ä¸‹é”™è¯¯æç¤º:Cannot use &amp;#39;a&amp;#39; (type [5]int) as the type []Type
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒè¿™é‡Œæœ‰ä¸€ç‚¹å› ä¸ºä¸Šé¢è¯´åˆ°çš„å€¼ç±»å‹ï¼Œå¦‚æœåœ¨å‡½æ•°è°ƒç”¨ä¸­ä¼ å‚ä¸ºæ•°ç»„çš„è¯ï¼Œé‚£ä¹ˆæ²¡è°ƒç”¨ä¸€æ¬¡å°±ä¼šå°†æ•°ç»„çš„å†…å­˜ç©ºé—´å¤§å°åˆ†é…åœ¨æ ˆä¸­ï¼Œå¦‚æœæ•°ç»„è¿‡å¤§é‚£ä¹ˆå°±ä¼šå¾ˆå½±å“å†…å­˜çš„åˆ©ç”¨ï¼Œæ‰€ä»¥sliceï¼Œåˆ©ç”¨æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆï¼Œä¼ å‚ç”¨sliceå°±ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; 
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;test2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;arr&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒsliceçš„å£°æ˜å¯ä»¥å®šä¹‰å¥½é•¿åº¦å’Œå®¹é‡ï¼Œä¹Ÿå¯ä»¥ä¸è®¾å®šå®šä¹‰ä¸ºnilæˆ–æ˜¯ç©ºåˆ‡ç‰‡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// é•¿åº¦å’Œå®¹é‡å‡ä¸º0ï¼Œnilåˆ‡ç‰‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// é•¿åº¦å’Œå®¹é‡å‡ä¸º2
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// ç©ºåˆ‡ç‰‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒç”±äºsliceæ˜¯æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆï¼Œä¸”å¯ä»¥å…±äº«åº•å±‚æ•°ç»„ï¼Œæ‰€ä»¥ä¸¤ä¸ªæŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„çš„åˆ‡ç‰‡ï¼Œå¯¹å…¶ä¸­ä¸€ä¸ªä¿®æ”¹å€¼ï¼Œä¼šå½±å“å¦ä¸€ä¸ª&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;8
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// è¿™é‡Œæ‰“å°çš„ç»“æœæ˜¯6 6 2 4
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// bçš„é•¿åº¦è®¡ç®—æ–¹å¼æ˜¯4-2ï¼Œå®¹é‡çš„è®¡ç®—æ–¹å¼æ˜¯açš„å®¹é‡6å‡bå…¶å®ç´¢å¼•2
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [3 4]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [10 4] [1 2 10 4 5 6] è¿™é¢ç”±äºæŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œæ‰€ä»¥æ‰“å°aä¹Ÿä¼šå˜åŒ–
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [10 4 5] å› ä¸ºbçš„å®¹é‡æ˜¯4ï¼ŒbæŒ‡å‘ä»ç´¢å¼•2å¼€å§‹ï¼Œæ‰€ä»¥æ‰“å°å‡ºæ¥çš„æ˜¯[10 4 5]ï¼Œä½†æ˜¯ä¸èƒ½æ‰“å°b[3]ï¼Œå› ä¸ºbçš„é•¿åº¦æ˜¯2ï¼Œåªèƒ½è®¿é—®é•¿åº¦èŒƒå›´å†…çš„ç´¢å¼•
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒsliceç›¸å¯¹äºæ•°ç»„æ¥è¯´å¯ä»¥ç›´æ¥ä½¿ç”¨appendæ¥æ‰©å®¹å¢é•¿ï¼Œå¦‚æœsliceçš„å®¹é‡å¤Ÿï¼Œappendæ–¹æ³•ä¸ä¼šæ”¹å˜åº•å±‚æ•°ç»„ï¼Œä¸å¤Ÿçš„è¯ï¼Œappend ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åº•å±‚æ•°ç»„ï¼Œæ‹·è´åŸå…ˆçš„å€¼å’Œæ·»åŠ æ–°å€¼ã€‚ä½†æ˜¯å› ä¸ºsliceæ˜¯æŒ‡å‘æ•°ç»„æŒ‡é’ˆçš„åŸå› ï¼Œè¿™å…¶ä¸­åˆæœ‰ä¸€äº›é—®é¢˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;17
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;18
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;19
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 6 6 2 4
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; 
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [3 4 10] [1 2 3 4 10 6]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 6 6 3 4 bçš„é•¿åº¦å¢é•¿äº†ï¼Œå®¹é‡å› ä¸ºæ²¡æœ‰è¶…å‡ºæ‰€ä»¥æ²¡æœ‰å˜åŒ–ï¼Œåº•å±‚æ•°ç»„ä¹Ÿæ²¡æœ‰å˜ï¼Œa[4]å‘ç”Ÿäº†å˜åŒ–ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	
	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 6 6 4 4
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 6 6 5 8 è¶…å‡ºåŸå…ˆbçš„å®¹é‡ï¼Œbæ‰©å®¹äº†ï¼Œæ­¤æ—¶bçš„åº•å±‚æ•°ç»„ä¸æ˜¯açš„åº•å±‚æ•°ç»„äº†ï¼Œæ‰©å®¹æœºåˆ¶è¿™ä¸ªæˆ‘è®°å¾—æ˜¯å°äº1024ä¸ªå…ƒç´ å®¹é‡æ‰©å®¹æ¯æ¬¡ä¹˜2ï¼Œå¤§äº1024æ—¶æ˜¯ä¹˜1.25ï¼Œæˆ‘å¹¶ä¸å¤ªç¡®å®šã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [3 4 10 20 30] [1 2 3 4 10 20] 
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;100&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [100 4 10 20 30] [1 2 3 4 10 20] a æ²¡æœ‰å‘ç”Ÿå˜åŒ–
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	
	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// è¿™ç§å†™æ³•å°±æ˜¯ä¸‰ç§å‚æ•°çš„å†™æ³•ï¼Œdçš„é•¿åº¦æ˜¯2ï¼Œå®¹é‡æ˜¯5-3ï¼Œè¿™é‡Œçš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¸èƒ½è¶…è¿‡cçš„å®¹é‡ï¼Œä¸ç„¶ä¼šæŠ¥é”™
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [3 4] 2 3
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// è¿™æ ·åšé™å®šäº†å®¹é‡æœ€å¤§å€¼ï¼Œå¦‚æœdæ‰©å®¹è¶…è¿‡æœ€å¤§å®¹é‡ï¼Œå°±ä¼šåˆ›å»ºæ–°çš„åº•å±‚æ•°ç»„ï¼Œä¸ä¼šå½±å“cäº†
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¤§ä½“çš„åˆ‡ç‰‡çŸ¥è¯†å°±æ˜¯è¿™æ ·ï¼Œå®é™…ä¸­å¯èƒ½è¿˜ä¼šæœ‰å¾ˆå¤šé—®é¢˜ï¼Œå‰ä¸€é˜µå­çœ‹åˆ°ç…é±¼å¤§ä½¬å¾—ä¸€ç¯‡æ–‡ç« ï¼Œè¿™é‡ŒæŠŠè¿™ç¯‡æ–‡ç« çš„ä¸»è¦å†…å®¹æ‹¿å‡ºæ¥èŠèŠã€‚&lt;a class=&#34;link&#34; href=&#34;https://mp.weixin.qq.com/s?__biz=MzUxMDI4MDc1NA==&amp;amp;mid=2247491675&amp;amp;idx=1&amp;amp;sn=5a887e874999251201c90744434d2471&amp;amp;scene=21#wechat_redirect&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;é¦–å…ˆæ”¾ä¸Šç…é±¼å¤§ä½¬çš„æ–‡ç« é“¾æ¥&lt;/a&gt;ï¼Œæ¥ä¸‹æ¥çœ‹ä¸€ä¸‹è¿™æ®µç¨‹åºï¼Œæ€è€ƒä¸€ä¸‹è¿™æ®µä»£ç çš„è¾“å‡ºæ˜¯æ€ä¹ˆæ ·çš„ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;appenFunc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nf&#34;&gt;appenFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
	
	&lt;span class=&#34;c1&#34;&gt;//[]  
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//[10 20 30]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//[]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//[10 20 30 0 0 0 0 0 0 0]
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒçœ‹åˆ°è¾“å‡ºçš„è¯é—®é¢˜æ¥äº†ï¼Œæœ€è®©äººç–‘æƒ‘çš„å°±æ˜¯åä¸¤å¥æ‰“å°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒå¦å¤–å†åŠ ä¸€å¥&lt;code&gt;fmt.Println(sl[:])&lt;/code&gt;çŒœä¸€ä¸‹æ‰“å°ç»“æœå¦‚ä½•ï¼Ÿæ•´åˆä¸€ä¸‹ç»“æœåº”è¯¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt;1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:])&lt;/span&gt;
	
	&lt;span class=&#34;c1&#34;&gt;//[]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//[10 20 30 0 0 0 0 0 0 0]
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;//[]
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒæ›´åŠ ä»¤äººç–‘æƒ‘äº†ï¼Ÿä¸ºä»€ä¹ˆåä¸¤å¥çš„æ‰“å°ç»“æœä¸ä¸€æ ·å‘¢ï¼Ÿå†çœ‹å®Œäº†ä»¥ä¸Šåˆ‡ç‰‡çš„ä»‹ç»ï¼Œä»¥åŠçŸ¥é“Goè¯­è¨€æ˜¯å€¼ç±»å‹ä¼ é€’çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æè¿™æ®µç¨‹åºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;13
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;14
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;15
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;16
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;appenFunc&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0 10 æ²¡ä»€ä¹ˆäº‰è®®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 3 10 æ²¡ä»€ä¹ˆäº‰è®®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%p\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0xc000004108 æ²¡ä»€ä¹ˆäº‰è®®ï¼Œå†è§£é‡Šä¸€ä¸‹Goè¯­è¨€æ˜¯å€¼ç±»å‹ä¼ é€’ï¼Œæ‰€ä»¥é—­åŒ…ç§çš„sç›¸å½“äºä¸€ä¸ªå‰¯æœ¬ï¼Œæ‰€ä»¥åœ°å€å’Œslçš„åœ°å€ä¸ä¸€æ ·ï¼Œä½†æ˜¯é‡ç‚¹ï¼ï¼ï¼sæŒ‡å‘çš„åº•å±‚æ•°ç»„å’ŒslæŒ‡å‘çš„æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ˜¯è§£å†³è¿™äº›é—®é¢˜çš„å…³é”®æ‰€åœ¨ã€‚
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [] ä¸ºç©ºï¼Œæ²¡ä»€ä¹ˆäº‰è®®
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;%p\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0xc0000040d8
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nf&#34;&gt;appenFunc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// çœ‹ä¸Šé¢å’¯
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [] ä¸ºç©ºï¼Œå› ä¸ºæ˜¯å€¼ä¼ é€’æ‰€ä»¥slçš„é•¿åº¦ä¸å˜ï¼Œå®¹é‡ä¹Ÿä¸å˜ï¼Œä½†æ˜¯å†ä»”ç»†æ€è€ƒä¸€ä¸‹åº•å±‚æ•°ç»„å˜äº†ä¹ˆï¼Ÿç­”æ¡ˆæ˜¯å˜äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [10 20 30 0 0 0 0 0 0 0] æ²¡é”™ åº•å±‚æ•°ç»„å˜äº†ï¼Œè€Œä¸”slçš„å®¹é‡æ˜¯10å¯ä»¥æ‰“å°ï¼Œæ‰€ä»¥å°†åº•å±‚æ•°ç»„æ‰“å°å‡ºæ¥äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:])&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// [] ä¸ºç©ºï¼Œå‰é¢è¯´äº†slçš„é•¿åº¦ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥å…¶å®slçš„é•¿åº¦ä¾ç„¶æ˜¯0ï¼ï¼ï¼é‚£è¿™ä¹ˆæ‰“å°å°±ä¸ä¼šæœ‰ä»»ä½•ç»“æœçš„
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Println&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;cap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;sl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// 0 10 åˆ°è¿™åº”è¯¥å°±å®Œå…¨ç†è§£äº†
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	
	&lt;span class=&#34;c1&#34;&gt;// è¿™é‡Œä¹Ÿè¯´æ˜ä¸€ä¸‹ï¼Œæ¯”å¦‚fmt.Println(sl)ä¸ºä»€ä¹ˆæ‰“å°çš„ä¸æ˜¯å®Œæ•´åº•å±‚æ•°ç»„è¿™ç§çš„é—®é¢˜ï¼Œè¿™å…¶å®å’ŒfmtåŒ…ä¸‹æ‰“å°æ–¹æ³•çš„å†™æ³•æœ‰å…³ï¼Œè¿™é‡Œå°±ä¸æ·±ç ”ç©¶è¿™ä¸ªäº†ã€‚
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒçœ‹äº†ä¸Šé¢ä¸€æ­¥æ­¥çš„åˆ†æåï¼Œæ˜¯ä¸æ˜¯ç†è§£äº†å¾ˆå¤šï¼Œå…¶å®ç¯ç¯ç›¸æ‰£ï¼Œæ¸…æ™°äº†ç†è§£èµ·æ¥å°±å¾ˆå®¹æ˜“ï¼Œè¿‡äº†ä¸€é˜µå­åï¼Œ&lt;a class=&#34;link&#34; href=&#34;https://mp.weixin.qq.com/s?__biz=MzUxMDI4MDc1NA==&amp;amp;mid=2247492355&amp;amp;idx=1&amp;amp;sn=0e468b75394ba9778437b5c72e43c3ad&amp;amp;scene=21#wechat_redirect&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;ç…é±¼å¤§ä½¬åˆåˆå‘äº†ç¯‡å…³äºsliceçš„æ–‡ç« &lt;/a&gt;ï¼Œè¿™é‡Œä¹Ÿæ‹¿å‡ºæ¥è¯´ä¸€ä¸‹ï¼Œæ˜¯æœ‰å…³sliceæ“ä½œå¯¼è‡´å†…å­˜æ³„éœ²çš„é—®é¢˜ï¼Œè¿˜æ˜¯ä¾ç„¶çœ‹ä¸€ä¸‹å¦‚ä¸‹ç¨‹åºï¼Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ä¼šå¯¼è‡´å†…å­˜æ³„æ¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒè¿™é‡Œå…ˆç®€å•è¯´ä¸€ä¸‹å†…å­˜æ³„æ¼ï¼Œå†…å­˜æ³„éœ²æ˜¯åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä¸å†ä½¿ç”¨çš„å†…å­˜ï¼Œæ²¡æœ‰è¢«é‡Šæ”¾æ‰ï¼Œå¯¼è‡´è¿™äº›å†…å­˜æ— æ³•è¢«ä½¿ç”¨ï¼Œç­‰åˆ°ç¨‹åºç»“æŸåæ‰ä¼šé‡Šæ”¾æ‰ï¼ŒGoè¯­è¨€ä¹Ÿæœ‰GCåƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶å †ä¸Šä¸ä½¿ç”¨çš„å†…å­˜ï¼Œä½†ä»£ç å†™æ³•çš„é—®é¢˜ä¾ç„¶ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚è€ŒGoè¯­è¨€çš„å†…å­˜æ³„æ¼ä¸»è¦æ˜¯goroutineæ³„æ¼ï¼Œè¿™ä¸ªä¹‹åå†™åšå®¢å¯ä»¥ä»‹ç»ä»‹ç»ï¼Œå›åˆ°è¿™ä¸ªé—®é¢˜ï¼Œä¸Šé¢çš„è¿™ä¸ªä»£ç æ— ç–‘æ˜¯ä¼šé€ æˆå†…å­˜æ³„æ¼çš„ï¼Œé‚£ä¹ˆé—®é¢˜åœ¨å“ªï¼Ÿç­”æ¡ˆè¿˜æ˜¯åœ¨sliceçš„åº•å±‚ç»“æ„ä¸Šï¼Œåˆ†æä¸‹è¿™æ®µç¨‹åºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// é™æ€å­˜å‚¨å˜é‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;c1&#34;&gt;// b æ˜¯åŠ¨æ€å­˜å‚¨å˜é‡
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;// è·Ÿç€ä¸Šæ–‡çš„ä»‹ç»ï¼Œa b éƒ½æŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œåªä¸è¿‡aåªåŒ…å«[:2]ï¼Œbæ˜¯å…¨éƒ¨
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;

&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒåˆ°è¿™å…¶å®å°±å¾ˆæ˜äº†äº†ï¼Œç”±äº&lt;code&gt;a&lt;/code&gt;å’Œ&lt;code&gt;b&lt;/code&gt;æŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œaæ˜¯é™æ€å­˜å‚¨å˜é‡è¢«åˆ†é…äº†å›ºå®šçš„å†…å­˜ç©ºé—´ï¼Œå¦‚æœç¨‹åº&lt;code&gt;f(b []int)&lt;/code&gt;ç»“æŸäº†ï¼Œ&lt;code&gt;b&lt;/code&gt;è¿™ç§åŠ¨æ€å˜é‡åº”è¯¥è¢«å›æ”¶äº†ï¼Œä½†æ˜¯ç”±äº&lt;code&gt;a&lt;/code&gt;è¿˜åœ¨ä½¿ç”¨ï¼Œå°½ç®¡åªæ˜¯ä½¿ç”¨ä¸¤ä¸ªå…ƒç´ ï¼Œåé¢çš„å…ƒç´ æ¯«æ— ä½œç”¨ï¼Œä½†æ˜¯ä¾ç„¶ä¸ä¼šè¢«GCï¼Œæ‰€ä»¥å¯¼è‡´äº†æ³„æ¼ï¼Œç…é±¼å¤§ä½¬è¿˜ç»™äº†ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œä¹ŸåŒæ ·æ˜¯åˆ©ç”¨äº†sliceçš„appendç‰¹æ€§ï¼Œç¨‹åºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div class=&#34;chroma&#34;&gt;
&lt;table class=&#34;lntable&#34;&gt;&lt;tr&gt;&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code&gt;&lt;span class=&#34;lnt&#34;&gt; 1
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 2
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 3
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 4
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 5
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 6
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 7
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 8
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt; 9
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;10
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;11
&lt;/span&gt;&lt;span class=&#34;lnt&#34;&gt;12
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class=&#34;lntd&#34;&gt;
&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;    &lt;span class=&#34;c1&#34;&gt;// ç¬¬ä¸‰è€…
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;
&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

	&lt;span class=&#34;c1&#34;&gt;// æ–°çš„åˆ‡ç‰‡ append å¯¼è‡´åˆ‡ç‰‡æ‰©å®¹
&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[:&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
	&lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Printf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;a: %p\nc: %p\nb: %p\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;

	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;a&lt;/span&gt;
&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;â€ƒâ€ƒè¿™é‡Œçš„&lt;code&gt;a&lt;/code&gt;å’Œ&lt;code&gt;b&lt;/code&gt;æ˜¯æŒ‡å‘åŒä¸€ä¸ªåº•å±‚æ•°ç»„ï¼Œè€Œ&lt;code&gt;c&lt;/code&gt;æ˜¯é€šè¿‡æ²¡æœ‰å®¹é‡çš„åˆ‡ç‰‡ï¼Œè¿›è¡Œappendåé‡æ–°ç”³è¯·åˆ†é…ç©ºé—´çš„å˜é‡ï¼Œå› æ­¤ä½¿ç”¨&lt;code&gt;c&lt;/code&gt;å®ç°äº†é˜²æ­¢å†…å­˜æ³„æ¼ã€‚&lt;/p&gt;
&lt;p&gt;â€ƒâ€ƒOKï¼æœ‰å…³sliceçš„éƒ¨åˆ†æš‚æ—¶èƒ½æƒ³åˆ°çš„å°±è¿™äº›ï¼Œä¹Ÿå…ˆä»‹ç»è¿™ä¹ˆå¤šå•¦~&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
